"use strict";(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PGossipsub = factory()}(typeof self !== 'undefined' ? self : this, function () {
var ChainsafeLibp2PGossipsub=(()=>{var D1=Object.create;var Vo=Object.defineProperty;var v1=Object.getOwnPropertyDescriptor;var w1=Object.getOwnPropertyNames;var x1=Object.getPrototypeOf,E1=Object.prototype.hasOwnProperty;var Lp=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var k=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),U=(t,e)=>{for(var r in e)Vo(t,r,{get:e[r],enumerable:!0})},Up=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of w1(e))!E1.call(t,s)&&s!==r&&Vo(t,s,{get:()=>e[s],enumerable:!(n=v1(e,s))||n.enumerable});return t};var W=(t,e,r)=>(r=t!=null?D1(x1(t)):{},Up(e||!t||!t.__esModule?Vo(r,"default",{value:t,enumerable:!0}):r,t)),S1=t=>Up(Vo({},"__esModule",{value:!0}),t);var zp=k((LB,qp)=>{qp.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var Gp=k((qB,Kp)=>{var Vp=zp();Kp.exports=class{constructor(e){this.hwm=e||16,this.head=new Vp(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new Vp(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var Wp=k((zB,Hp)=>{var $u=Gp();Hp.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new $u,n,s,i,o=()=>{if(!r.isEmpty()){if(t.writev){let d,y=[];for(;!r.isEmpty();){if(d=r.shift(),d.error)throw d.error;y.push(d.value)}return{done:d.done,value:y}}let p=r.shift();if(p.error)throw p.error;return p}return i?{done:!0}:new Promise((p,d)=>{s=y=>(s=null,y.error?d(y.error):t.writev&&!y.done?p({done:y.done,value:[y.value]}):p(y),n)})},a=p=>s?s(p):(r.push(p),n),c=p=>(r=new $u,s?s({error:p}):(r.push({error:p}),n)),f=p=>i?n:a({done:!1,value:p}),u=p=>i?n:(i=!0,p?c(p):a({done:!0})),h=()=>(r=new $u,u(),{done:!0}),l=p=>(u(p),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:o,return:h,throw:l,push:f,end:u},!e)return n;let g=n;return n={[Symbol.asyncIterator](){return this},next(){return g.next()},throw(p){return g.throw(p),e&&(e(p),e=null),{done:!0}},return(){return g.return(),e&&(e(),e=null),{done:!0}},push:f,end(p){return g.end(p),e&&(e(p),e=null),n}},n}});var jp=k((VB,$p)=>{"use strict";var A1=Wp(),I1=async function*(...t){let e=A1();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};$p.exports=I1});var Le=k((HB,Qp)=>{"use strict";function Xp(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function _1(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return Xp(t,r)}catch{r.message=t.message,r.stack=t.stack;let s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(t)),Xp(new s,r)}}Qp.exports=_1});var jo=k((M5,E0)=>{"use strict";E0.exports=z2;function z2(t,e){for(var r=new Array(arguments.length-1),n=0,s=2,i=!0;s<arguments.length;)r[n++]=arguments[s++];return new Promise(function(a,c){r[n]=function(u){if(i)if(i=!1,u)c(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];a.apply(null,h)}};try{t.apply(e||null,r)}catch(f){i&&(i=!1,c(f))}})}});var yc=k(A0=>{"use strict";var Jo=A0;Jo.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var gs=new Array(64),C0=new Array(123);for(Vt=0;Vt<64;)C0[gs[Vt]=Vt<26?Vt+65:Vt<52?Vt+71:Vt<62?Vt-4:Vt-59|43]=Vt++;var Vt;Jo.encode=function(e,r,n){for(var s=null,i=[],o=0,a=0,c;r<n;){var f=e[r++];switch(a){case 0:i[o++]=gs[f>>2],c=(f&3)<<4,a=1;break;case 1:i[o++]=gs[c|f>>4],c=(f&15)<<2,a=2;break;case 2:i[o++]=gs[c|f>>6],i[o++]=gs[f&63],a=0;break}o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,i)),o=0)}return a&&(i[o++]=gs[c],i[o++]=61,a===1&&(i[o++]=61)),s?(o&&s.push(String.fromCharCode.apply(String,i.slice(0,o))),s.join("")):String.fromCharCode.apply(String,i.slice(0,o))};var S0="invalid encoding";Jo.decode=function(e,r,n){for(var s=n,i=0,o,a=0;a<e.length;){var c=e.charCodeAt(a++);if(c===61&&i>1)break;if((c=C0[c])===void 0)throw Error(S0);switch(i){case 0:o=c,i=1;break;case 1:r[n++]=o<<2|(c&48)>>4,o=c,i=2;break;case 2:r[n++]=(o&15)<<4|(c&60)>>2,o=c,i=3;break;case 3:r[n++]=(o&3)<<6|c,i=0;break}}if(i===1)throw Error(S0);return n-s};Jo.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var mc=k((F5,I0)=>{"use strict";I0.exports=Zo;function Zo(){this._listeners={}}Zo.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Zo.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],s=0;s<n.length;)n[s].fn===r?n.splice(s,1):++s;return this};Zo.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],s=1;s<arguments.length;)n.push(arguments[s++]);for(s=0;s<r.length;)r[s].fn.apply(r[s++].ctx,n)}return this}});var bc=k((L5,k0)=>{"use strict";k0.exports=B0(B0);function B0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function s(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3]}function i(c,f,u){e[0]=c,f[u]=r[3],f[u+1]=r[2],f[u+2]=r[1],f[u+3]=r[0]}t.writeFloatLE=n?s:i,t.writeFloatBE=n?i:s;function o(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],e[0]}function a(c,f){return r[3]=c[f],r[2]=c[f+1],r[1]=c[f+2],r[0]=c[f+3],e[0]}t.readFloatLE=n?o:a,t.readFloatBE=n?a:o}():function(){function e(n,s,i,o){var a=s<0?1:0;if(a&&(s=-s),s===0)n(1/s>0?0:2147483648,i,o);else if(isNaN(s))n(2143289344,i,o);else if(s>34028234663852886e22)n((a<<31|2139095040)>>>0,i,o);else if(s<11754943508222875e-54)n((a<<31|Math.round(s/1401298464324817e-60))>>>0,i,o);else{var c=Math.floor(Math.log(s)/Math.LN2),f=Math.round(s*Math.pow(2,-c)*8388608)&8388607;n((a<<31|c+127<<23|f)>>>0,i,o)}}t.writeFloatLE=e.bind(null,T0),t.writeFloatBE=e.bind(null,_0);function r(n,s,i){var o=n(s,i),a=(o>>31)*2+1,c=o>>>23&255,f=o&8388607;return c===255?f?NaN:a*(1/0):c===0?a*1401298464324817e-60*f:a*Math.pow(2,c-150)*(f+8388608)}t.readFloatLE=r.bind(null,P0),t.readFloatBE=r.bind(null,R0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function s(c,f,u){e[0]=c,f[u]=r[0],f[u+1]=r[1],f[u+2]=r[2],f[u+3]=r[3],f[u+4]=r[4],f[u+5]=r[5],f[u+6]=r[6],f[u+7]=r[7]}function i(c,f,u){e[0]=c,f[u]=r[7],f[u+1]=r[6],f[u+2]=r[5],f[u+3]=r[4],f[u+4]=r[3],f[u+5]=r[2],f[u+6]=r[1],f[u+7]=r[0]}t.writeDoubleLE=n?s:i,t.writeDoubleBE=n?i:s;function o(c,f){return r[0]=c[f],r[1]=c[f+1],r[2]=c[f+2],r[3]=c[f+3],r[4]=c[f+4],r[5]=c[f+5],r[6]=c[f+6],r[7]=c[f+7],e[0]}function a(c,f){return r[7]=c[f],r[6]=c[f+1],r[5]=c[f+2],r[4]=c[f+3],r[3]=c[f+4],r[2]=c[f+5],r[1]=c[f+6],r[0]=c[f+7],e[0]}t.readDoubleLE=n?o:a,t.readDoubleBE=n?a:o}():function(){function e(n,s,i,o,a,c){var f=o<0?1:0;if(f&&(o=-o),o===0)n(0,a,c+s),n(1/o>0?0:2147483648,a,c+i);else if(isNaN(o))n(0,a,c+s),n(2146959360,a,c+i);else if(o>17976931348623157e292)n(0,a,c+s),n((f<<31|2146435072)>>>0,a,c+i);else{var u;if(o<22250738585072014e-324)u=o/5e-324,n(u>>>0,a,c+s),n((f<<31|u/4294967296)>>>0,a,c+i);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),u=o*Math.pow(2,-h),n(u*4503599627370496>>>0,a,c+s),n((f<<31|h+1023<<20|u*1048576&1048575)>>>0,a,c+i)}}}t.writeDoubleLE=e.bind(null,T0,0,4),t.writeDoubleBE=e.bind(null,_0,4,0);function r(n,s,i,o,a){var c=n(o,a+s),f=n(o,a+i),u=(f>>31)*2+1,h=f>>>20&2047,l=4294967296*(f&1048575)+c;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,P0,0,4),t.readDoubleBE=r.bind(null,R0,4,0)}(),t}function T0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function _0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function P0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function R0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Xo=k((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var vc=k(O0=>{"use strict";var Dc=O0;Dc.length=function(e){for(var r=0,n=0,s=0;s<e.length;++s)n=e.charCodeAt(s),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(s+1)&64512)===56320?(++s,r+=4):r+=3;return r};Dc.read=function(e,r,n){var s=n-r;if(s<1)return"";for(var i=null,o=[],a=0,c;r<n;)c=e[r++],c<128?o[a++]=c:c>191&&c<224?o[a++]=(c&31)<<6|e[r++]&63:c>239&&c<365?(c=((c&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(c>>10),o[a++]=56320+(c&1023)):o[a++]=(c&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Dc.write=function(e,r,n){for(var s=n,i,o,a=0;a<e.length;++a)i=e.charCodeAt(a),i<128?r[n++]=i:i<2048?(r[n++]=i>>6|192,r[n++]=i&63|128):(i&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(i=65536+((i&1023)<<10)+(o&1023),++a,r[n++]=i>>18|240,r[n++]=i>>12&63|128,r[n++]=i>>6&63|128,r[n++]=i&63|128):(r[n++]=i>>12|224,r[n++]=i>>6&63|128,r[n++]=i&63|128);return n-s}});var wc=k((q5,M0)=>{"use strict";M0.exports=V2;function V2(t,e,r){var n=r||8192,s=n>>>1,i=null,o=n;return function(c){if(c<1||c>s)return t(c);o+c>n&&(i=t(n),o=0);var f=e.call(i,o,o+=c);return o&7&&(o=(o|7)+1),f}}});var F0=k((z5,N0)=>{"use strict";N0.exports=He;var _i=nr();function He(t,e){this.lo=t>>>0,this.hi=e>>>0}var Pn=He.zero=new He(0,0);Pn.toNumber=function(){return 0};Pn.zzEncode=Pn.zzDecode=function(){return this};Pn.length=function(){return 1};var K2=He.zeroHash="\0\0\0\0\0\0\0\0";He.fromNumber=function(e){if(e===0)return Pn;var r=e<0;r&&(e=-e);var n=e>>>0,s=(e-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new He(n,s)};He.from=function(e){if(typeof e=="number")return He.fromNumber(e);if(_i.isString(e))if(_i.Long)e=_i.Long.fromString(e);else return He.fromNumber(parseInt(e,10));return e.low||e.high?new He(e.low>>>0,e.high>>>0):Pn};He.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};He.prototype.toLong=function(e){return _i.Long?new _i.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var tn=String.prototype.charCodeAt;He.fromHash=function(e){return e===K2?Pn:new He((tn.call(e,0)|tn.call(e,1)<<8|tn.call(e,2)<<16|tn.call(e,3)<<24)>>>0,(tn.call(e,4)|tn.call(e,5)<<8|tn.call(e,6)<<16|tn.call(e,7)<<24)>>>0)};He.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};He.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};He.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};He.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var nr=k(xc=>{"use strict";var q=xc;q.asPromise=jo();q.base64=yc();q.EventEmitter=mc();q.float=bc();q.inquire=Xo();q.utf8=vc();q.pool=wc();q.LongBits=F0();q.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);q.global=q.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||xc;q.emptyArray=Object.freeze?Object.freeze([]):[];q.emptyObject=Object.freeze?Object.freeze({}):{};q.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};q.isString=function(e){return typeof e=="string"||e instanceof String};q.isObject=function(e){return e&&typeof e=="object"};q.isset=q.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};q.Buffer=function(){try{var t=q.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();q._Buffer_from=null;q._Buffer_allocUnsafe=null;q.newBuffer=function(e){return typeof e=="number"?q.Buffer?q._Buffer_allocUnsafe(e):new q.Array(e):q.Buffer?q._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};q.Array=typeof Uint8Array<"u"?Uint8Array:Array;q.Long=q.global.dcodeIO&&q.global.dcodeIO.Long||q.global.Long||q.inquire("long");q.key2Re=/^true|false|0|1$/;q.key32Re=/^-?(?:0|[1-9][0-9]*)$/;q.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;q.longToHash=function(e){return e?q.LongBits.from(e).toHash():q.LongBits.zeroHash};q.longFromHash=function(e,r){var n=q.LongBits.fromHash(e);return q.Long?q.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function L0(t,e,r){for(var n=Object.keys(e),s=0;s<n.length;++s)(t[n[s]]===void 0||!r)&&(t[n[s]]=e[n[s]]);return t}q.merge=L0;q.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function U0(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&L0(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}q.newError=U0;q.ProtocolError=U0("ProtocolError");q.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var s=Object.keys(this),i=s.length-1;i>-1;--i)if(r[s[i]]===1&&this[s[i]]!==void 0&&this[s[i]]!==null)return s[i]}};q.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};q.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};q._configure=function(){var t=q.Buffer;if(!t){q._Buffer_from=q._Buffer_allocUnsafe=null;return}q._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},q._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Yo=k((K5,K0)=>{"use strict";K0.exports=se;var Tt=nr(),Ec,Qo=Tt.LongBits,q0=Tt.base64,z0=Tt.utf8;function Pi(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Cc(){}function G2(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function se(){this.len=0,this.head=new Pi(Cc,0,0),this.tail=this.head,this.states=null}var V0=function(){return Tt.Buffer?function(){return(se.create=function(){return new Ec})()}:function(){return new se}};se.create=V0();se.alloc=function(e){return new Tt.Array(e)};Tt.Array!==Array&&(se.alloc=Tt.pool(se.alloc,Tt.Array.prototype.subarray));se.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Pi(e,r,n),this.len+=r,this};function Ac(t,e,r){e[r]=t&255}function H2(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Ic(t,e){this.len=t,this.next=void 0,this.val=e}Ic.prototype=Object.create(Pi.prototype);Ic.prototype.fn=H2;se.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Ic((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};se.prototype.int32=function(e){return e<0?this._push(Bc,10,Qo.fromNumber(e)):this.uint32(e)};se.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Bc(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}se.prototype.uint64=function(e){var r=Qo.from(e);return this._push(Bc,r.length(),r)};se.prototype.int64=se.prototype.uint64;se.prototype.sint64=function(e){var r=Qo.from(e).zzEncode();return this._push(Bc,r.length(),r)};se.prototype.bool=function(e){return this._push(Ac,1,e?1:0)};function Sc(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}se.prototype.fixed32=function(e){return this._push(Sc,4,e>>>0)};se.prototype.sfixed32=se.prototype.fixed32;se.prototype.fixed64=function(e){var r=Qo.from(e);return this._push(Sc,4,r.lo)._push(Sc,4,r.hi)};se.prototype.sfixed64=se.prototype.fixed64;se.prototype.float=function(e){return this._push(Tt.float.writeFloatLE,4,e)};se.prototype.double=function(e){return this._push(Tt.float.writeDoubleLE,8,e)};var W2=Tt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var s=0;s<e.length;++s)r[n+s]=e[s]};se.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Ac,1,0);if(Tt.isString(e)){var n=se.alloc(r=q0.length(e));q0.decode(e,n,0),e=n}return this.uint32(r)._push(W2,r,e)};se.prototype.string=function(e){var r=z0.length(e);return r?this.uint32(r)._push(z0.write,r,e):this._push(Ac,1,0)};se.prototype.fork=function(){return this.states=new G2(this),this.head=this.tail=new Pi(Cc,0,0),this.len=0,this};se.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Pi(Cc,0,0),this.len=0),this};se.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};se.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};se._configure=function(t){Ec=t,se.create=V0(),Ec._configure()}});var W0=k((G5,H0)=>{"use strict";H0.exports=sr;var G0=Yo();(sr.prototype=Object.create(G0.prototype)).constructor=sr;var rn=nr();function sr(){G0.call(this)}sr._configure=function(){sr.alloc=rn._Buffer_allocUnsafe,sr.writeBytesBuffer=rn.Buffer&&rn.Buffer.prototype instanceof Uint8Array&&rn.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var s=0;s<e.length;)r[n++]=e[s++]}};sr.prototype.bytes=function(e){rn.isString(e)&&(e=rn._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(sr.writeBytesBuffer,r,e),this};function $2(t,e,r){t.length<40?rn.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}sr.prototype.string=function(e){var r=rn.Buffer.byteLength(e);return this.uint32(r),r&&this._push($2,r,e),this};sr._configure()});var ta=k((H5,X0)=>{"use strict";X0.exports=Oe;var ir=nr(),_c,J0=ir.LongBits,j2=ir.utf8;function Kt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Oe(t){this.buf=t,this.pos=0,this.len=t.length}var $0=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Oe(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Oe(e);throw Error("illegal buffer")},Z0=function(){return ir.Buffer?function(r){return(Oe.create=function(s){return ir.Buffer.isBuffer(s)?new _c(s):$0(s)})(r)}:$0};Oe.create=Z0();Oe.prototype._slice=ir.Array.prototype.subarray||ir.Array.prototype.slice;Oe.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Kt(this,10);return e}}();Oe.prototype.int32=function(){return this.uint32()|0};Oe.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Tc(){var t=new J0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Kt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Kt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Oe.prototype.bool=function(){return this.uint32()!==0};function ea(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Oe.prototype.fixed32=function(){if(this.pos+4>this.len)throw Kt(this,4);return ea(this.buf,this.pos+=4)};Oe.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Kt(this,4);return ea(this.buf,this.pos+=4)|0};function j0(){if(this.pos+8>this.len)throw Kt(this,8);return new J0(ea(this.buf,this.pos+=4),ea(this.buf,this.pos+=4))}Oe.prototype.float=function(){if(this.pos+4>this.len)throw Kt(this,4);var e=ir.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Oe.prototype.double=function(){if(this.pos+8>this.len)throw Kt(this,4);var e=ir.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Oe.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Kt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Oe.prototype.string=function(){var e=this.bytes();return j2.read(e,0,e.length)};Oe.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Kt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Kt(this);while(this.buf[this.pos++]&128);return this};Oe.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Oe._configure=function(t){_c=t,Oe.create=Z0(),_c._configure();var e=ir.Long?"toLong":"toNumber";ir.merge(Oe.prototype,{int64:function(){return Tc.call(this)[e](!1)},uint64:function(){return Tc.call(this)[e](!0)},sint64:function(){return Tc.call(this).zzDecode()[e](!1)},fixed64:function(){return j0.call(this)[e](!0)},sfixed64:function(){return j0.call(this)[e](!1)}})}});var td=k((W5,ed)=>{"use strict";ed.exports=Rn;var Y0=ta();(Rn.prototype=Object.create(Y0.prototype)).constructor=Rn;var Q0=nr();function Rn(t){Y0.call(this,t)}Rn._configure=function(){Q0.Buffer&&(Rn.prototype._slice=Q0.Buffer.prototype.slice)};Rn.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Rn._configure()});var nd=k(($5,rd)=>{"use strict";rd.exports=Ri;var Pc=nr();(Ri.prototype=Object.create(Pc.EventEmitter.prototype)).constructor=Ri;function Ri(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Pc.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}Ri.prototype.rpcCall=function t(e,r,n,s,i){if(!s)throw TypeError("request must be specified");var o=this;if(!i)return Pc.asPromise(t,o,e,r,n,s);if(!o.rpcImpl){setTimeout(function(){i(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(c,f){if(c)return o.emit("error",c,e),i(c);if(f===null){o.end(!0);return}if(!(f instanceof n))try{f=n[o.responseDelimited?"decodeDelimited":"decode"](f)}catch(u){return o.emit("error",u,e),i(u)}return o.emit("data",f,e),i(null,f)})}catch(a){o.emit("error",a,e),setTimeout(function(){i(a)},0);return}};Ri.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Rc=k(sd=>{"use strict";var J2=sd;J2.Service=nd()});var kc=k((J5,id)=>{"use strict";id.exports={}});var ud=k(ad=>{"use strict";var ht=ad;ht.build="minimal";ht.Writer=Yo();ht.BufferWriter=W0();ht.Reader=ta();ht.BufferReader=td();ht.util=nr();ht.rpc=Rc();ht.roots=kc();ht.configure=od;function od(){ht.util._configure(),ht.Writer._configure(ht.BufferWriter),ht.Reader._configure(ht.BufferReader)}od()});var fd=k((X5,cd)=>{"use strict";cd.exports=Oc;function Oc(t,e){typeof t=="string"&&(e=t,t=void 0);var r=[];function n(i){if(typeof i!="string"){var o=s();if(Oc.verbose&&console.log("codegen: "+o),o="return "+o,i){for(var a=Object.keys(i),c=new Array(a.length+1),f=new Array(a.length),u=0;u<a.length;)c[u]=a[u],f[u]=i[a[u++]];return c[u]=o,Function.apply(null,c).apply(null,f)}return Function(o)()}for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l]=arguments[++l];if(l=0,i=i.replace(/%([%dfijs])/g,function(p,d){var y=h[l++];switch(d){case"d":case"f":return String(Number(y));case"i":return String(Math.floor(y));case"j":return JSON.stringify(y);case"s":return String(y)}return"%"}),l!==h.length)throw Error("parameter count mismatch");return r.push(i),n}function s(i){return"function "+(i||e||"")+"("+(t&&t.join(",")||"")+`){
  `+r.join(`
  `)+`
}`}return n.toString=s,n}Oc.verbose=!1});var ld=k((Q5,hd)=>{"use strict";hd.exports=ki;var Z2=jo(),X2=Xo(),Mc=X2("fs");function ki(t,e,r){return typeof e=="function"?(r=e,e={}):e||(e={}),r?!e.xhr&&Mc&&Mc.readFile?Mc.readFile(t,function(s,i){return s&&typeof XMLHttpRequest<"u"?ki.xhr(t,e,r):s?r(s):r(null,e.binary?i:i.toString("utf8"))}):ki.xhr(t,e,r):Z2(ki,this,t,e)}ki.xhr=function(e,r,n){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(s.readyState===4){if(s.status!==0&&s.status!==200)return n(Error("status "+s.status));if(r.binary){var o=s.response;if(!o){o=[];for(var a=0;a<s.responseText.length;++a)o.push(s.responseText.charCodeAt(a)&255)}return n(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return n(null,s.responseText)}},r.binary&&("overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),s.responseType="arraybuffer"),s.open("GET",e),s.send()}});var gd=k(dd=>{"use strict";var Fc=dd,pd=Fc.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},Nc=Fc.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var r=e.split("/"),n=pd(e),s="";n&&(s=r.shift()+"/");for(var i=0;i<r.length;)r[i]===".."?i>0&&r[i-1]!==".."?r.splice(--i,2):n?r.splice(i,1):++i:r[i]==="."?r.splice(i,1):++i;return s+r.join("/")};Fc.resolve=function(e,r,n){return n||(r=Nc(r)),pd(r)?r:(n||(e=Nc(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?Nc(e+"/"+r):r)}});var kn=k(yd=>{"use strict";var Oi=yd,Q2=We(),Y2=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Mi(t,e){var r=0,n={};for(e|=0;r<t.length;)n[Y2[r+e]]=t[r++];return n}Oi.basic=Mi([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);Oi.defaults=Mi([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Q2.emptyArray,null]);Oi.long=Mi([0,0,0,1,1],7);Oi.mapKey=Mi([0,0,0,5,5,0,0,0,1,1,0,2],2);Oi.packed=Mi([1,5,0,0,0,5,5,0,0,0,1,1,0])});var nn=k((tT,Dd)=>{"use strict";Dd.exports=_t;var ra=On();((_t.prototype=Object.create(ra.prototype)).constructor=_t).className="Field";var md=Gt(),bd=kn(),Ue=We(),Lc,ew=/^required|optional|repeated$/;_t.fromJSON=function(e,r){return new _t(e,r.id,r.type,r.rule,r.extend,r.options,r.comment)};function _t(t,e,r,n,s,i,o){if(Ue.isObject(n)?(o=s,i=n,n=s=void 0):Ue.isObject(s)&&(o=i,i=s,s=void 0),ra.call(this,t,i),!Ue.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!Ue.isString(r))throw TypeError("type must be a string");if(n!==void 0&&!ew.test(n=n.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(s!==void 0&&!Ue.isString(s))throw TypeError("extend must be a string");n==="proto3_optional"&&(n="optional"),this.rule=n&&n!=="optional"?n:void 0,this.type=r,this.id=e,this.extend=s||void 0,this.required=n==="required",this.optional=!this.required,this.repeated=n==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=Ue.Long?bd.long[r]!==void 0:!1,this.bytes=r==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(_t.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});_t.prototype.setOption=function(e,r,n){return e==="packed"&&(this._packed=null),ra.prototype.setOption.call(this,e,r,n)};_t.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return Ue.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};_t.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=bd.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof Lc?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof md&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof md))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=Ue.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;Ue.base64.test(this.typeDefault)?Ue.base64.decode(this.typeDefault,e=Ue.newBuffer(Ue.base64.length(this.typeDefault)),0):Ue.utf8.write(this.typeDefault,e=Ue.newBuffer(Ue.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=Ue.emptyObject:this.repeated?this.defaultValue=Ue.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof Lc&&(this.parent.ctor.prototype[this.name]=this.defaultValue),ra.prototype.resolve.call(this)};_t.d=function(e,r,n,s){return typeof r=="function"?r=Ue.decorateType(r).name:r&&typeof r=="object"&&(r=Ue.decorateEnum(r).name),function(o,a){Ue.decorateType(o.constructor).add(new _t(a,e,r,n,{default:s}))}};_t._configure=function(e){Lc=e}});var ys=k((rT,xd)=>{"use strict";xd.exports=Pt;var sa=On();((Pt.prototype=Object.create(sa.prototype)).constructor=Pt).className="OneOf";var vd=nn(),na=We();function Pt(t,e,r,n){if(Array.isArray(e)||(r=e,e=void 0),sa.call(this,t,r),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=n}Pt.fromJSON=function(e,r){return new Pt(e,r.oneof,r.options,r.comment)};Pt.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return na.toObject(["options",this.options,"oneof",this.oneof,"comment",r?this.comment:void 0])};function wd(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}Pt.prototype.add=function(e){if(!(e instanceof vd))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,wd(this),this};Pt.prototype.remove=function(e){if(!(e instanceof vd))throw TypeError("field must be a Field");var r=this.fieldsArray.indexOf(e);if(r<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(r,1),r=this.oneof.indexOf(e.name),r>-1&&this.oneof.splice(r,1),e.partOf=null,this};Pt.prototype.onAdd=function(e){sa.prototype.onAdd.call(this,e);for(var r=this,n=0;n<this.oneof.length;++n){var s=e.get(this.oneof[n]);s&&!s.partOf&&(s.partOf=r,r.fieldsArray.push(s))}wd(this)};Pt.prototype.onRemove=function(e){for(var r=0,n;r<this.fieldsArray.length;++r)(n=this.fieldsArray[r]).parent&&n.parent.remove(n);sa.prototype.onRemove.call(this,e)};Pt.d=function(){for(var e=new Array(arguments.length),r=0;r<arguments.length;)e[r]=arguments[r++];return function(s,i){na.decorateType(s.constructor).add(new Pt(i,e)),Object.defineProperty(s,i,{get:na.oneOfGetter(e),set:na.oneOfSetter(e)})}}});var Ds=k((nT,Ad)=>{"use strict";Ad.exports=ae;var Uc=On();((ae.prototype=Object.create(Uc.prototype)).constructor=ae).className="Namespace";var Ed=nn(),ia=We(),tw=ys(),ms,Ni,bs;ae.fromJSON=function(e,r){return new ae(e,r.options).addJSON(r.nested)};function Sd(t,e){if(!!(t&&t.length)){for(var r={},n=0;n<t.length;++n)r[t[n].name]=t[n].toJSON(e);return r}}ae.arrayToJSON=Sd;ae.isReservedId=function(e,r){if(e){for(var n=0;n<e.length;++n)if(typeof e[n]!="string"&&e[n][0]<=r&&e[n][1]>r)return!0}return!1};ae.isReservedName=function(e,r){if(e){for(var n=0;n<e.length;++n)if(e[n]===r)return!0}return!1};function ae(t,e){Uc.call(this,t,e),this.nested=void 0,this._nestedArray=null}function Cd(t){return t._nestedArray=null,t}Object.defineProperty(ae.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=ia.toArray(this.nested))}});ae.prototype.toJSON=function(e){return ia.toObject(["options",this.options,"nested",Sd(this.nestedArray,e)])};ae.prototype.addJSON=function(e){var r=this;if(e)for(var n=Object.keys(e),s=0,i;s<n.length;++s)i=e[n[s]],r.add((i.fields!==void 0?ms.fromJSON:i.values!==void 0?bs.fromJSON:i.methods!==void 0?Ni.fromJSON:i.id!==void 0?Ed.fromJSON:ae.fromJSON)(n[s],i));return this};ae.prototype.get=function(e){return this.nested&&this.nested[e]||null};ae.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof bs)return this.nested[e].values;throw Error("no such enum: "+e)};ae.prototype.add=function(e){if(!(e instanceof Ed&&e.extend!==void 0||e instanceof ms||e instanceof tw||e instanceof bs||e instanceof Ni||e instanceof ae))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var r=this.get(e.name);if(r)if(r instanceof ae&&e instanceof ae&&!(r instanceof ms||r instanceof Ni)){for(var n=r.nestedArray,s=0;s<n.length;++s)e.add(n[s]);this.remove(r),this.nested||(this.nested={}),e.setOptions(r.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),Cd(this)};ae.prototype.remove=function(e){if(!(e instanceof Uc))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),Cd(this)};ae.prototype.define=function(e,r){if(ia.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var n=this;e.length>0;){var s=e.shift();if(n.nested&&n.nested[s]){if(n=n.nested[s],!(n instanceof ae))throw Error("path conflicts with non-namespace objects")}else n.add(n=new ae(s))}return r&&n.addJSON(r),n};ae.prototype.resolveAll=function(){for(var e=this.nestedArray,r=0;r<e.length;)e[r]instanceof ae?e[r++].resolveAll():e[r++].resolve();return this.resolve()};ae.prototype.lookup=function(e,r,n){if(typeof r=="boolean"?(n=r,r=void 0):r&&!Array.isArray(r)&&(r=[r]),ia.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),r);var s=this.get(e[0]);if(s){if(e.length===1){if(!r||r.indexOf(s.constructor)>-1)return s}else if(s instanceof ae&&(s=s.lookup(e.slice(1),r,!0)))return s}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof ae&&(s=this._nestedArray[i].lookup(e,r,!0)))return s;return this.parent===null||n?null:this.parent.lookup(e,r)};ae.prototype.lookupType=function(e){var r=this.lookup(e,[ms]);if(!r)throw Error("no such type: "+e);return r};ae.prototype.lookupEnum=function(e){var r=this.lookup(e,[bs]);if(!r)throw Error("no such Enum '"+e+"' in "+this);return r};ae.prototype.lookupTypeOrEnum=function(e){var r=this.lookup(e,[ms,bs]);if(!r)throw Error("no such Type or Enum '"+e+"' in "+this);return r};ae.prototype.lookupService=function(e){var r=this.lookup(e,[Ni]);if(!r)throw Error("no such Service '"+e+"' in "+this);return r};ae._configure=function(t,e,r){ms=t,Ni=e,bs=r}});var oa=k((sT,Id)=>{"use strict";Id.exports=Pr;var qc=nn();((Pr.prototype=Object.create(qc.prototype)).constructor=Pr).className="MapField";var rw=kn(),Fi=We();function Pr(t,e,r,n,s,i){if(qc.call(this,t,e,n,void 0,void 0,s,i),!Fi.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}Pr.fromJSON=function(e,r){return new Pr(e,r.id,r.keyType,r.type,r.options,r.comment)};Pr.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return Fi.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};Pr.prototype.resolve=function(){if(this.resolved)return this;if(rw.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return qc.prototype.resolve.call(this)};Pr.d=function(e,r,n){return typeof n=="function"?n=Fi.decorateType(n).name:n&&typeof n=="object"&&(n=Fi.decorateEnum(n).name),function(i,o){Fi.decorateType(i.constructor).add(new Pr(o,e,r,n))}}});var aa=k((iT,Bd)=>{"use strict";Bd.exports=Mn;var zc=On();((Mn.prototype=Object.create(zc.prototype)).constructor=Mn).className="Method";var vs=We();function Mn(t,e,r,n,s,i,o,a,c){if(vs.isObject(s)?(o=s,s=i=void 0):vs.isObject(i)&&(o=i,i=void 0),!(e===void 0||vs.isString(e)))throw TypeError("type must be a string");if(!vs.isString(r))throw TypeError("requestType must be a string");if(!vs.isString(n))throw TypeError("responseType must be a string");zc.call(this,t,o),this.type=e||"rpc",this.requestType=r,this.requestStream=s?!0:void 0,this.responseType=n,this.responseStream=i?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=c}Mn.fromJSON=function(e,r){return new Mn(e,r.type,r.requestType,r.responseType,r.requestStream,r.responseStream,r.options,r.comment,r.parsedOptions)};Mn.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return vs.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",r?this.comment:void 0,"parsedOptions",this.parsedOptions])};Mn.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),zc.prototype.resolve.call(this))}});var ua=k((oT,_d)=>{"use strict";_d.exports=Rt;var sn=Ds();((Rt.prototype=Object.create(sn.prototype)).constructor=Rt).className="Service";var Vc=aa(),Li=We(),nw=Rc();function Rt(t,e){sn.call(this,t,e),this.methods={},this._methodsArray=null}Rt.fromJSON=function(e,r){var n=new Rt(e,r.options);if(r.methods)for(var s=Object.keys(r.methods),i=0;i<s.length;++i)n.add(Vc.fromJSON(s[i],r.methods[s[i]]));return r.nested&&n.addJSON(r.nested),n.comment=r.comment,n};Rt.prototype.toJSON=function(e){var r=sn.prototype.toJSON.call(this,e),n=e?Boolean(e.keepComments):!1;return Li.toObject(["options",r&&r.options||void 0,"methods",sn.arrayToJSON(this.methodsArray,e)||{},"nested",r&&r.nested||void 0,"comment",n?this.comment:void 0])};Object.defineProperty(Rt.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Li.toArray(this.methods))}});function Td(t){return t._methodsArray=null,t}Rt.prototype.get=function(e){return this.methods[e]||sn.prototype.get.call(this,e)};Rt.prototype.resolveAll=function(){for(var e=this.methodsArray,r=0;r<e.length;++r)e[r].resolve();return sn.prototype.resolve.call(this)};Rt.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof Vc?(this.methods[e.name]=e,e.parent=this,Td(this)):sn.prototype.add.call(this,e)};Rt.prototype.remove=function(e){if(e instanceof Vc){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,Td(this)}return sn.prototype.remove.call(this,e)};Rt.prototype.create=function(e,r,n){for(var s=new nw.Service(e,r,n),i=0,o;i<this.methodsArray.length;++i){var a=Li.lcFirst((o=this._methodsArray[i]).resolve().name).replace(/[^$\w_]/g,"");s[a]=Li.codegen(["r","c"],Li.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return s}});var ca=k((aT,Pd)=>{"use strict";Pd.exports=or;var sw=nr();function or(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)this[e[r]]=t[e[r]]}or.create=function(e){return this.$type.create(e)};or.encode=function(e,r){return this.$type.encode(e,r)};or.encodeDelimited=function(e,r){return this.$type.encodeDelimited(e,r)};or.decode=function(e){return this.$type.decode(e)};or.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};or.verify=function(e){return this.$type.verify(e)};or.fromObject=function(e){return this.$type.fromObject(e)};or.toObject=function(e,r){return this.$type.toObject(e,r)};or.prototype.toJSON=function(){return this.$type.toObject(this,sw.toJSONOptions)}});var Kc=k((uT,kd)=>{"use strict";kd.exports=aw;var iw=Gt(),Rr=kn(),Rd=We();function ow(t){return"missing required '"+t.name+"'"}function aw(t){var e=Rd.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var r=0;r<t.fieldsArray.length;++r){var n=t._fieldsArray[r].resolve(),s=n.resolvedType instanceof iw?"int32":n.type,i="m"+Rd.safeProp(n.name);e("case %i: {",n.id),n.map?(e("if(%s===util.emptyObject)",i)("%s={}",i)("var c2 = r.uint32()+r.pos"),Rr.defaults[n.keyType]!==void 0?e("k=%j",Rr.defaults[n.keyType]):e("k=null"),Rr.defaults[s]!==void 0?e("value=%j",Rr.defaults[s]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",n.keyType)("case 2:"),Rr.basic[s]===void 0?e("value=types[%i].decode(r,r.uint32())",r):e("value=r.%s()",s),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Rr.long[n.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',i):e("%s[k]=value",i)):n.repeated?(e("if(!(%s&&%s.length))",i,i)("%s=[]",i),Rr.packed[s]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",i,s)("}else"),Rr.basic[s]===void 0?e(n.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",i,r):e("%s.push(r.%s())",i,s)):Rr.basic[s]===void 0?e(n.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",i,r):e("%s=r.%s()",i,s),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<t._fieldsArray.length;++r){var o=t._fieldsArray[r];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",ow(o))}return e("return m")}});var Wc=k((cT,Od)=>{"use strict";Od.exports=fw;var uw=Gt(),Gc=We();function kt(t,e){return t.name+": "+e+(t.repeated&&e!=="array"?"[]":t.map&&e!=="object"?"{k:"+t.keyType+"}":"")+" expected"}function Hc(t,e,r,n){if(e.resolvedType)if(e.resolvedType instanceof uw){t("switch(%s){",n)("default:")("return%j",kt(e,"enum value"));for(var s=Object.keys(e.resolvedType.values),i=0;i<s.length;++i)t("case %i:",e.resolvedType.values[s[i]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",r,n)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",n)("return%j",kt(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",kt(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',n)("return%j",kt(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',n)("return%j",kt(e,"boolean"));break;case"string":t("if(!util.isString(%s))",n)("return%j",kt(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",kt(e,"buffer"));break}return t}function cw(t,e,r){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",r)("return%j",kt(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",r)("return%j",kt(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",r)("return%j",kt(e,"boolean key"));break}return t}function fw(t){var e=Gc.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=t.oneofsArray,n={};r.length&&e("var p={}");for(var s=0;s<t.fieldsArray.length;++s){var i=t._fieldsArray[s].resolve(),o="m"+Gc.safeProp(i.name);if(i.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,i.name),i.map)e("if(!util.isObject(%s))",o)("return%j",kt(i,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),cw(e,i,"k[i]"),Hc(e,i,s,o+"[k[i]]")("}");else if(i.repeated)e("if(!Array.isArray(%s))",o)("return%j",kt(i,"array"))("for(var i=0;i<%s.length;++i){",o),Hc(e,i,s,o+"[i]")("}");else{if(i.partOf){var a=Gc.safeProp(i.partOf.name);n[i.partOf.name]===1&&e("if(p%s===1)",a)("return%j",i.partOf.name+": multiple values"),n[i.partOf.name]=1,e("p%s=1",a)}Hc(e,i,s,o)}i.optional&&e("}")}return e("return null")}});var Jc=k(Nd=>{"use strict";var Md=Nd,Ui=Gt(),ar=We();function $c(t,e,r,n){var s=!1;if(e.resolvedType)if(e.resolvedType instanceof Ui){t("switch(d%s){",n);for(var i=e.resolvedType.values,o=Object.keys(i),a=0;a<o.length;++a)i[o[a]]===e.typeDefault&&!s&&(t("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',n,n,n),e.repeated||t("break"),s=!0),t("case%j:",o[a])("case %i:",i[o[a]])("m%s=%j",n,i[o[a]])("break");t("}")}else t('if(typeof d%s!=="object")',n)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",n,r,n);else{var c=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",n,n);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",n,n);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",n,n);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",n,n,c)('else if(typeof d%s==="string")',n)("m%s=parseInt(d%s,10)",n,n)('else if(typeof d%s==="number")',n)("m%s=d%s",n,n)('else if(typeof d%s==="object")',n)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",n,n,n,c?"true":"");break;case"bytes":t('if(typeof d%s==="string")',n)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",n,n,n)("else if(d%s.length >= 0)",n)("m%s=d%s",n,n);break;case"string":t("m%s=String(d%s)",n,n);break;case"bool":t("m%s=Boolean(d%s)",n,n);break}}return t}Md.fromObject=function(e){var r=e.fieldsArray,n=ar.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!r.length)return n("return new this.ctor");n("var m=new this.ctor");for(var s=0;s<r.length;++s){var i=r[s].resolve(),o=ar.safeProp(i.name);i.map?(n("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",i.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),$c(n,i,s,o+"[ks[i]]")("}")("}")):i.repeated?(n("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",i.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),$c(n,i,s,o+"[i]")("}")("}")):(i.resolvedType instanceof Ui||n("if(d%s!=null){",o),$c(n,i,s,o),i.resolvedType instanceof Ui||n("}"))}return n("return m")};function jc(t,e,r,n){if(e.resolvedType)e.resolvedType instanceof Ui?t("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",n,r,n,n,r,n,n):t("d%s=types[%i].toObject(m%s,o)",n,r,n);else{var s=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",n,n,n,n);break;case"uint64":s=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',n)("d%s=o.longs===String?String(m%s):m%s",n,n,n)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",n,n,n,n,s?"true":"",n);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",n,n,n,n,n);break;default:t("d%s=m%s",n,n);break}}return t}Md.toObject=function(e){var r=e.fieldsArray.slice().sort(ar.compareFieldsById);if(!r.length)return ar.codegen()("return {}");for(var n=ar.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),s=[],i=[],o=[],a=0;a<r.length;++a)r[a].partOf||(r[a].resolve().repeated?s:r[a].map?i:o).push(r[a]);if(s.length){for(n("if(o.arrays||o.defaults){"),a=0;a<s.length;++a)n("d%s=[]",ar.safeProp(s[a].name));n("}")}if(i.length){for(n("if(o.objects||o.defaults){"),a=0;a<i.length;++a)n("d%s={}",ar.safeProp(i[a].name));n("}")}if(o.length){for(n("if(o.defaults){"),a=0;a<o.length;++a){var c=o[a],f=ar.safeProp(c.name);if(c.resolvedType instanceof Ui)n("d%s=o.enums===String?%j:%j",f,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",f)("}else")("d%s=o.longs===String?%j:%i",f,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var u="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",f,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",f,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",f,f)("}")}else n("d%s=%j",f,c.typeDefault)}n("}")}var h=!1;for(a=0;a<r.length;++a){var c=r[a],l=e._fieldsArray.indexOf(c),f=ar.safeProp(c.name);c.map?(h||(h=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",f,f)("d%s={}",f)("for(var j=0;j<ks2.length;++j){"),jc(n,c,l,f+"[ks2[j]]")("}")):c.repeated?(n("if(m%s&&m%s.length){",f,f)("d%s=[]",f)("for(var j=0;j<m%s.length;++j){",f),jc(n,c,l,f+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",f,c.name),jc(n,c,l,f),c.partOf&&n("if(o.oneofs)")("d%s=%j",ar.safeProp(c.partOf.name),c.name)),n("}")}return n("return d")}});var Zc=k(Fd=>{"use strict";var hw=Fd,lw=ca();hw[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),r=this.lookup(e);if(r){var n=t["@type"].charAt(0)==="."?t["@type"].slice(1):t["@type"];return n.indexOf("/")===-1&&(n="/"+n),this.create({type_url:n,value:r.encode(r.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var r="type.googleapis.com/",n="",s="";if(e&&e.json&&t.type_url&&t.value){s=t.type_url.substring(t.type_url.lastIndexOf("/")+1),n=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1);var i=this.lookup(s);i&&(t=i.decode(t.value))}if(!(t instanceof this.ctor)&&t instanceof lw){var o=t.$type.toObject(t,e),a=t.$type.fullName[0]==="."?t.$type.fullName.slice(1):t.$type.fullName;return n===""&&(n=r),s=n+a,o["@type"]=s,o}return this.toObject(t,e)}}});var la=k((lT,Ud)=>{"use strict";Ud.exports=ge;var Ht=Ds();((ge.prototype=Object.create(Ht.prototype)).constructor=ge).className="Type";var pw=Gt(),Yc=ys(),fa=nn(),dw=oa(),gw=ua(),Xc=ca(),Qc=ta(),yw=Yo(),tt=We(),mw=ef(),bw=Kc(),Dw=Wc(),Ld=Jc(),vw=Zc();function ge(t,e){Ht.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(ge.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var r=this.fields[t[e]],n=r.id;if(this._fieldsById[n])throw Error("duplicate id "+n+" in "+this);this._fieldsById[n]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=tt.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=tt.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=ge.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof Xc||((t.prototype=new Xc).constructor=t,tt.merge(t.prototype,e)),t.$type=t.prototype.$type=this,tt.merge(t,Xc,!0),this._ctor=t;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var n={};for(r=0;r<this.oneofsArray.length;++r)n[this._oneofsArray[r].resolve().name]={get:tt.oneOfGetter(this._oneofsArray[r].oneof),set:tt.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(t.prototype,n)}}});ge.generateConstructor=function(e){for(var r=tt.codegen(["p"],e.name),n=0,s;n<e.fieldsArray.length;++n)(s=e._fieldsArray[n]).map?r("this%s={}",tt.safeProp(s.name)):s.repeated&&r("this%s=[]",tt.safeProp(s.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function ha(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}ge.fromJSON=function(e,r){var n=new ge(e,r.options);n.extensions=r.extensions,n.reserved=r.reserved;for(var s=Object.keys(r.fields),i=0;i<s.length;++i)n.add((typeof r.fields[s[i]].keyType<"u"?dw.fromJSON:fa.fromJSON)(s[i],r.fields[s[i]]));if(r.oneofs)for(s=Object.keys(r.oneofs),i=0;i<s.length;++i)n.add(Yc.fromJSON(s[i],r.oneofs[s[i]]));if(r.nested)for(s=Object.keys(r.nested),i=0;i<s.length;++i){var o=r.nested[s[i]];n.add((o.id!==void 0?fa.fromJSON:o.fields!==void 0?ge.fromJSON:o.values!==void 0?pw.fromJSON:o.methods!==void 0?gw.fromJSON:Ht.fromJSON)(s[i],o))}return r.extensions&&r.extensions.length&&(n.extensions=r.extensions),r.reserved&&r.reserved.length&&(n.reserved=r.reserved),r.group&&(n.group=!0),r.comment&&(n.comment=r.comment),n};ge.prototype.toJSON=function(e){var r=Ht.prototype.toJSON.call(this,e),n=e?Boolean(e.keepComments):!1;return tt.toObject(["options",r&&r.options||void 0,"oneofs",Ht.arrayToJSON(this.oneofsArray,e),"fields",Ht.arrayToJSON(this.fieldsArray.filter(function(s){return!s.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",r&&r.nested||void 0,"comment",n?this.comment:void 0])};ge.prototype.resolveAll=function(){for(var e=this.fieldsArray,r=0;r<e.length;)e[r++].resolve();var n=this.oneofsArray;for(r=0;r<n.length;)n[r++].resolve();return Ht.prototype.resolveAll.call(this)};ge.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};ge.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof fa&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),ha(this)}return e instanceof Yc?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),ha(this)):Ht.prototype.add.call(this,e)};ge.prototype.remove=function(e){if(e instanceof fa&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),ha(this)}if(e instanceof Yc){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),ha(this)}return Ht.prototype.remove.call(this,e)};ge.prototype.isReservedId=function(e){return Ht.isReservedId(this.reserved,e)};ge.prototype.isReservedName=function(e){return Ht.isReservedName(this.reserved,e)};ge.prototype.create=function(e){return new this.ctor(e)};ge.prototype.setup=function(){for(var e=this.fullName,r=[],n=0;n<this.fieldsArray.length;++n)r.push(this._fieldsArray[n].resolve().resolvedType);this.encode=mw(this)({Writer:yw,types:r,util:tt}),this.decode=bw(this)({Reader:Qc,types:r,util:tt}),this.verify=Dw(this)({types:r,util:tt}),this.fromObject=Ld.fromObject(this)({types:r,util:tt}),this.toObject=Ld.toObject(this)({types:r,util:tt});var s=vw[e];if(s){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=s.fromObject.bind(i),i.toObject=this.toObject,this.toObject=s.toObject.bind(i)}return this};ge.prototype.encode=function(e,r){return this.setup().encode(e,r)};ge.prototype.encodeDelimited=function(e,r){return this.encode(e,r&&r.len?r.fork():r).ldelim()};ge.prototype.decode=function(e,r){return this.setup().decode(e,r)};ge.prototype.decodeDelimited=function(e){return e instanceof Qc||(e=Qc.create(e)),this.decode(e,e.uint32())};ge.prototype.verify=function(e){return this.setup().verify(e)};ge.prototype.fromObject=function(e){return this.setup().fromObject(e)};ge.prototype.toObject=function(e,r){return this.setup().toObject(e,r)};ge.d=function(e){return function(n){tt.decorateType(n,e)}}});var ga=k((pT,Gd)=>{"use strict";Gd.exports=Dt;var da=Ds();((Dt.prototype=Object.create(da.prototype)).constructor=Dt).className="Root";var rf=nn(),zd=Gt(),ww=ys(),on=We(),Vd,tf,qi;function Dt(t){da.call(this,"",t),this.deferred=[],this.files=[]}Dt.fromJSON=function(e,r){return r||(r=new Dt),e.options&&r.setOptions(e.options),r.addJSON(e.nested)};Dt.prototype.resolvePath=on.path.resolve;Dt.prototype.fetch=on.fetch;function Kd(){}Dt.prototype.load=function t(e,r,n){typeof r=="function"&&(n=r,r=void 0);var s=this;if(!n)return on.asPromise(t,s,e,r);var i=n===Kd;function o(g,p){if(!!n){var d=n;if(n=null,i)throw g;d(g,p)}}function a(g){var p=g.lastIndexOf("google/protobuf/");if(p>-1){var d=g.substring(p);if(d in qi)return d}return null}function c(g,p){try{if(on.isString(p)&&p.charAt(0)==="{"&&(p=JSON.parse(p)),!on.isString(p))s.setOptions(p.options).addJSON(p.nested);else{tf.filename=g;var d=tf(p,s,r),y,m=0;if(d.imports)for(;m<d.imports.length;++m)(y=a(d.imports[m])||s.resolvePath(g,d.imports[m]))&&f(y);if(d.weakImports)for(m=0;m<d.weakImports.length;++m)(y=a(d.weakImports[m])||s.resolvePath(g,d.weakImports[m]))&&f(y,!0)}}catch(D){o(D)}!i&&!u&&o(null,s)}function f(g,p){if(!(s.files.indexOf(g)>-1)){if(s.files.push(g),g in qi){i?c(g,qi[g]):(++u,setTimeout(function(){--u,c(g,qi[g])}));return}if(i){var d;try{d=on.fs.readFileSync(g).toString("utf8")}catch(y){p||o(y);return}c(g,d)}else++u,s.fetch(g,function(y,m){if(--u,!!n){if(y){p?u||o(null,s):o(y);return}c(g,m)}})}}var u=0;on.isString(e)&&(e=[e]);for(var h=0,l;h<e.length;++h)(l=s.resolvePath("",e[h]))&&f(l);if(i)return s;u||o(null,s)};Dt.prototype.loadSync=function(e,r){if(!on.isNode)throw Error("not supported");return this.load(e,r,Kd)};Dt.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return da.prototype.resolveAll.call(this)};var pa=/^[A-Z]/;function qd(t,e){var r=e.parent.lookup(e.extend);if(r){var n=new rf(e.fullName,e.id,e.type,e.rule,void 0,e.options);return n.declaringField=e,e.extensionField=n,r.add(n),!0}return!1}Dt.prototype._handleAdd=function(e){if(e instanceof rf)e.extend!==void 0&&!e.extensionField&&(qd(this,e)||this.deferred.push(e));else if(e instanceof zd)pa.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof ww)){if(e instanceof Vd)for(var r=0;r<this.deferred.length;)qd(this,this.deferred[r])?this.deferred.splice(r,1):++r;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);pa.test(e.name)&&(e.parent[e.name]=e)}};Dt.prototype._handleRemove=function(e){if(e instanceof rf){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var r=this.deferred.indexOf(e);r>-1&&this.deferred.splice(r,1)}}else if(e instanceof zd)pa.test(e.name)&&delete e.parent[e.name];else if(e instanceof da){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);pa.test(e.name)&&delete e.parent[e.name]}};Dt._configure=function(t,e,r){Vd=t,tf=e,qi=r}});var We=k((dT,Wd)=>{"use strict";var Me=Wd.exports=nr(),Hd=kc(),nf,sf;Me.codegen=fd();Me.fetch=ld();Me.path=gd();Me.fs=Me.inquire("fs");Me.toArray=function(e){if(e){for(var r=Object.keys(e),n=new Array(r.length),s=0;s<r.length;)n[s]=e[r[s++]];return n}return[]};Me.toObject=function(e){for(var r={},n=0;n<e.length;){var s=e[n++],i=e[n++];i!==void 0&&(r[s]=i)}return r};var xw=/\\/g,Ew=/"/g;Me.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Me.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Me.isReserved(e)?'["'+e.replace(xw,"\\\\").replace(Ew,'\\"')+'"]':"."+e};Me.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var Sw=/_([a-z])/g;Me.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(Sw,function(r,n){return n.toUpperCase()})};Me.compareFieldsById=function(e,r){return e.id-r.id};Me.decorateType=function(e,r){if(e.$type)return r&&e.$type.name!==r&&(Me.decorateRoot.remove(e.$type),e.$type.name=r,Me.decorateRoot.add(e.$type)),e.$type;nf||(nf=la());var n=new nf(r||e.name);return Me.decorateRoot.add(n),n.ctor=e,Object.defineProperty(e,"$type",{value:n,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:n,enumerable:!1}),n};var Cw=0;Me.decorateEnum=function(e){if(e.$type)return e.$type;sf||(sf=Gt());var r=new sf("Enum"+Cw++,e);return Me.decorateRoot.add(r),Object.defineProperty(e,"$type",{value:r,enumerable:!1}),r};Me.setProperty=function(e,r,n){function s(i,o,a){var c=o.shift();if(c==="__proto__")return i;if(o.length>0)i[c]=s(i[c]||{},o,a);else{var f=i[c];f&&(a=[].concat(f).concat(a)),i[c]=a}return i}if(typeof e!="object")throw TypeError("dst must be an object");if(!r)throw TypeError("path must be specified");return r=r.split("."),s(e,r,n)};Object.defineProperty(Me,"decorateRoot",{get:function(){return Hd.decorated||(Hd.decorated=new(ga()))}})});var On=k((gT,$d)=>{"use strict";$d.exports=vt;vt.className="ReflectionObject";var ya=We(),ma;function vt(t,e){if(!ya.isString(t))throw TypeError("name must be a string");if(e&&!ya.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(vt.prototype,{root:{get:function(){for(var t=this;t.parent!==null;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}});vt.prototype.toJSON=function(){throw Error()};vt.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var r=e.root;r instanceof ma&&r._handleAdd(this)};vt.prototype.onRemove=function(e){var r=e.root;r instanceof ma&&r._handleRemove(this),this.parent=null,this.resolved=!1};vt.prototype.resolve=function(){return this.resolved?this:(this.root instanceof ma&&(this.resolved=!0),this)};vt.prototype.getOption=function(e){if(this.options)return this.options[e]};vt.prototype.setOption=function(e,r,n){return(!n||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=r),this};vt.prototype.setParsedOption=function(e,r,n){this.parsedOptions||(this.parsedOptions=[]);var s=this.parsedOptions;if(n){var i=s.find(function(c){return Object.prototype.hasOwnProperty.call(c,e)});if(i){var o=i[e];ya.setProperty(o,n,r)}else i={},i[e]=ya.setProperty({},n,r),s.push(i)}else{var a={};a[e]=r,s.push(a)}return this};vt.prototype.setOptions=function(e,r){if(e)for(var n=Object.keys(e),s=0;s<n.length;++s)this.setOption(n[s],e[n[s]],r);return this};vt.prototype.toString=function(){var e=this.constructor.className,r=this.fullName;return r.length?e+" "+r:e};vt._configure=function(t){ma=t}});var Gt=k((yT,Zd)=>{"use strict";Zd.exports=ur;var jd=On();((ur.prototype=Object.create(jd.prototype)).constructor=ur).className="Enum";var Jd=Ds(),ba=We();function ur(t,e,r,n,s,i){if(jd.call(this,t,r),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=s||{},this.valuesOptions=i,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}ur.fromJSON=function(e,r){var n=new ur(e,r.values,r.options,r.comment,r.comments);return n.reserved=r.reserved,n};ur.prototype.toJSON=function(e){var r=e?Boolean(e.keepComments):!1;return ba.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",r?this.comment:void 0,"comments",r?this.comments:void 0])};ur.prototype.add=function(e,r,n,s){if(!ba.isString(e))throw TypeError("name must be a string");if(!ba.isInteger(r))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(r))throw Error("id "+r+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[r]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+r+" in "+this);this.values[e]=r}else this.valuesById[this.values[e]=r]=e;return s&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=s||null),this.comments[e]=n||null,this};ur.prototype.remove=function(e){if(!ba.isString(e))throw TypeError("name must be a string");var r=this.values[e];if(r==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[r],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};ur.prototype.isReservedId=function(e){return Jd.isReservedId(this.reserved,e)};ur.prototype.isReservedName=function(e){return Jd.isReservedName(this.reserved,e)}});var ef=k((mT,Qd)=>{"use strict";Qd.exports=Iw;var Aw=Gt(),of=kn(),af=We();function Xd(t,e,r,n){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,n,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,n,(e.id<<3|2)>>>0)}function Iw(t){for(var e=af.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),r,n,s=t.fieldsArray.slice().sort(af.compareFieldsById),r=0;r<s.length;++r){var i=s[r].resolve(),o=t._fieldsArray.indexOf(i),a=i.resolvedType instanceof Aw?"int32":i.type,c=of.basic[a];n="m"+af.safeProp(i.name),i.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",n,i.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",n)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(i.id<<3|2)>>>0,8|of.mapKey[i.keyType],i.keyType),c===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,n):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,a,n),e("}")("}")):i.repeated?(e("if(%s!=null&&%s.length){",n,n),i.packed&&of.packed[a]!==void 0?e("w.uint32(%i).fork()",(i.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",n)("w.%s(%s[i])",a,n)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",n),c===void 0?Xd(e,i,o,n+"[i]"):e("w.uint32(%i).%s(%s[i])",(i.id<<3|c)>>>0,a,n)),e("}")):(i.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",n,i.name),c===void 0?Xd(e,i,o,n):e("w.uint32(%i).%s(%s)",(i.id<<3|c)>>>0,a,n))}return e("return w")}});var eg=k((bT,Yd)=>{"use strict";var Y=Yd.exports=ud();Y.build="light";function Bw(t,e,r){return typeof e=="function"?(r=e,e=new Y.Root):e||(e=new Y.Root),e.load(t,r)}Y.load=Bw;function Tw(t,e){return e||(e=new Y.Root),e.loadSync(t)}Y.loadSync=Tw;Y.encoder=ef();Y.decoder=Kc();Y.verifier=Wc();Y.converter=Jc();Y.ReflectionObject=On();Y.Namespace=Ds();Y.Root=ga();Y.Enum=Gt();Y.Type=la();Y.Field=nn();Y.OneOf=ys();Y.MapField=oa();Y.Service=ua();Y.Method=aa();Y.Message=ca();Y.wrappers=Zc();Y.types=kn();Y.util=We();Y.ReflectionObject._configure(Y.Root);Y.Namespace._configure(Y.Type,Y.Service,Y.Enum);Y.Root._configure(Y.Type);Y.Field._configure(Y.Type)});var cf=k((DT,ng)=>{"use strict";ng.exports=rg;var uf=/[\s{}=;:[\],'"()<>]/g,_w=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,Pw=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,Rw=/^ *[*/]+ */,kw=/^\s*\*?\/*/,Ow=/\n/g,Mw=/\s/,Nw=/\\(.?)/g,Fw={0:"\0",r:"\r",n:`
`,t:"	"};function tg(t){return t.replace(Nw,function(e,r){switch(r){case"\\":case"":return r;default:return Fw[r]||""}})}rg.unescape=tg;function rg(t,e){t=t.toString();var r=0,n=t.length,s=1,i=0,o={},a=[],c=null;function f(w){return Error("illegal "+w+" (line "+s+")")}function u(){var w=c==="'"?Pw:_w;w.lastIndex=r-1;var b=w.exec(t);if(!b)throw f("string");return r=w.lastIndex,y(c),c=null,tg(b[1])}function h(w){return t.charAt(w)}function l(w,b,x){var C={type:t.charAt(w++),lineEmpty:!1,leading:x},I;e?I=2:I=3;var O=w-I,X;do if(--O<0||(X=t.charAt(O))===`
`){C.lineEmpty=!0;break}while(X===" "||X==="	");for(var fe=t.substring(w,b).split(Ow),Q=0;Q<fe.length;++Q)fe[Q]=fe[Q].replace(e?kw:Rw,"").trim();C.text=fe.join(`
`).trim(),o[s]=C,i=s}function g(w){var b=p(w),x=t.substring(w,b),C=/^\s*\/{1,2}/.test(x);return C}function p(w){for(var b=w;b<n&&h(b)!==`
`;)b++;return b}function d(){if(a.length>0)return a.shift();if(c)return u();var w,b,x,C,I,O=r===0;do{if(r===n)return null;for(w=!1;Mw.test(x=h(r));)if(x===`
`&&(O=!0,++s),++r===n)return null;if(h(r)==="/"){if(++r===n)throw f("comment");if(h(r)==="/")if(e){if(C=r,I=!1,g(r)){I=!0;do if(r=p(r),r===n||(r++,!O))break;while(g(r))}else r=Math.min(n,p(r)+1);I&&(l(C,r,O),O=!0),s++,w=!0}else{for(I=h(C=r+1)==="/";h(++r)!==`
`;)if(r===n)return null;++r,I&&(l(C,r-1,O),O=!0),++s,w=!0}else if((x=h(r))==="*"){C=r+1,I=e||h(C)==="*";do{if(x===`
`&&++s,++r===n)throw f("comment");b=x,x=h(r)}while(b!=="*"||x!=="/");++r,I&&(l(C,r-2,O),O=!0),w=!0}else return"/"}}while(w);var X=r;uf.lastIndex=0;var fe=uf.test(h(X++));if(!fe)for(;X<n&&!uf.test(h(X));)++X;var Q=t.substring(r,r=X);return(Q==='"'||Q==="'")&&(c=Q),Q}function y(w){a.push(w)}function m(){if(!a.length){var w=d();if(w===null)return null;y(w)}return a[0]}function D(w,b){var x=m(),C=x===w;if(C)return d(),!0;if(!b)throw f("token '"+x+"', '"+w+"' expected");return!1}function E(w){var b=null,x;return w===void 0?(x=o[s-1],delete o[s-1],x&&(e||x.type==="*"||x.lineEmpty)&&(b=x.leading?x.text:null)):(i<w&&m(),x=o[w],delete o[w],x&&!x.lineEmpty&&(e||x.type==="/")&&(b=x.leading?null:x.text)),b}return Object.defineProperty({next:d,peek:m,push:y,skip:D,cmnt:E},"line",{get:function(){return s}})}});var cg=k((vT,ug)=>{"use strict";ug.exports=kr;kr.filename=null;kr.defaults={keepCase:!1};var Lw=cf(),sg=ga(),ig=la(),og=nn(),Uw=oa(),ag=ys(),qw=Gt(),zw=ua(),Vw=aa(),ff=kn(),hf=We(),Kw=/^[1-9][0-9]*$/,Gw=/^-?[1-9][0-9]*$/,Hw=/^0[x][0-9a-fA-F]+$/,Ww=/^-?0[x][0-9a-fA-F]+$/,$w=/^0[0-7]+$/,jw=/^-?0[0-7]+$/,Jw=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,cr=/^[a-zA-Z_][a-zA-Z_0-9]*$/,fr=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,Zw=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function kr(t,e,r){e instanceof sg||(r=e,e=new sg),r||(r=kr.defaults);var n=r.preferTrailingComment||!1,s=Lw(t,r.alternateCommentMode||!1),i=s.next,o=s.push,a=s.peek,c=s.skip,f=s.cmnt,u=!0,h,l,g,p,d=!1,y=e,m=r.keepCase?function(P){return P}:hf.camelCase;function D(P,R,M){var H=kr.filename;return M||(kr.filename=null),Error("illegal "+(R||"token")+" '"+P+"' ("+(H?H+", ":"")+"line "+s.line+")")}function E(){var P=[],R;do{if((R=i())!=='"'&&R!=="'")throw D(R);P.push(i()),c(R),R=a()}while(R==='"'||R==="'");return P.join("")}function w(P){var R=i();switch(R){case"'":case'"':return o(R),E();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return x(R,!0)}catch{if(P&&fr.test(R))return R;throw D(R,"value")}}function b(P,R){var M,H;do R&&((M=a())==='"'||M==="'")?P.push(E()):P.push([H=C(i()),c("to",!0)?C(i()):H]);while(c(",",!0));c(";")}function x(P,R){var M=1;switch(P.charAt(0)==="-"&&(M=-1,P=P.substring(1)),P){case"inf":case"INF":case"Inf":return M*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(Kw.test(P))return M*parseInt(P,10);if(Hw.test(P))return M*parseInt(P,16);if($w.test(P))return M*parseInt(P,8);if(Jw.test(P))return M*parseFloat(P);throw D(P,"number",R)}function C(P,R){switch(P){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!R&&P.charAt(0)==="-")throw D(P,"id");if(Gw.test(P))return parseInt(P,10);if(Ww.test(P))return parseInt(P,16);if(jw.test(P))return parseInt(P,8);throw D(P,"id")}function I(){if(h!==void 0)throw D("package");if(h=i(),!fr.test(h))throw D(h,"name");y=y.define(h),c(";")}function O(){var P=a(),R;switch(P){case"weak":R=g||(g=[]),i();break;case"public":i();default:R=l||(l=[]);break}P=E(),c(";"),R.push(P)}function X(){if(c("="),p=E(),d=p==="proto3",!d&&p!=="proto2")throw D(p,"syntax");c(";")}function fe(P,R){switch(R){case"option":return ct(P,R),c(";"),!0;case"message":return Tr(P,R),!0;case"enum":return is(P,R),!0;case"service":return y1(P,R),!0;case"extend":return b1(P,R),!0}return!1}function Q(P,R,M){var H=s.line;if(P&&(typeof P.comment!="string"&&(P.comment=f()),P.filename=kr.filename),c("{",!0)){for(var V;(V=i())!=="}";)R(V);c(";",!0)}else M&&M(),c(";"),P&&(typeof P.comment!="string"||n)&&(P.comment=f(H)||P.comment)}function Tr(P,R){if(!cr.test(R=i()))throw D(R,"type name");var M=new ig(R);Q(M,function(V){if(!fe(M,V))switch(V){case"map":et(M,V);break;case"required":case"repeated":Qe(M,V);break;case"optional":d?Qe(M,"proto3_optional"):Qe(M,"optional");break;case"oneof":G(M,V);break;case"extensions":b(M.extensions||(M.extensions=[]));break;case"reserved":b(M.reserved||(M.reserved=[]),!0);break;default:if(!d||!fr.test(V))throw D(V);o(V),Qe(M,"optional");break}}),P.add(M)}function Qe(P,R,M){var H=i();if(H==="group"){Ae(P,R);return}if(!fr.test(H))throw D(H,"type");var V=i();if(!cr.test(V))throw D(V,"name");V=m(V),c("=");var J=new og(V,C(i()),H,R,M);if(Q(J,function(bt){if(bt==="option")ct(J,bt),c(";");else throw D(bt)},function(){Hu(J)}),R==="proto3_optional"){var Ye=new ag("_"+V);J.setOption("proto3_optional",!0),Ye.add(J),P.add(Ye)}else P.add(J);!d&&J.repeated&&(ff.packed[H]!==void 0||ff.basic[H]===void 0)&&J.setOption("packed",!1,!0)}function Ae(P,R){var M=i();if(!cr.test(M))throw D(M,"name");var H=hf.lcFirst(M);M===H&&(M=hf.ucFirst(M)),c("=");var V=C(i()),J=new ig(M);J.group=!0;var Ye=new og(H,V,M,R);Ye.filename=kr.filename,Q(J,function(bt){switch(bt){case"option":ct(J,bt),c(";");break;case"required":case"repeated":Qe(J,bt);break;case"optional":d?Qe(J,"proto3_optional"):Qe(J,"optional");break;case"message":Tr(J,bt);break;case"enum":is(J,bt);break;default:throw D(bt)}}),P.add(J).add(Ye)}function et(P){c("<");var R=i();if(ff.mapKey[R]===void 0)throw D(R,"type");c(",");var M=i();if(!fr.test(M))throw D(M,"type");c(">");var H=i();if(!cr.test(H))throw D(H,"name");c("=");var V=new Uw(m(H),C(i()),R,M);Q(V,function(Ye){if(Ye==="option")ct(V,Ye),c(";");else throw D(Ye)},function(){Hu(V)}),P.add(V)}function G(P,R){if(!cr.test(R=i()))throw D(R,"name");var M=new ag(m(R));Q(M,function(V){V==="option"?(ct(M,V),c(";")):(o(V),Qe(M,"optional"))}),P.add(M)}function is(P,R){if(!cr.test(R=i()))throw D(R,"name");var M=new qw(R);Q(M,function(V){switch(V){case"option":ct(M,V),c(";");break;case"reserved":b(M.reserved||(M.reserved=[]),!0);break;default:Ci(M,V)}}),P.add(M)}function Ci(P,R){if(!cr.test(R))throw D(R,"name");c("=");var M=C(i(),!0),H={options:void 0};H.setOption=function(V,J){this.options===void 0&&(this.options={}),this.options[V]=J},Q(H,function(J){if(J==="option")ct(H,J),c(";");else throw D(J)},function(){Hu(H)}),P.add(R,M,H.comment,H.options)}function ct(P,R){var M=c("(",!0);if(!fr.test(R=i()))throw D(R,"name");var H=R,V=H,J;M&&(c(")"),H="("+H+")",V=H,R=a(),Zw.test(R)&&(J=R.slice(1),H+=R,i())),c("=");var Ye=os(P,H);g1(P,V,Ye,J)}function os(P,R){if(c("{",!0)){for(var M={};!c("}",!0);){if(!cr.test(ft=i()))throw D(ft,"name");var H,V=ft;if(c(":",!0),a()==="{")H=os(P,R+"."+ft);else if(a()==="["){H=[];var J;if(c("[",!0)){do J=w(!0),H.push(J);while(c(",",!0));c("]"),typeof J<"u"&&as(P,R+"."+ft,J)}}else H=w(!0),as(P,R+"."+ft,H);var Ye=M[V];Ye&&(H=[].concat(Ye).concat(H)),M[V]=H,c(",",!0),c(";",!0)}return M}var Yr=w(!0);return as(P,R,Yr),Yr}function as(P,R,M){P.setOption&&P.setOption(R,M)}function g1(P,R,M,H){P.setParsedOption&&P.setParsedOption(R,M,H)}function Hu(P){if(c("[",!0)){do ct(P,"option");while(c(",",!0));c("]")}return P}function y1(P,R){if(!cr.test(R=i()))throw D(R,"service name");var M=new zw(R);Q(M,function(V){if(!fe(M,V))if(V==="rpc")m1(M,V);else throw D(V)}),P.add(M)}function m1(P,R){var M=f(),H=R;if(!cr.test(R=i()))throw D(R,"name");var V=R,J,Ye,Yr,bt;if(c("("),c("stream",!0)&&(Ye=!0),!fr.test(R=i())||(J=R,c(")"),c("returns"),c("("),c("stream",!0)&&(bt=!0),!fr.test(R=i())))throw D(R);Yr=R,c(")");var zo=new Vw(V,H,J,Yr,Ye,bt);zo.comment=M,Q(zo,function(Wu){if(Wu==="option")ct(zo,Wu),c(";");else throw D(Wu)}),P.add(zo)}function b1(P,R){if(!fr.test(R=i()))throw D(R,"reference");var M=R;Q(null,function(V){switch(V){case"required":case"repeated":Qe(P,V,M);break;case"optional":d?Qe(P,"proto3_optional",M):Qe(P,"optional",M);break;default:if(!d||!fr.test(V))throw D(V);o(V),Qe(P,"optional",M);break}})}for(var ft;(ft=i())!==null;)switch(ft){case"package":if(!u)throw D(ft);I();break;case"import":if(!u)throw D(ft);O();break;case"syntax":if(!u)throw D(ft);X();break;case"option":ct(y,ft),c(";");break;default:if(fe(y,ft)){u=!1;continue}throw D(ft)}return kr.filename=null,{package:h,imports:l,weakImports:g,syntax:p,root:e}}});var lg=k((wT,hg)=>{"use strict";hg.exports=Wt;var Xw=/\/|\./;function Wt(t,e){Xw.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Wt[t]=e}Wt("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var fg;Wt("duration",{Duration:fg={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Wt("timestamp",{Timestamp:fg});Wt("empty",{Empty:{fields:{}}});Wt("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Wt("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Wt("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Wt.get=function(e){return Wt[e]||null}});var dg=k((xT,pg)=>{"use strict";var an=pg.exports=eg();an.build="full";an.tokenize=cf();an.parse=cg();an.common=lg();an.Root._configure(an.Type,an.parse,an.common)});var lf=k((ET,gg)=>{"use strict";gg.exports=dg()});var he=k((FT,bg)=>{bg.exports={options:{usePureJavaScript:!1}}});var wg=k((LT,vg)=>{var mf={};vg.exports=mf;var Dg={};mf.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=ex(t,e);else{var s=0,i=e.length,o=e.charAt(0),a=[0];for(s=0;s<t.length;++s){for(var c=0,f=t[s];c<a.length;++c)f+=a[c]<<8,a[c]=f%i,f=f/i|0;for(;f>0;)a.push(f%i),f=f/i|0}for(s=0;t[s]===0&&s<t.length-1;++s)n+=o;for(s=a.length-1;s>=0;--s)n+=e[a[s]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};mf.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Dg[e];if(!r){r=Dg[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var s=e.length,i=e.charAt(0),o=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var c=0,f=a;c<o.length;++c)f+=o[c]*s,o[c]=f&255,f>>=8;for(;f>0;)o.push(f&255),f>>=8}for(var u=0;t[u]===i&&u<t.length-1;++u)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function ex(t,e){var r=0,n=e.length,s=e.charAt(0),i=[0];for(r=0;r<t.length();++r){for(var o=0,a=t.at(r);o<i.length;++o)a+=i[o]<<8,i[o]=a%n,a=a/n|0;for(;a>0;)i.push(a%n),a=a/n|0}var c="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)c+=s;for(r=i.length-1;r>=0;--r)c+=e[i[r]];return c}});var Ne=k((UT,Cg)=>{var xg=he(),Eg=wg(),v=Cg.exports=xg.util=xg.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){v.nextTick=process.nextTick,typeof setImmediate=="function"?v.setImmediate=setImmediate:v.setImmediate=v.nextTick;return}if(typeof setImmediate=="function"){v.setImmediate=function(){return setImmediate.apply(void 0,arguments)},v.nextTick=function(a){return setImmediate(a)};return}if(v.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(c){if(c.source===window&&c.data===t){c.stopPropagation();var f=e.slice();e.length=0,f.forEach(function(u){u()})}};var o=a,t="forge.setImmediate",e=[];v.setImmediate=function(c){e.push(c),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,s=document.createElement("div"),e=[];new MutationObserver(function(){var c=e.slice();e.length=0,c.forEach(function(f){f()})}).observe(s,{attributes:!0});var i=v.setImmediate;v.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),i(c)):(e.push(c),e.length===1&&s.setAttribute("a",n=!n))}}v.nextTick=v.setImmediate})();v.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;v.globalScope=function(){return v.isNodejs?globalThis:typeof self>"u"?window:self}();v.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};v.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};v.isArrayBufferView=function(t){return t&&v.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function zi(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}v.ByteBuffer=bf;function bf(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(v.isArrayBuffer(t)||v.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof bf||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}v.ByteStringBuffer=bf;var tx=4096;v.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>tx&&(this.data.substr(0,1),this._constructedStringLength=0)};v.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};v.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};v.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};v.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};v.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};v.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(v.encodeUtf8(t))};v.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};v.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};v.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};v.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};v.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};v.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};v.ByteStringBuffer.prototype.putInt=function(t,e){zi(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};v.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};v.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};v.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};v.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};v.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};v.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};v.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};v.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};v.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};v.ByteStringBuffer.prototype.getInt=function(t){zi(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};v.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};v.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};v.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};v.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};v.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};v.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};v.ByteStringBuffer.prototype.copy=function(){var t=v.createBuffer(this.data);return t.read=this.read,t};v.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};v.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};v.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};v.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};v.ByteStringBuffer.prototype.toString=function(){return v.decodeUtf8(this.bytes())};function rx(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=v.isArrayBuffer(t),n=v.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}v.DataBuffer=rx;v.DataBuffer.prototype.length=function(){return this.write-this.read};v.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};v.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};v.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};v.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};v.DataBuffer.prototype.putBytes=function(t,e){if(v.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var s=new Uint8Array(this.data.buffer,this.write);return s.set(r),this.write+=n,this}if(v.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var s=new Uint8Array(this.data.buffer);return s.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof v.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&v.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var s=new Uint8Array(t.data.byteLength,this.write);return s.set(r),this.write+=r.byteLength,this}if(t instanceof v.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var i;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=v.binary.hex.decode(t,i,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),i=new Uint8Array(this.data.buffer,this.write),this.write+=v.binary.base64.decode(t,i,this.write),this;if(e==="utf8"&&(t=v.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=v.binary.raw.decode(i),this;if(e==="utf16")return this.accommodate(t.length*2),i=new Uint16Array(this.data.buffer,this.write),this.write+=v.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};v.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};v.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};v.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};v.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};v.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};v.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};v.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};v.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};v.DataBuffer.prototype.putInt=function(t,e){zi(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};v.DataBuffer.prototype.putSignedInt=function(t,e){return zi(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};v.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};v.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};v.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};v.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};v.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};v.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};v.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};v.DataBuffer.prototype.getInt=function(t){zi(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};v.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};v.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};v.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};v.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};v.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};v.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};v.DataBuffer.prototype.copy=function(){return new v.DataBuffer(this)};v.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};v.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};v.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};v.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};v.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return v.binary.raw.encode(e);if(t==="hex")return v.binary.hex.encode(e);if(t==="base64")return v.binary.base64.encode(e);if(t==="utf8")return v.text.utf8.decode(e);if(t==="utf16")return v.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};v.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=v.encodeUtf8(t)),new v.ByteBuffer(t)};v.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};v.xorBytes=function(t,e,r){for(var n="",s="",i="",o=0,a=0;r>0;--r,++o)s=t.charCodeAt(o)^e.charCodeAt(o),a>=10&&(n+=i,i="",a=0),i+=String.fromCharCode(s),++a;return n+=i,n};v.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};v.bytesToHex=function(t){return v.createBuffer(t).toHex()};v.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var un="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",cn=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Sg="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";v.encode64=function(t,e){for(var r="",n="",s,i,o,a=0;a<t.length;)s=t.charCodeAt(a++),i=t.charCodeAt(a++),o=t.charCodeAt(a++),r+=un.charAt(s>>2),r+=un.charAt((s&3)<<4|i>>4),isNaN(i)?r+="==":(r+=un.charAt((i&15)<<2|o>>6),r+=isNaN(o)?"=":un.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};v.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,s,i,o=0;o<t.length;)r=cn[t.charCodeAt(o++)-43],n=cn[t.charCodeAt(o++)-43],s=cn[t.charCodeAt(o++)-43],i=cn[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),s!==64&&(e+=String.fromCharCode((n&15)<<4|s>>2),i!==64&&(e+=String.fromCharCode((s&3)<<6|i)));return e};v.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};v.decodeUtf8=function(t){return decodeURIComponent(escape(t))};v.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Eg.encode,decode:Eg.decode}};v.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};v.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var s=r,i=0;i<t.length;++i)n[s++]=t.charCodeAt(i);return e?s-r:n};v.binary.hex.encode=v.bytesToHex;v.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var s=0,i=r;for(t.length&1&&(s=1,n[i++]=parseInt(t[0],16));s<t.length;s+=2)n[i++]=parseInt(t.substr(s,2),16);return e?i-r:n};v.binary.base64.encode=function(t,e){for(var r="",n="",s,i,o,a=0;a<t.byteLength;)s=t[a++],i=t[a++],o=t[a++],r+=un.charAt(s>>2),r+=un.charAt((s&3)<<4|i>>4),isNaN(i)?r+="==":(r+=un.charAt((i&15)<<2|o>>6),r+=isNaN(o)?"=":un.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};v.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var s,i,o,a,c=0,f=r;c<t.length;)s=cn[t.charCodeAt(c++)-43],i=cn[t.charCodeAt(c++)-43],o=cn[t.charCodeAt(c++)-43],a=cn[t.charCodeAt(c++)-43],n[f++]=s<<2|i>>4,o!==64&&(n[f++]=(i&15)<<4|o>>2,a!==64&&(n[f++]=(o&3)<<6|a));return e?f-r:n.subarray(0,f)};v.binary.base58.encode=function(t,e){return v.binary.baseN.encode(t,Sg,e)};v.binary.base58.decode=function(t,e){return v.binary.baseN.decode(t,Sg,e)};v.text={utf8:{},utf16:{}};v.text.utf8.encode=function(t,e,r){t=v.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var s=r,i=0;i<t.length;++i)n[s++]=t.charCodeAt(i);return e?s-r:n};v.text.utf8.decode=function(t){return v.decodeUtf8(String.fromCharCode.apply(null,t))};v.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var s=new Uint16Array(n.buffer);r=r||0;for(var i=r,o=r,a=0;a<t.length;++a)s[o++]=t.charCodeAt(a),i+=2;return e?i-r:n};v.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};v.deflate=function(t,e,r){if(e=v.decode64(t.deflate(v.encode64(e)).rval),r){var n=2,s=e.charCodeAt(1);s&32&&(n=6),e=e.substring(n,e.length-4)}return e};v.inflate=function(t,e,r){var n=t.inflate(v.encode64(e)).rval;return n===null?null:v.decode64(n)};var Df=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=v.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var s=new Error(n.error.message);throw s.id=n.error.id,s.name=n.error.name,s}},vf=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(v.decode64(r))),r},nx=function(t,e,r,n){var s=vf(t,e);s===null&&(s={}),s[r]=n,Df(t,e,s)},sx=function(t,e,r){var n=vf(t,e);return n!==null&&(n=r in n?n[r]:null),n},ix=function(t,e,r){var n=vf(t,e);if(n!==null&&r in n){delete n[r];var s=!0;for(var i in n){s=!1;break}s&&(n=null),Df(t,e,n)}},ox=function(t,e){Df(t,e,null)},wa=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var s,i=!1,o=null;for(var a in r){s=r[a];try{if(s==="flash"||s==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),i=s==="flash"}(s==="web"||s==="both")&&(e[0]=localStorage,n=t.apply(this,e),i=!0)}catch(c){o=c}if(i)break}if(!i)throw o;return n};v.setItem=function(t,e,r,n,s){wa(nx,arguments,s)};v.getItem=function(t,e,r,n){return wa(sx,arguments,n)};v.removeItem=function(t,e,r,n){wa(ix,arguments,n)};v.clearItems=function(t,e,r){wa(ox,arguments,r)};v.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};v.format=function(t){for(var e=/%./g,r,n,s=0,i=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&i.push(n),o=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":s<arguments.length?i.push(arguments[s+++1]):i.push("<?>");break;case"%":i.push("%");break;default:i.push("<%"+a+"?>")}}return i.push(t.substring(o)),i.join("")};v.formatNumber=function(t,e,r,n){var s=t,i=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,a=n===void 0?".":n,c=s<0?"-":"",f=parseInt(s=Math.abs(+s||0).toFixed(i),10)+"",u=f.length>3?f.length%3:0;return c+(u?f.substr(0,u)+a:"")+f.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+a)+(i?o+Math.abs(s-f).toFixed(i).slice(2):"")};v.formatSize=function(t){return t>=1073741824?t=v.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=v.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=v.formatNumber(t/1024,0)+" KiB":t=v.formatNumber(t,0)+" bytes",t};v.bytesFromIP=function(t){return t.indexOf(".")!==-1?v.bytesFromIPv4(t):t.indexOf(":")!==-1?v.bytesFromIPv6(t):null};v.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=v.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};v.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=v.createBuffer(),s=0;s<8;++s){if(!t[s]||t[s].length===0){n.fillWithByte(0,r),r=0;continue}var i=v.hexToBytes(t[s]);i.length<2&&n.putByte(0),n.putBytes(i)}return n.getBytes()};v.bytesToIP=function(t){return t.length===4?v.bytesToIPv4(t):t.length===16?v.bytesToIPv6(t):null};v.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};v.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,s=0;s<t.length;s+=2){for(var i=v.bytesToHex(t[s]+t[s+1]);i[0]==="0"&&i!=="0";)i=i.substr(1);if(i==="0"){var o=r[r.length-1],a=e.length;!o||a!==o.end+1?r.push({start:a,end:a}):(o.end=a,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(i)}if(r.length>0){var c=r[n];c.end-c.start>0&&(e.splice(c.start,c.end-c.start+1,""),c.start===0&&e.unshift(""),c.end===7&&e.push(""))}return e.join(":")};v.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in v&&!t.update)return e(null,v.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return v.cores=navigator.hardwareConcurrency,e(null,v.cores);if(typeof Worker>"u")return v.cores=1,e(null,v.cores);if(typeof Blob>"u")return v.cores=2,e(null,v.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var a=Date.now(),c=a+4;Date.now()<c;);self.postMessage({st:a,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,a,c){if(a===0){var f=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return v.cores=Math.max(1,f),URL.revokeObjectURL(r),e(null,v.cores)}s(c,function(u,h){o.push(i(c,h)),n(o,a-1,c)})}function s(o,a){for(var c=[],f=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(f.push(l.data),f.length===o){for(var g=0;g<o;++g)c[g].terminate();a(null,f)}}),c.push(h)}for(var u=0;u<o;++u)c[u].postMessage(u)}function i(o,a){for(var c=[],f=0;f<o;++f)for(var u=a[f],h=c[f]=[],l=0;l<o;++l)if(f!==l){var g=a[l];(u.st>g.st&&u.st<g.et||g.st>u.st&&g.st<u.et)&&h.push(l)}return c.reduce(function(p,d){return Math.max(p,d.length)},0)}}});var xa=k((qT,Ag)=>{var Vi=he();Vi.pki=Vi.pki||{};var wf=Ag.exports=Vi.pki.oids=Vi.oids=Vi.oids||{};function _(t,e){wf[t]=e,wf[e]=t}function ce(t,e){wf[t]=e}_("1.2.840.113549.1.1.1","rsaEncryption");_("1.2.840.113549.1.1.4","md5WithRSAEncryption");_("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_("1.2.840.113549.1.1.7","RSAES-OAEP");_("1.2.840.113549.1.1.8","mgf1");_("1.2.840.113549.1.1.9","pSpecified");_("1.2.840.113549.1.1.10","RSASSA-PSS");_("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_("1.3.101.112","EdDSA25519");_("1.2.840.10040.4.3","dsa-with-sha1");_("1.3.14.3.2.7","desCBC");_("1.3.14.3.2.26","sha1");_("1.3.14.3.2.29","sha1WithRSASignature");_("2.16.840.1.101.3.4.2.1","sha256");_("2.16.840.1.101.3.4.2.2","sha384");_("2.16.840.1.101.3.4.2.3","sha512");_("2.16.840.1.101.3.4.2.4","sha224");_("2.16.840.1.101.3.4.2.5","sha512-224");_("2.16.840.1.101.3.4.2.6","sha512-256");_("1.2.840.113549.2.2","md2");_("1.2.840.113549.2.5","md5");_("1.2.840.113549.1.7.1","data");_("1.2.840.113549.1.7.2","signedData");_("1.2.840.113549.1.7.3","envelopedData");_("1.2.840.113549.1.7.4","signedAndEnvelopedData");_("1.2.840.113549.1.7.5","digestedData");_("1.2.840.113549.1.7.6","encryptedData");_("1.2.840.113549.1.9.1","emailAddress");_("1.2.840.113549.1.9.2","unstructuredName");_("1.2.840.113549.1.9.3","contentType");_("1.2.840.113549.1.9.4","messageDigest");_("1.2.840.113549.1.9.5","signingTime");_("1.2.840.113549.1.9.6","counterSignature");_("1.2.840.113549.1.9.7","challengePassword");_("1.2.840.113549.1.9.8","unstructuredAddress");_("1.2.840.113549.1.9.14","extensionRequest");_("1.2.840.113549.1.9.20","friendlyName");_("1.2.840.113549.1.9.21","localKeyId");_("1.2.840.113549.1.9.22.1","x509Certificate");_("1.2.840.113549.1.12.10.1.1","keyBag");_("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_("1.2.840.113549.1.12.10.1.3","certBag");_("1.2.840.113549.1.12.10.1.4","crlBag");_("1.2.840.113549.1.12.10.1.5","secretBag");_("1.2.840.113549.1.12.10.1.6","safeContentsBag");_("1.2.840.113549.1.5.13","pkcs5PBES2");_("1.2.840.113549.1.5.12","pkcs5PBKDF2");_("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_("1.2.840.113549.2.7","hmacWithSHA1");_("1.2.840.113549.2.8","hmacWithSHA224");_("1.2.840.113549.2.9","hmacWithSHA256");_("1.2.840.113549.2.10","hmacWithSHA384");_("1.2.840.113549.2.11","hmacWithSHA512");_("1.2.840.113549.3.7","des-EDE3-CBC");_("2.16.840.1.101.3.4.1.2","aes128-CBC");_("2.16.840.1.101.3.4.1.22","aes192-CBC");_("2.16.840.1.101.3.4.1.42","aes256-CBC");_("2.5.4.3","commonName");_("2.5.4.4","surname");_("2.5.4.5","serialNumber");_("2.5.4.6","countryName");_("2.5.4.7","localityName");_("2.5.4.8","stateOrProvinceName");_("2.5.4.9","streetAddress");_("2.5.4.10","organizationName");_("2.5.4.11","organizationalUnitName");_("2.5.4.12","title");_("2.5.4.13","description");_("2.5.4.15","businessCategory");_("2.5.4.17","postalCode");_("2.5.4.42","givenName");_("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_("2.16.840.1.113730.1.1","nsCertType");_("2.16.840.1.113730.1.13","nsComment");ce("2.5.29.1","authorityKeyIdentifier");ce("2.5.29.2","keyAttributes");ce("2.5.29.3","certificatePolicies");ce("2.5.29.4","keyUsageRestriction");ce("2.5.29.5","policyMapping");ce("2.5.29.6","subtreesConstraint");ce("2.5.29.7","subjectAltName");ce("2.5.29.8","issuerAltName");ce("2.5.29.9","subjectDirectoryAttributes");ce("2.5.29.10","basicConstraints");ce("2.5.29.11","nameConstraints");ce("2.5.29.12","policyConstraints");ce("2.5.29.13","basicConstraints");_("2.5.29.14","subjectKeyIdentifier");_("2.5.29.15","keyUsage");ce("2.5.29.16","privateKeyUsagePeriod");_("2.5.29.17","subjectAltName");_("2.5.29.18","issuerAltName");_("2.5.29.19","basicConstraints");ce("2.5.29.20","cRLNumber");ce("2.5.29.21","cRLReason");ce("2.5.29.22","expirationDate");ce("2.5.29.23","instructionCode");ce("2.5.29.24","invalidityDate");ce("2.5.29.25","cRLDistributionPoints");ce("2.5.29.26","issuingDistributionPoint");ce("2.5.29.27","deltaCRLIndicator");ce("2.5.29.28","issuingDistributionPoint");ce("2.5.29.29","certificateIssuer");ce("2.5.29.30","nameConstraints");_("2.5.29.31","cRLDistributionPoints");_("2.5.29.32","certificatePolicies");ce("2.5.29.33","policyMappings");ce("2.5.29.34","policyConstraints");_("2.5.29.35","authorityKeyIdentifier");ce("2.5.29.36","policyConstraints");_("2.5.29.37","extKeyUsage");ce("2.5.29.46","freshestCRL");ce("2.5.29.54","inhibitAnyPolicy");_("1.3.6.1.4.1.11129.2.4.2","timestampList");_("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_("1.3.6.1.5.5.7.3.1","serverAuth");_("1.3.6.1.5.5.7.3.2","clientAuth");_("1.3.6.1.5.5.7.3.3","codeSigning");_("1.3.6.1.5.5.7.3.4","emailProtection");_("1.3.6.1.5.5.7.3.8","timeStamping")});var Gi=k((zT,Bg)=>{var be=he();Ne();xa();var N=Bg.exports=be.asn1=be.asn1||{};N.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};N.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};N.create=function(t,e,r,n,s){if(be.util.isArray(n)){for(var i=[],o=0;o<n.length;++o)n[o]!==void 0&&i.push(n[o]);n=i}var a={tagClass:t,type:e,constructed:r,composed:r||be.util.isArray(n),value:n};return s&&"bitStringContents"in s&&(a.bitStringContents=s.bitStringContents,a.original=N.copy(a)),a};N.copy=function(t,e){var r;if(be.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(N.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:N.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};N.equals=function(t,e,r){if(be.util.isArray(t)){if(!be.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!N.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var s=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&N.equals(t.value,e.value);return r&&r.includeBitStringContents&&(s=s&&t.bitStringContents===e.bitStringContents),s};N.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Ki(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var ax=function(t,e){var r=t.getByte();if(e--,r!==128){var n,s=r&128;if(!s)n=r;else{var i=r&127;Ki(t,e,i),n=t.getInt(i<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};N.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=be.util.createBuffer(t));var r=t.length(),n=Ea(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var s=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw s.byteCount=r,s.remaining=t.length(),s}return n};function Ea(t,e,r,n){var s;Ki(t,e,2);var i=t.getByte();e--;var o=i&192,a=i&31;s=t.length();var c=ax(t,e);if(e-=s-t.length(),c!==void 0&&c>e){if(n.strict){var f=new Error("Too few bytes to read ASN.1 value.");throw f.available=t.length(),f.remaining=e,f.requested=c,f}c=e}var u,h,l=(i&32)===32;if(l)if(u=[],c===void 0)for(;;){if(Ki(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}s=t.length(),u.push(Ea(t,e,r+1,n)),e-=s-t.length()}else for(;c>0;)s=t.length(),u.push(Ea(t,c,r+1,n)),e-=s-t.length(),c-=s-t.length();if(u===void 0&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&(h=t.bytes(c)),u===void 0&&n.decodeBitStrings&&o===N.Class.UNIVERSAL&&a===N.Type.BITSTRING&&c>1){var g=t.read,p=e,d=0;if(a===N.Type.BITSTRING&&(Ki(t,e,1),d=t.getByte(),e--),d===0)try{s=t.length();var y={strict:!0,decodeBitStrings:!0},m=Ea(t,e,r+1,y),D=s-t.length();e-=D,a==N.Type.BITSTRING&&D++;var E=m.tagClass;D===c&&(E===N.Class.UNIVERSAL||E===N.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=g,e=p)}if(u===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=e}if(a===N.Type.BMPSTRING)for(u="";c>0;c-=2)Ki(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(c),e-=c}var w=h===void 0?null:{bitStringContents:h};return N.create(o,a,l,u,w)}N.toDer=function(t){var e=be.util.createBuffer(),r=t.tagClass|t.type,n=be.util.createBuffer(),s=!1;if("bitStringContents"in t&&(s=!0,t.original&&(s=N.equals(t,t.original))),s)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var i=0;i<t.value.length;++i)t.value[i]!==void 0&&n.putBuffer(N.toDer(t.value[i]))}else if(t.type===N.Type.BMPSTRING)for(var i=0;i<t.value.length;++i)n.putInt16(t.value.charCodeAt(i));else t.type===N.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)===0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),a="";do a+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(a.length|128);for(var i=a.length-1;i>=0;--i)e.putByte(a.charCodeAt(i))}return e.putBuffer(n),e};N.oidToDer=function(t){var e=t.split("."),r=be.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,s,i,o,a=2;a<e.length;++a){n=!0,s=[],i=parseInt(e[a],10);do o=i&127,i=i>>>7,n||(o|=128),s.push(o),n=!1;while(i>0);for(var c=s.length-1;c>=0;--c)r.putByte(s[c])}return r};N.derToOid=function(t){var e;typeof t=="string"&&(t=be.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};N.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,s=parseInt(t.substr(4,2),10),i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var c=t.charAt(10),f=10;c!=="+"&&c!=="-"&&(a=parseInt(t.substr(10,2),10),f+=2)}if(e.setUTCFullYear(r,n,s),e.setUTCHours(i,o,a,0),f&&(c=t.charAt(f),c==="+"||c==="-")){var u=parseInt(t.substr(f+1,2),10),h=parseInt(t.substr(f+4,2),10),l=u*60+h;l*=6e4,c==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};N.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,s=parseInt(t.substr(6,2),10),i=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),c=0,f=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var g=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);f=g*60+p,f*=6e4,l==="+"&&(f*=-1),u=!0}return t.charAt(14)==="."&&(c=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,s),e.setUTCHours(i,o,a,c),e.setTime(+e+f)):(e.setFullYear(r,n,s),e.setHours(i,o,a,c)),e};N.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};N.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};N.integerToDer=function(t){var e=be.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};N.derToInteger=function(t){typeof t=="string"&&(t=be.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};N.validate=function(t,e,r,n){var s=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(s=!0,e.value&&be.util.isArray(e.value))for(var i=0,o=0;s&&o<e.value.length;++o)s=e.value[o].optional||!1,t.value[i]&&(s=N.validate(t.value[i],e.value[o],r,n),s?++i:e.value[o].optional&&(s=!0)),!s&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(s&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var c=t.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return s};var Ig=/[^\\u0000-\\u00ff]/;N.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var s="",i=0;i<e*r;++i)s+=" ";switch(n+=s+"Tag: ",t.tagClass){case N.Class.UNIVERSAL:n+="Universal:";break;case N.Class.APPLICATION:n+="Application:";break;case N.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case N.Class.PRIVATE:n+="Private:";break}if(t.tagClass===N.Class.UNIVERSAL)switch(n+=t.type,t.type){case N.Type.NONE:n+=" (None)";break;case N.Type.BOOLEAN:n+=" (Boolean)";break;case N.Type.INTEGER:n+=" (Integer)";break;case N.Type.BITSTRING:n+=" (Bit string)";break;case N.Type.OCTETSTRING:n+=" (Octet string)";break;case N.Type.NULL:n+=" (Null)";break;case N.Type.OID:n+=" (Object Identifier)";break;case N.Type.ODESC:n+=" (Object Descriptor)";break;case N.Type.EXTERNAL:n+=" (External or Instance of)";break;case N.Type.REAL:n+=" (Real)";break;case N.Type.ENUMERATED:n+=" (Enumerated)";break;case N.Type.EMBEDDED:n+=" (Embedded PDV)";break;case N.Type.UTF8:n+=" (UTF8)";break;case N.Type.ROID:n+=" (Relative Object Identifier)";break;case N.Type.SEQUENCE:n+=" (Sequence)";break;case N.Type.SET:n+=" (Set)";break;case N.Type.PRINTABLESTRING:n+=" (Printable String)";break;case N.Type.IA5String:n+=" (IA5String (ASCII))";break;case N.Type.UTCTIME:n+=" (UTC time)";break;case N.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case N.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=s+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,a="",i=0;i<t.value.length;++i)t.value[i]!==void 0&&(o+=1,a+=N.prettyPrint(t.value[i],e+1,r),i+1<t.value.length&&(a+=","));n+=s+"Sub values: "+o+a}else{if(n+=s+"Value: ",t.type===N.Type.OID){var c=N.derToOid(t.value);n+=c,be.pki&&be.pki.oids&&c in be.pki.oids&&(n+=" ("+be.pki.oids[c]+") ")}if(t.type===N.Type.INTEGER)try{n+=N.derToInteger(t.value)}catch{n+="0x"+be.util.bytesToHex(t.value)}else if(t.type===N.Type.BITSTRING){if(t.value.length>1?n+="0x"+be.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var f=t.value.charCodeAt(0);f==1?n+=" (1 unused bit shown)":f>1&&(n+=" ("+f+" unused bits shown)")}}else if(t.type===N.Type.OCTETSTRING)Ig.test(t.value)||(n+="("+t.value+") "),n+="0x"+be.util.bytesToHex(t.value);else if(t.type===N.Type.UTF8)try{n+=be.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+be.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===N.Type.PRINTABLESTRING||t.type===N.Type.IA5String?n+=t.value:Ig.test(t.value)?n+="0x"+be.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Ef=k((VT,Tg)=>{var $e=he();Ne();Tg.exports=$e.cipher=$e.cipher||{};$e.cipher.algorithms=$e.cipher.algorithms||{};$e.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=$e.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new $e.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};$e.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=$e.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new $e.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};$e.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),$e.cipher.algorithms[t]=e};$e.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in $e.cipher.algorithms?$e.cipher.algorithms[t]:null};var xf=$e.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};xf.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=$e.util.createBuffer(),this.output=t.output||$e.util.createBuffer(),this.mode.start(e)};xf.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};xf.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Cf=k((KT,_g)=>{var je=he();Ne();je.cipher=je.cipher||{};var Z=_g.exports=je.cipher.modes=je.cipher.modes||{};Z.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Z.ecb.prototype.start=function(t){};Z.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Z.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Z.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Z.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Z.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Z.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Sa(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Z.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Z.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Z.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Z.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Z.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=je.util.createBuffer(),this._partialBytes=0};Z.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Sa(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Z.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)this._inBlock[s]=t.getInt32()^this._outBlock[s],e.putInt32(this._inBlock[s]);return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialBlock[s]=t.getInt32()^this._outBlock[s],this._partialOutput.putInt32(this._partialBlock[s]);if(i>0)t.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Z.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)this._inBlock[s]=t.getInt32(),e.putInt32(this._inBlock[s]^this._outBlock[s]);return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialBlock[s]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[s]^this._outBlock[s]);if(i>0)t.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._partialBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Z.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=je.util.createBuffer(),this._partialBytes=0};Z.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Sa(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Z.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)e.putInt32(t.getInt32()^this._outBlock[s]),this._inBlock[s]=this._outBlock[s];return}var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(t.getInt32()^this._outBlock[s]);if(i>0)t.read-=this.blockSize;else for(var s=0;s<this._ints;++s)this._inBlock[s]=this._outBlock[s];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Z.ofb.prototype.decrypt=Z.ofb.prototype.encrypt;Z.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=je.util.createBuffer(),this._partialBytes=0};Z.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Sa(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Z.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var s=0;s<this._ints;++s)e.putInt32(t.getInt32()^this._outBlock[s]);else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(t.getInt32()^this._outBlock[s]);if(i>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Ca(this._inBlock)};Z.ctr.prototype.decrypt=Z.ctr.prototype.encrypt;Z.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=je.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Z.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=je.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=je.util.createBuffer(t.additionalData):r=je.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=je.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Sf(n*8)))}this._inBlock=this._j0.slice(0),Ca(this._inBlock),this._partialBytes=0,r=je.util.createBuffer(r),this._aDataLength=Sf(r.length()*8);var s=r.length()%this.blockSize;for(s&&r.fillWithByte(0,this.blockSize-s),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Z.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var s=0;s<this._ints;++s)e.putInt32(this._outBlock[s]^=t.getInt32());this._cipherLength+=this.blockSize}else{var i=(this.blockSize-n)%this.blockSize;i>0&&(i=this.blockSize-i),this._partialOutput.clear();for(var s=0;s<this._ints;++s)this._partialOutput.putInt32(t.getInt32()^this._outBlock[s]);if(i<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var s=0;s<this._ints;++s)this._outBlock[s]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),i>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(i-this._partialBytes)),this._partialBytes=i,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Ca(this._inBlock)};Z.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Ca(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var s=0;s<this._ints;++s)e.putInt32(this._outBlock[s]^this._hashBlock[s]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Z.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=je.util.createBuffer();var n=this._aDataLength.concat(Sf(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var s=[];this.cipher.encrypt(this._j0,s);for(var i=0;i<this._ints;++i)this.tag.putInt32(this._s[i]^s[i]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Z.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),s=0;s<128;++s){var i=t[s/32|0]&1<<31-s%32;i&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Z.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Z.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,s=t[n]>>>(7-r%8)*4&15,i=this._m[r][s];e[0]^=i[0],e[1]^=i[1],e[2]^=i[2],e[3]^=i[3]}return e};Z.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Z.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,s=16*r,i=new Array(s),o=0;o<s;++o){var a=[0,0,0,0],c=o/n|0,f=(n-1-o%n)*e;a[c]=1<<e-1<<f,i[o]=this.generateSubHashTable(this.multiply(a,t),e)}return i};Z.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,s=new Array(r);s[n]=t.slice(0);for(var i=n>>>1;i>0;)this.pow(s[2*i],s[i]=[]),i>>=1;for(i=2;i<n;){for(var o=1;o<i;++o){var a=s[i],c=s[o];s[i+o]=[a[0]^c[0],a[1]^c[1],a[2]^c[2],a[3]^c[3]]}i*=2}for(s[0]=[0,0,0,0],i=n+1;i<r;++i){var f=s[i^n];s[i]=[t[0]^f[0],t[1]^f[1],t[2]^f[2],t[3]^f[3]]}return s};function Sa(t,e){if(typeof t=="string"&&(t=je.util.createBuffer(t)),je.util.isArray(t)&&t.length>4){var r=t;t=je.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!je.util.isArray(t)){for(var s=[],i=e/4,n=0;n<i;++n)s.push(t.getInt32());t=s}return t}function Ca(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Sf(t){return[t/4294967296|0,t&4294967295]}});var Ia=k((GT,Og)=>{var me=he();Ef();Cf();Ne();Og.exports=me.aes=me.aes||{};me.aes.startEncrypting=function(t,e,r,n){var s=Aa({key:t,output:r,decrypt:!1,mode:n});return s.start(e),s};me.aes.createEncryptionCipher=function(t,e){return Aa({key:t,output:null,decrypt:!1,mode:e})};me.aes.startDecrypting=function(t,e,r,n){var s=Aa({key:t,output:r,decrypt:!0,mode:n});return s.start(e),s};me.aes.createDecryptionCipher=function(t,e){return Aa({key:t,output:null,decrypt:!0,mode:e})};me.aes.Algorithm=function(t,e){Bf||Rg();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,s){return If(r._w,n,s,!1)},decrypt:function(n,s){return If(r._w,n,s,!0)}}}),r._init=!1};me.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=me.util.createBuffer(e);else if(me.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=me.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!me.util.isArray(e)){r=e,e=[];var s=r.length();if(s===16||s===24||s===32){s=s>>>2;for(var n=0;n<s;++n)e.push(r.getInt32())}}if(!me.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var i=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(i)!==-1;this._w=kg(e,t.decrypt&&!o),this._init=!0}};me.aes._expandKey=function(t,e){return Bf||Rg(),kg(t,e)};me.aes._updateBlock=If;Es("AES-ECB",me.cipher.modes.ecb);Es("AES-CBC",me.cipher.modes.cbc);Es("AES-CFB",me.cipher.modes.cfb);Es("AES-OFB",me.cipher.modes.ofb);Es("AES-CTR",me.cipher.modes.ctr);Es("AES-GCM",me.cipher.modes.gcm);function Es(t,e){var r=function(){return new me.aes.Algorithm(t,e)};me.cipher.registerAlgorithm(t,r)}var Bf=!1,xs=4,nt,Af,Pg,Nn,$t;function Rg(){Bf=!0,Pg=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;nt=new Array(256),Af=new Array(256),Nn=new Array(4),$t=new Array(4);for(var e=0;e<4;++e)Nn[e]=new Array(256),$t[e]=new Array(256);for(var r=0,n=0,s,i,o,a,c,f,u,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,nt[r]=a,Af[a]=r,c=t[a],s=t[r],i=t[s],o=t[i],f=c<<24^a<<16^a<<8^(a^c),u=(s^i^o)<<24^(r^o)<<16^(r^i^o)<<8^(r^s^o);for(var h=0;h<4;++h)Nn[h][r]=f,$t[h][a]=u,f=f<<24|f>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=s^t[t[t[s^o]]],n^=t[t[n]])}}function kg(t,e){for(var r=t.slice(0),n,s=1,i=r.length,o=i+6+1,a=xs*o,c=i;c<a;++c)n=r[c-1],c%i===0?(n=nt[n>>>16&255]<<24^nt[n>>>8&255]<<16^nt[n&255]<<8^nt[n>>>24]^Pg[s]<<24,s++):i>6&&c%i===4&&(n=nt[n>>>24]<<24^nt[n>>>16&255]<<16^nt[n>>>8&255]<<8^nt[n&255]),r[c]=r[c-i]^n;if(e){var f,u=$t[0],h=$t[1],l=$t[2],g=$t[3],p=r.slice(0);a=r.length;for(var c=0,d=a-xs;c<a;c+=xs,d-=xs)if(c===0||c===a-xs)p[c]=r[d],p[c+1]=r[d+3],p[c+2]=r[d+2],p[c+3]=r[d+1];else for(var y=0;y<xs;++y)f=r[d+y],p[c+(3&-y)]=u[nt[f>>>24]]^h[nt[f>>>16&255]]^l[nt[f>>>8&255]]^g[nt[f&255]];r=p}return r}function If(t,e,r,n){var s=t.length/4-1,i,o,a,c,f;n?(i=$t[0],o=$t[1],a=$t[2],c=$t[3],f=Af):(i=Nn[0],o=Nn[1],a=Nn[2],c=Nn[3],f=nt);var u,h,l,g,p,d,y;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],g=e[n?1:3]^t[3];for(var m=3,D=1;D<s;++D)p=i[u>>>24]^o[h>>>16&255]^a[l>>>8&255]^c[g&255]^t[++m],d=i[h>>>24]^o[l>>>16&255]^a[g>>>8&255]^c[u&255]^t[++m],y=i[l>>>24]^o[g>>>16&255]^a[u>>>8&255]^c[h&255]^t[++m],g=i[g>>>24]^o[u>>>16&255]^a[h>>>8&255]^c[l&255]^t[++m],u=p,h=d,l=y;r[0]=f[u>>>24]<<24^f[h>>>16&255]<<16^f[l>>>8&255]<<8^f[g&255]^t[++m],r[n?3:1]=f[h>>>24]<<24^f[l>>>16&255]<<16^f[g>>>8&255]<<8^f[u&255]^t[++m],r[2]=f[l>>>24]<<24^f[g>>>16&255]<<16^f[u>>>8&255]<<8^f[h&255]^t[++m],r[n?1:3]=f[g>>>24]<<24^f[u>>>16&255]<<16^f[h>>>8&255]<<8^f[l&255]^t[++m]}function Aa(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=me.cipher.createDecipher(r,t.key):n=me.cipher.createCipher(r,t.key);var s=n.start;return n.start=function(i,o){var a=null;o instanceof me.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=i,s.call(n,o)},n}});var Fg=k((HT,Ng)=>{var we=he();Ef();Cf();Ne();Ng.exports=we.des=we.des||{};we.des.startEncrypting=function(t,e,r,n){var s=Ba({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return s.start(e),s};we.des.createEncryptionCipher=function(t,e){return Ba({key:t,output:null,decrypt:!1,mode:e})};we.des.startDecrypting=function(t,e,r,n){var s=Ba({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return s.start(e),s};we.des.createDecryptionCipher=function(t,e){return Ba({key:t,output:null,decrypt:!0,mode:e})};we.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,s){return Mg(r._keys,n,s,!1)},decrypt:function(n,s){return Mg(r._keys,n,s,!0)}}}),r._init=!1};we.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=we.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=yx(e),this._init=!0}};pr("DES-ECB",we.cipher.modes.ecb);pr("DES-CBC",we.cipher.modes.cbc);pr("DES-CFB",we.cipher.modes.cfb);pr("DES-OFB",we.cipher.modes.ofb);pr("DES-CTR",we.cipher.modes.ctr);pr("3DES-ECB",we.cipher.modes.ecb);pr("3DES-CBC",we.cipher.modes.cbc);pr("3DES-CFB",we.cipher.modes.cfb);pr("3DES-OFB",we.cipher.modes.ofb);pr("3DES-CTR",we.cipher.modes.ctr);function pr(t,e){var r=function(){return new we.des.Algorithm(t,e)};we.cipher.registerAlgorithm(t,r)}var ux=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],cx=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],fx=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],hx=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],lx=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],px=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],dx=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],gx=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function yx(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],s=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],i=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],f=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],g=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],d=t.length()>8?3:1,y=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],D=0,E,w=0;w<d;w++){var b=t.getInt32(),x=t.getInt32();E=(b>>>4^x)&252645135,x^=E,b^=E<<4,E=(x>>>-16^b)&65535,b^=E,x^=E<<-16,E=(b>>>2^x)&858993459,x^=E,b^=E<<2,E=(x>>>-16^b)&65535,b^=E,x^=E<<-16,E=(b>>>1^x)&1431655765,x^=E,b^=E<<1,E=(x>>>8^b)&16711935,b^=E,x^=E<<8,E=(b>>>1^x)&1431655765,x^=E,b^=E<<1,E=b<<8|x>>>20&240,b=x<<24|x<<8&16711680|x>>>8&65280|x>>>24&240,x=E;for(var C=0;C<m.length;++C){m[C]?(b=b<<2|b>>>26,x=x<<2|x>>>26):(b=b<<1|b>>>27,x=x<<1|x>>>27),b&=-15,x&=-15;var I=e[b>>>28]|r[b>>>24&15]|n[b>>>20&15]|s[b>>>16&15]|i[b>>>12&15]|o[b>>>8&15]|a[b>>>4&15],O=c[x>>>28]|f[x>>>24&15]|u[x>>>20&15]|h[x>>>16&15]|l[x>>>12&15]|g[x>>>8&15]|p[x>>>4&15];E=(O>>>16^I)&65535,y[D++]=I^E,y[D++]=O^E<<16}}return y}function Mg(t,e,r,n){var s=t.length===32?3:9,i;s===3?i=n?[30,-2,-2]:[0,32,2]:i=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,a=e[0],c=e[1];o=(a>>>4^c)&252645135,c^=o,a^=o<<4,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,a=a<<1|a>>>31,c=c<<1|c>>>31;for(var f=0;f<s;f+=3){for(var u=i[f+1],h=i[f+2],l=i[f];l!=u;l+=h){var g=c^t[l],p=(c>>>4|c<<28)^t[l+1];o=a,a=c,c=o^(cx[g>>>24&63]|hx[g>>>16&63]|px[g>>>8&63]|gx[g&63]|ux[p>>>24&63]|fx[p>>>16&63]|lx[p>>>8&63]|dx[p&63])}o=a,a=c,c=o}a=a>>>1|a<<31,c=c>>>1|c<<31,o=(a>>>1^c)&1431655765,c^=o,a^=o<<1,o=(c>>>8^a)&16711935,a^=o,c^=o<<8,o=(c>>>2^a)&858993459,a^=o,c^=o<<2,o=(a>>>16^c)&65535,c^=o,a^=o<<16,o=(a>>>4^c)&252645135,c^=o,a^=o<<4,r[0]=a,r[1]=c}function Ba(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=we.cipher.createDecipher(r,t.key):n=we.cipher.createCipher(r,t.key);var s=n.start;return n.start=function(i,o){var a=null;o instanceof we.util.ByteBuffer&&(a=o,o={}),o=o||{},o.output=a,o.iv=i,s.call(n,o)},n}});var Fn=k((WT,Lg)=>{var Ta=he();Lg.exports=Ta.md=Ta.md||{};Ta.md.algorithms=Ta.md.algorithms||{}});var qg=k(($T,Ug)=>{var Fr=he();Fn();Ne();var mx=Ug.exports=Fr.hmac=Fr.hmac||{};mx.create=function(){var t=null,e=null,r=null,n=null,s={};return s.start=function(i,o){if(i!==null)if(typeof i=="string")if(i=i.toLowerCase(),i in Fr.md.algorithms)e=Fr.md.algorithms[i].create();else throw new Error('Unknown hash algorithm "'+i+'"');else e=i;if(o===null)o=t;else{if(typeof o=="string")o=Fr.util.createBuffer(o);else if(Fr.util.isArray(o)){var a=o;o=Fr.util.createBuffer();for(var c=0;c<a.length;++c)o.putByte(a[c])}var f=o.length();f>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=Fr.util.createBuffer(),n=Fr.util.createBuffer(),f=o.length();for(var c=0;c<f;++c){var a=o.at(c);r.putByte(54^a),n.putByte(92^a)}if(f<e.blockLength)for(var a=e.blockLength-f,c=0;c<a;++c)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},s.update=function(i){e.update(i)},s.getMac=function(){var i=e.digest().bytes();return e.start(),e.update(n),e.update(i),e.digest()},s.digest=s.getMac,s}});var Ss=k(()=>{});var Tf=k((ZT,zg)=>{var st=he();qg();Fn();Ne();var bx=st.pkcs5=st.pkcs5||{},Lr;st.util.isNodejs&&!st.options.usePureJavaScript&&(Lr=Ss());zg.exports=st.pbkdf2=bx.pbkdf2=function(t,e,r,n,s,i){if(typeof s=="function"&&(i=s,s=null),st.util.isNodejs&&!st.options.usePureJavaScript&&Lr.pbkdf2&&(s===null||typeof s!="object")&&(Lr.pbkdf2Sync.length>4||!s||s==="sha1"))return typeof s!="string"&&(s="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),i?Lr.pbkdf2Sync.length===4?Lr.pbkdf2(t,e,r,n,function(E,w){if(E)return i(E);i(null,w.toString("binary"))}):Lr.pbkdf2(t,e,r,n,s,function(E,w){if(E)return i(E);i(null,w.toString("binary"))}):Lr.pbkdf2Sync.length===4?Lr.pbkdf2Sync(t,e,r,n).toString("binary"):Lr.pbkdf2Sync(t,e,r,n,s).toString("binary");if((typeof s>"u"||s===null)&&(s="sha1"),typeof s=="string"){if(!(s in st.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=st.md[s].create()}var o=s.digestLength;if(n>4294967295*o){var a=new Error("Derived key is too long.");if(i)return i(a);throw a}var c=Math.ceil(n/o),f=n-(c-1)*o,u=st.hmac.create();u.start(s,t);var h="",l,g,p;if(!i){for(var d=1;d<=c;++d){u.start(null,null),u.update(e),u.update(st.util.int32ToBytes(d)),l=p=u.digest().getBytes();for(var y=2;y<=r;++y)u.start(null,null),u.update(p),g=u.digest().getBytes(),l=st.util.xorBytes(l,g,o),p=g;h+=d<c?l:l.substr(0,f)}return h}var d=1,y;function m(){if(d>c)return i(null,h);u.start(null,null),u.update(e),u.update(st.util.int32ToBytes(d)),l=p=u.digest().getBytes(),y=2,D()}function D(){if(y<=r)return u.start(null,null),u.update(p),g=u.digest().getBytes(),l=st.util.xorBytes(l,g,o),p=g,++y,st.util.setImmediate(D);h+=d<c?l:l.substr(0,f),++d,m()}m()}});var Gg=k((XT,Kg)=>{var Pa=he();Ne();var Vg=Kg.exports=Pa.pem=Pa.pem||{};Vg.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=_a(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=_a(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=_a(n)),t.headers)for(var s=0;s<t.headers.length;++s)r+=_a(t.headers[s]);return t.procType&&(r+=`\r
`),r+=Pa.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Vg.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,s=/\r?\n/,i;i=r.exec(t),!!i;){var o=i[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var a={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Pa.util.decode64(i[3])};if(e.push(a),!!i[2]){for(var c=i[2].split(s),f=0;i&&f<c.length;){for(var u=c[f].replace(/\s+$/,""),h=f+1;h<c.length;++h){var l=c[h];if(!/\s/.test(l[0]))break;u+=l,f=h}if(i=u.match(n),i){for(var g={name:i[1],values:[]},p=i[2].split(","),d=0;d<p.length;++d)g.values.push(Dx(p[d]));if(a.procType)if(!a.contentDomain&&g.name==="Content-Domain")a.contentDomain=p[0]||"";else if(!a.dekInfo&&g.name==="DEK-Info"){if(g.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:p[0],parameters:p[1]||null}}else a.headers.push(g);else{if(g.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(g.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:p[0],type:p[1]}}}++f}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function _a(t){for(var e=t.name+": ",r=[],n=function(c,f){return" "+f},s=0;s<t.values.length;++s)r.push(t.values[s].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var i=0,o=-1,s=0;s<e.length;++s,++i)if(i>65&&o!==-1){var a=e[o];a===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+a+e.substr(o+1),i=s-o-1,o=-1,++s}else(e[s]===" "||e[s]==="	"||e[s]===",")&&(o=s);return e}function Dx(t){return t.replace(/^\s+/,"")}});var Zg=k((QT,Jg)=>{var dr=he();Fn();Ne();var Wg=Jg.exports=dr.sha256=dr.sha256||{};dr.md.sha256=dr.md.algorithms.sha256=Wg;Wg.create=function(){$g||vx();var t=null,e=dr.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var s=n.messageLengthSize/4,i=0;i<s;++i)n.fullMessageLength.push(0);return e=dr.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(s,i){i==="utf8"&&(s=dr.util.encodeUtf8(s));var o=s.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(s),Hg(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var s=dr.util.createBuffer();s.putBytes(e.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=i&n.blockLength-1;s.putBytes(_f.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,s.putInt32(f>>>0),f=a>>>0;s.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Hg(h,r,s);var l=dr.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var _f=null,$g=!1,jg=null;function vx(){_f=String.fromCharCode(128),_f+=dr.util.fillString(String.fromCharCode(0),64),jg=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],$g=!0}function Hg(t,e,r){for(var n,s,i,o,a,c,f,u,h,l,g,p,d,y,m,D=r.length();D>=64;){for(f=0;f<16;++f)e[f]=r.getInt32();for(;f<64;++f)n=e[f-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,s=e[f-15],s=(s>>>7|s<<25)^(s>>>18|s<<14)^s>>>3,e[f]=n+e[f-7]+s+e[f-16]|0;for(u=t.h0,h=t.h1,l=t.h2,g=t.h3,p=t.h4,d=t.h5,y=t.h6,m=t.h7,f=0;f<64;++f)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),a=y^p&(d^y),i=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),c=u&h|l&(u^h),n=m+o+a+jg[f]+e[f],s=i+c,m=y,y=d,d=p,p=g+n>>>0,g=l,l=h,h=u,u=n+s>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+g|0,t.h4=t.h4+p|0,t.h5=t.h5+d|0,t.h6=t.h6+y|0,t.h7=t.h7+m|0,D-=64}}});var Qg=k((YT,Xg)=>{var gr=he();Ne();var Ra=null;gr.util.isNodejs&&!gr.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Ra=Ss());var wx=Xg.exports=gr.prng=gr.prng||{};wx.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),s=0;s<32;++s)n[s]=r.create();e.pools=n,e.pool=0,e.generate=function(f,u){if(!u)return e.generateSync(f);var h=e.plugin.cipher,l=e.plugin.increment,g=e.plugin.formatKey,p=e.plugin.formatSeed,d=gr.util.createBuffer();e.key=null,y();function y(m){if(m)return u(m);if(d.length()>=f)return u(null,d.getBytes(f));if(e.generated>1048575&&(e.key=null),e.key===null)return gr.util.nextTick(function(){i(y)});var D=h(e.key,e.seed);e.generated+=D.length,d.putBytes(D),e.key=g(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),gr.util.setImmediate(y)}},e.generateSync=function(f){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,g=e.plugin.formatSeed;e.key=null;for(var p=gr.util.createBuffer();p.length()<f;){e.generated>1048575&&(e.key=null),e.key===null&&o();var d=u(e.key,e.seed);e.generated+=d.length,p.putBytes(d),e.key=l(u(e.key,h(e.seed))),e.seed=g(u(e.key,e.seed))}return p.getBytes(f)};function i(f){if(e.pools[0].messageLength>=32)return a(),f();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return f(h);e.collect(l),a(),f()})}function o(){if(e.pools[0].messageLength>=32)return a();var f=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(f)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var f=e.plugin.md.create();f.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(f.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=f.digest().getBytes(),f.start(),f.update(e.keyBytes);var l=f.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function c(f){var u=null,h=gr.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(b){return l.getRandomValues(b)});var g=gr.util.createBuffer();if(u)for(;g.length()<f;){var p=Math.max(1,Math.min(f-g.length(),65536)/4),d=new Uint32Array(Math.floor(p));try{u(d);for(var y=0;y<d.length;++y)g.putInt32(d[y])}catch(b){if(!(typeof QuotaExceededError<"u"&&b instanceof QuotaExceededError))throw b}}if(g.length()<f)for(var m,D,E,w=Math.floor(Math.random()*65536);g.length()<f;){D=16807*(w&65535),m=16807*(w>>16),D+=(m&32767)<<16,D+=m>>15,D=(D&2147483647)+(D>>31),w=D&4294967295;for(var y=0;y<3;++y)E=w>>>(y<<3),E^=Math.floor(Math.random()*256),g.putByte(E&255)}return g.getBytes(f)}return Ra?(e.seedFile=function(f,u){Ra.randomBytes(f,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(f){return Ra.randomBytes(f).toString()}):(e.seedFile=function(f,u){try{u(null,c(f))}catch(h){u(h)}},e.seedFileSync=c),e.collect=function(f){for(var u=f.length,h=0;h<u;++h)e.pools[e.pool].update(f.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(f,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(f>>l&255);e.collect(h)},e.registerWorker=function(f){if(f===self)e.seedFile=function(h,l){function g(p){var d=p.data;d.forge&&d.forge.prng&&(self.removeEventListener("message",g),l(d.forge.prng.err,d.forge.prng.bytes))}self.addEventListener("message",g),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(g,p){f.postMessage({forge:{prng:{err:g,bytes:p}}})})};f.addEventListener("message",u)}},e}});var Hi=k((e_,Pf)=>{var Je=he();Ia();Zg();Qg();Ne();(function(){if(Je.random&&Je.random.getBytes){Pf.exports=Je.random;return}(function(t){var e={},r=new Array(4),n=Je.util.createBuffer();e.formatKey=function(h){var l=Je.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Je.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=Je.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return Je.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=Je.md.sha256;function s(){var h=Je.prng.create(e);return h.getBytes=function(l,g){return h.generate(l,g)},h.getBytesSync=function(l){return h.generate(l)},h}var i=s(),o=null,a=Je.util.globalScope,c=a.crypto||a.msCrypto;if(c&&c.getRandomValues&&(o=function(h){return c.getRandomValues(h)}),Je.options.usePureJavaScript||!Je.util.isNodejs&&!o){if(typeof window>"u"||window.document,i.collectInt(+new Date,32),typeof navigator<"u"){var f="";for(var u in navigator)try{typeof navigator[u]=="string"&&(f+=navigator[u])}catch{}i.collect(f),f=null}t&&(t().mousemove(function(h){i.collectInt(h.clientX,16),i.collectInt(h.clientY,16)}),t().keypress(function(h){i.collectInt(h.charCode,8)}))}if(!Je.random)Je.random=i;else for(var u in i)Je.random[u]=i[u];Je.random.createInstance=s,Pf.exports=Je.random})(typeof jQuery<"u"?jQuery:null)})()});var ry=k((t_,ty)=>{var lt=he();Ne();var Rf=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Yg=[1,2,3,5],xx=function(t,e){return t<<e&65535|(t&65535)>>16-e},Ex=function(t,e){return(t&65535)>>e|t<<16-e&65535};ty.exports=lt.rc2=lt.rc2||{};lt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=lt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),s=e,i=Math.ceil(s/8),o=255>>(s&7),a;for(a=n;a<128;a++)r.putByte(Rf[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-i,Rf[r.at(128-i)&o]),a=127-i;a>=0;a--)r.setAt(a,Rf[r.at(a+1)^r.at(a+i)]);return r};var ey=function(t,e,r){var n=!1,s=null,i=null,o=null,a,c,f,u,h=[];for(t=lt.rc2.expandKey(t,e),f=0;f<64;f++)h.push(t.getInt16Le());r?(a=function(p){for(f=0;f<4;f++)p[f]+=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),p[f]=xx(p[f],Yg[f]),u++},c=function(p){for(f=0;f<4;f++)p[f]+=h[p[(f+3)%4]&63]}):(a=function(p){for(f=3;f>=0;f--)p[f]=Ex(p[f],Yg[f]),p[f]-=h[u]+(p[(f+3)%4]&p[(f+2)%4])+(~p[(f+3)%4]&p[(f+1)%4]),u--},c=function(p){for(f=3;f>=0;f--)p[f]-=h[p[(f+3)%4]&63]});var l=function(p){var d=[];for(f=0;f<4;f++){var y=s.getInt16Le();o!==null&&(r?y^=o.getInt16Le():o.putInt16Le(y)),d.push(y&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var D=0;D<p[m][0];D++)p[m][1](d);for(f=0;f<4;f++)o!==null&&(r?o.putInt16Le(d[f]):d[f]^=o.getInt16Le()),i.putInt16Le(d[f])},g=null;return g={start:function(p,d){p&&typeof p=="string"&&(p=lt.util.createBuffer(p)),n=!1,s=lt.util.createBuffer(),i=d||new lt.util.createBuffer,o=p,g.output=i},update:function(p){for(n||s.putBuffer(p);s.length()>=8;)l([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(p){var d=!0;if(r)if(p)d=p(8,s,!r);else{var y=s.length()===8?8:8-s.length();s.fillWithByte(y,y)}if(d&&(n=!0,g.update()),!r&&(d=s.length()===0,d))if(p)d=p(8,i,!r);else{var m=i.length(),D=i.at(m-1);D>m?d=!1:i.truncate(D)}return d}},g};lt.rc2.startEncrypting=function(t,e,r){var n=lt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};lt.rc2.createEncryptionCipher=function(t,e){return ey(t,e,!0)};lt.rc2.startDecrypting=function(t,e,r){var n=lt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};lt.rc2.createDecryptionCipher=function(t,e){return ey(t,e,!1)}});var Ma=k((r_,fy)=>{var kf=he();fy.exports=kf.jsbn=kf.jsbn||{};var Ur,Sx=0xdeadbeefcafe,ny=(Sx&16777215)==15715070;function B(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}kf.jsbn.BigInteger=B;function ie(){return new B(null)}function Cx(t,e,r,n,s,i){for(;--i>=0;){var o=e*this.data[t++]+r.data[n]+s;s=Math.floor(o/67108864),r.data[n++]=o&67108863}return s}function Ax(t,e,r,n,s,i){for(var o=e&32767,a=e>>15;--i>=0;){var c=this.data[t]&32767,f=this.data[t++]>>15,u=a*c+f*o;c=o*c+((u&32767)<<15)+r.data[n]+(s&1073741823),s=(c>>>30)+(u>>>15)+a*f+(s>>>30),r.data[n++]=c&1073741823}return s}function sy(t,e,r,n,s,i){for(var o=e&16383,a=e>>14;--i>=0;){var c=this.data[t]&16383,f=this.data[t++]>>14,u=a*c+f*o;c=o*c+((u&16383)<<14)+r.data[n]+s,s=(c>>28)+(u>>14)+a*f,r.data[n++]=c&268435455}return s}typeof navigator>"u"?(B.prototype.am=sy,Ur=28):ny&&navigator.appName=="Microsoft Internet Explorer"?(B.prototype.am=Ax,Ur=30):ny&&navigator.appName!="Netscape"?(B.prototype.am=Cx,Ur=26):(B.prototype.am=sy,Ur=28);B.prototype.DB=Ur;B.prototype.DM=(1<<Ur)-1;B.prototype.DV=1<<Ur;var Of=52;B.prototype.FV=Math.pow(2,Of);B.prototype.F1=Of-Ur;B.prototype.F2=2*Ur-Of;var Ix="0123456789abcdefghijklmnopqrstuvwxyz",ka=new Array,Cs,Ot;Cs="0".charCodeAt(0);for(Ot=0;Ot<=9;++Ot)ka[Cs++]=Ot;Cs="a".charCodeAt(0);for(Ot=10;Ot<36;++Ot)ka[Cs++]=Ot;Cs="A".charCodeAt(0);for(Ot=10;Ot<36;++Ot)ka[Cs++]=Ot;function iy(t){return Ix.charAt(t)}function oy(t,e){var r=ka[t.charCodeAt(e)];return r??-1}function Bx(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function Tx(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function fn(t){var e=ie();return e.fromInt(t),e}function _x(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,s=!1,i=0;--n>=0;){var o=r==8?t[n]&255:oy(t,n);if(o<0){t.charAt(n)=="-"&&(s=!0);continue}s=!1,i==0?this.data[this.t++]=o:i+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-i)-1)<<i,this.data[this.t++]=o>>this.DB-i):this.data[this.t-1]|=o<<i,i+=r,i>=this.DB&&(i-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,i>0&&(this.data[this.t-1]|=(1<<this.DB-i)-1<<i)),this.clamp(),s&&B.ZERO.subTo(this,this)}function Px(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Rx(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,s=!1,i="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this.data[o]>>a)>0&&(s=!0,i=iy(n));o>=0;)a<e?(n=(this.data[o]&(1<<a)-1)<<e-a,n|=this.data[--o]>>(a+=this.DB-e)):(n=this.data[o]>>(a-=e)&r,a<=0&&(a+=this.DB,--o)),n>0&&(s=!0),s&&(i+=iy(n));return s?i:"0"}function kx(){var t=ie();return B.ZERO.subTo(this,t),t}function Ox(){return this.s<0?this.negate():this}function Mx(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Oa(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Nx(){return this.t<=0?0:this.DB*(this.t-1)+Oa(this.data[this.t-1]^this.s&this.DM)}function Fx(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Lx(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Ux(t,e){var r=t%this.DB,n=this.DB-r,s=(1<<n)-1,i=Math.floor(t/this.DB),o=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+i+1]=this.data[a]>>n|o,o=(this.data[a]&s)<<r;for(a=i-1;a>=0;--a)e.data[a]=0;e.data[i]=o,e.t=this.t+i+1,e.s=this.s,e.clamp()}function qx(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,s=this.DB-n,i=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&i)<<s,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&i)<<s),e.t=this.t-r,e.clamp()}function zx(t,e){for(var r=0,n=0,s=Math.min(t.t,this.t);r<s;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Vx(t,e){var r=this.abs(),n=t.abs(),s=r.t;for(e.t=s+n.t;--s>=0;)e.data[s]=0;for(s=0;s<n.t;++s)e.data[s+r.t]=r.am(0,n.data[s],e,s,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&B.ZERO.subTo(e,e)}function Kx(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Gx(t,e,r){var n=t.abs();if(!(n.t<=0)){var s=this.abs();if(s.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=ie());var i=ie(),o=this.s,a=t.s,c=this.DB-Oa(n.data[n.t-1]);c>0?(n.lShiftTo(c,i),s.lShiftTo(c,r)):(n.copyTo(i),s.copyTo(r));var f=i.t,u=i.data[f-1];if(u!=0){var h=u*(1<<this.F1)+(f>1?i.data[f-2]>>this.F2:0),l=this.FV/h,g=(1<<this.F1)/h,p=1<<this.F2,d=r.t,y=d-f,m=e??ie();for(i.dlShiftTo(y,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),B.ONE.dlShiftTo(f,m),m.subTo(i,i);i.t<f;)i.data[i.t++]=0;for(;--y>=0;){var D=r.data[--d]==u?this.DM:Math.floor(r.data[d]*l+(r.data[d-1]+p)*g);if((r.data[d]+=i.am(0,D,r,y,0,f))<D)for(i.dlShiftTo(y,m),r.subTo(m,r);r.data[d]<--D;)r.subTo(m,r)}e!=null&&(r.drShiftTo(f,e),o!=a&&B.ZERO.subTo(e,e)),r.t=f,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&B.ZERO.subTo(r,r)}}}function Hx(t){var e=ie();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(B.ZERO)>0&&t.subTo(e,e),e}function Ln(t){this.m=t}function Wx(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function $x(t){return t}function jx(t){t.divRemTo(this.m,null,t)}function Jx(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Zx(t,e){t.squareTo(e),this.reduce(e)}Ln.prototype.convert=Wx;Ln.prototype.revert=$x;Ln.prototype.reduce=jx;Ln.prototype.mulTo=Jx;Ln.prototype.sqrTo=Zx;function Xx(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Un(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Qx(t){var e=ie();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(B.ZERO)>0&&this.m.subTo(e,e),e}function Yx(t){var e=ie();return t.copyTo(e),this.reduce(e),e}function e8(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function t8(t,e){t.squareTo(e),this.reduce(e)}function r8(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Un.prototype.convert=Qx;Un.prototype.revert=Yx;Un.prototype.reduce=e8;Un.prototype.mulTo=r8;Un.prototype.sqrTo=t8;function n8(){return(this.t>0?this.data[0]&1:this.s)==0}function s8(t,e){if(t>4294967295||t<1)return B.ONE;var r=ie(),n=ie(),s=e.convert(this),i=Oa(t)-1;for(s.copyTo(r);--i>=0;)if(e.sqrTo(r,n),(t&1<<i)>0)e.mulTo(n,s,r);else{var o=r;r=n,n=o}return e.revert(r)}function i8(t,e){var r;return t<256||e.isEven()?r=new Ln(e):r=new Un(e),this.exp(t,r)}B.prototype.copyTo=Bx;B.prototype.fromInt=Tx;B.prototype.fromString=_x;B.prototype.clamp=Px;B.prototype.dlShiftTo=Fx;B.prototype.drShiftTo=Lx;B.prototype.lShiftTo=Ux;B.prototype.rShiftTo=qx;B.prototype.subTo=zx;B.prototype.multiplyTo=Vx;B.prototype.squareTo=Kx;B.prototype.divRemTo=Gx;B.prototype.invDigit=Xx;B.prototype.isEven=n8;B.prototype.exp=s8;B.prototype.toString=Rx;B.prototype.negate=kx;B.prototype.abs=Ox;B.prototype.compareTo=Mx;B.prototype.bitLength=Nx;B.prototype.mod=Hx;B.prototype.modPowInt=i8;B.ZERO=fn(0);B.ONE=fn(1);function o8(){var t=ie();return this.copyTo(t),t}function a8(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function u8(){return this.t==0?this.s:this.data[0]<<24>>24}function c8(){return this.t==0?this.s:this.data[0]<<16>>16}function f8(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function h8(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function l8(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=fn(r),s=ie(),i=ie(),o="";for(this.divRemTo(n,s,i);s.signum()>0;)o=(r+i.intValue()).toString(t).substr(1)+o,s.divRemTo(n,s,i);return i.intValue().toString(t)+o}function p8(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),s=!1,i=0,o=0,a=0;a<t.length;++a){var c=oy(t,a);if(c<0){t.charAt(a)=="-"&&this.signum()==0&&(s=!0);continue}o=e*o+c,++i>=r&&(this.dMultiply(n),this.dAddOffset(o,0),i=0,o=0)}i>0&&(this.dMultiply(Math.pow(e,i)),this.dAddOffset(o,0)),s&&B.ZERO.subTo(this,this)}function d8(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(B.ONE.shiftLeft(t-1),Mf,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(B.ONE.shiftLeft(t-1),this);else{var n=new Array,s=t&7;n.length=(t>>3)+1,e.nextBytes(n),s>0?n[0]&=(1<<s)-1:n[0]=0,this.fromString(n,256)}}function g8(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,s=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[s++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),s==0&&(this.s&128)!=(n&128)&&++s,(s>0||n!=this.s)&&(e[s++]=n);return e}function y8(t){return this.compareTo(t)==0}function m8(t){return this.compareTo(t)<0?this:t}function b8(t){return this.compareTo(t)>0?this:t}function D8(t,e,r){var n,s,i=Math.min(t.t,this.t);for(n=0;n<i;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(s=t.s&this.DM,n=i;n<this.t;++n)r.data[n]=e(this.data[n],s);r.t=this.t}else{for(s=this.s&this.DM,n=i;n<t.t;++n)r.data[n]=e(s,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function v8(t,e){return t&e}function w8(t){var e=ie();return this.bitwiseTo(t,v8,e),e}function Mf(t,e){return t|e}function x8(t){var e=ie();return this.bitwiseTo(t,Mf,e),e}function ay(t,e){return t^e}function E8(t){var e=ie();return this.bitwiseTo(t,ay,e),e}function uy(t,e){return t&~e}function S8(t){var e=ie();return this.bitwiseTo(t,uy,e),e}function C8(){for(var t=ie(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function A8(t){var e=ie();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function I8(t){var e=ie();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function B8(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function T8(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+B8(this.data[t]);return this.s<0?this.t*this.DB:-1}function _8(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function P8(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=_8(this.data[r]^e);return t}function R8(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function k8(t,e){var r=B.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function O8(t){return this.changeBit(t,Mf)}function M8(t){return this.changeBit(t,uy)}function N8(t){return this.changeBit(t,ay)}function F8(t,e){for(var r=0,n=0,s=Math.min(t.t,this.t);r<s;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function L8(t){var e=ie();return this.addTo(t,e),e}function U8(t){var e=ie();return this.subTo(t,e),e}function q8(t){var e=ie();return this.multiplyTo(t,e),e}function z8(t){var e=ie();return this.divRemTo(t,e,null),e}function V8(t){var e=ie();return this.divRemTo(t,null,e),e}function K8(t){var e=ie(),r=ie();return this.divRemTo(t,e,r),new Array(e,r)}function G8(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function H8(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Wi(){}function cy(t){return t}function W8(t,e,r){t.multiplyTo(e,r)}function $8(t,e){t.squareTo(e)}Wi.prototype.convert=cy;Wi.prototype.revert=cy;Wi.prototype.mulTo=W8;Wi.prototype.sqrTo=$8;function j8(t){return this.exp(t,new Wi)}function J8(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var s;for(s=r.t-this.t;n<s;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(s=Math.min(t.t,e);n<s;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Z8(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function As(t){this.r2=ie(),this.q3=ie(),B.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function X8(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ie();return t.copyTo(e),this.reduce(e),e}function Q8(t){return t}function Y8(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function e3(t,e){t.squareTo(e),this.reduce(e)}function t3(t,e,r){t.multiplyTo(e,r),this.reduce(r)}As.prototype.convert=X8;As.prototype.revert=Q8;As.prototype.reduce=Y8;As.prototype.mulTo=t3;As.prototype.sqrTo=e3;function r3(t,e){var r=t.bitLength(),n,s=fn(1),i;if(r<=0)return s;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?i=new Ln(e):e.isEven()?i=new As(e):i=new Un(e);var o=new Array,a=3,c=n-1,f=(1<<n)-1;if(o[1]=i.convert(this),n>1){var u=ie();for(i.sqrTo(o[1],u);a<=f;)o[a]=ie(),i.mulTo(u,o[a-2],o[a]),a+=2}var h=t.t-1,l,g=!0,p=ie(),d;for(r=Oa(t.data[h])-1;h>=0;){for(r>=c?l=t.data[h]>>r-c&f:(l=(t.data[h]&(1<<r+1)-1)<<c-r,h>0&&(l|=t.data[h-1]>>this.DB+r-c)),a=n;(l&1)==0;)l>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),g)o[l].copyTo(s),g=!1;else{for(;a>1;)i.sqrTo(s,p),i.sqrTo(p,s),a-=2;a>0?i.sqrTo(s,p):(d=s,s=p,p=d),i.mulTo(p,o[l],s)}for(;h>=0&&(t.data[h]&1<<r)==0;)i.sqrTo(s,p),d=s,s=p,p=d,--r<0&&(r=this.DB-1,--h)}return i.revert(s)}function n3(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var s=e.getLowestSetBit(),i=r.getLowestSetBit();if(i<0)return e;for(s<i&&(i=s),i>0&&(e.rShiftTo(i,e),r.rShiftTo(i,r));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return i>0&&r.lShiftTo(i,r),r}function s3(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function i3(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return B.ZERO;for(var r=t.clone(),n=this.clone(),s=fn(1),i=fn(0),o=fn(0),a=fn(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!s.isEven()||!i.isEven())&&(s.addTo(this,s),i.subTo(t,i)),s.rShiftTo(1,s)):i.isEven()||i.subTo(t,i),i.rShiftTo(1,i);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!a.isEven())&&(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&s.subTo(o,s),i.subTo(a,i)):(n.subTo(r,n),e&&o.subTo(s,o),a.subTo(i,a))}if(n.compareTo(B.ONE)!=0)return B.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var jt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],o3=(1<<26)/jt[jt.length-1];function a3(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=jt[jt.length-1]){for(e=0;e<jt.length;++e)if(r.data[0]==jt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<jt.length;){for(var n=jt[e],s=e+1;s<jt.length&&n<o3;)n*=jt[s++];for(n=r.modInt(n);e<s;)if(n%jt[e++]==0)return!1}return r.millerRabin(t)}function u3(t){var e=this.subtract(B.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),s=c3(),i,o=0;o<t;++o){do i=new B(this.bitLength(),s);while(i.compareTo(B.ONE)<=0||i.compareTo(e)>=0);var a=i.modPow(n,this);if(a.compareTo(B.ONE)!=0&&a.compareTo(e)!=0){for(var c=1;c++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(B.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function c3(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}B.prototype.chunkSize=f8;B.prototype.toRadix=l8;B.prototype.fromRadix=p8;B.prototype.fromNumber=d8;B.prototype.bitwiseTo=D8;B.prototype.changeBit=k8;B.prototype.addTo=F8;B.prototype.dMultiply=G8;B.prototype.dAddOffset=H8;B.prototype.multiplyLowerTo=J8;B.prototype.multiplyUpperTo=Z8;B.prototype.modInt=s3;B.prototype.millerRabin=u3;B.prototype.clone=o8;B.prototype.intValue=a8;B.prototype.byteValue=u8;B.prototype.shortValue=c8;B.prototype.signum=h8;B.prototype.toByteArray=g8;B.prototype.equals=y8;B.prototype.min=m8;B.prototype.max=b8;B.prototype.and=w8;B.prototype.or=x8;B.prototype.xor=E8;B.prototype.andNot=S8;B.prototype.not=C8;B.prototype.shiftLeft=A8;B.prototype.shiftRight=I8;B.prototype.getLowestSetBit=T8;B.prototype.bitCount=P8;B.prototype.testBit=R8;B.prototype.setBit=O8;B.prototype.clearBit=M8;B.prototype.flipBit=N8;B.prototype.add=L8;B.prototype.subtract=U8;B.prototype.multiply=q8;B.prototype.divide=z8;B.prototype.remainder=V8;B.prototype.divideAndRemainder=K8;B.prototype.modPow=r3;B.prototype.modInverse=i3;B.prototype.pow=j8;B.prototype.gcd=n3;B.prototype.isProbablePrime=a3});var gy=k((n_,dy)=>{var yr=he();Fn();Ne();var ly=dy.exports=yr.sha1=yr.sha1||{};yr.md.sha1=yr.md.algorithms.sha1=ly;ly.create=function(){py||f3();var t=null,e=yr.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var s=n.messageLengthSize/4,i=0;i<s;++i)n.fullMessageLength.push(0);return e=yr.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(s,i){i==="utf8"&&(s=yr.util.encodeUtf8(s));var o=s.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=o[1],o[1]=o[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(s),hy(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var s=yr.util.createBuffer();s.putBytes(e.bytes());var i=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=i&n.blockLength-1;s.putBytes(Nf.substr(0,n.blockLength-o));for(var a,c,f=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)a=n.fullMessageLength[u+1]*8,c=a/4294967296>>>0,f+=c,s.putInt32(f>>>0),f=a>>>0;s.putInt32(f);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};hy(h,r,s);var l=yr.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Nf=null,py=!1;function f3(){Nf=String.fromCharCode(128),Nf+=yr.util.fillString(String.fromCharCode(0),64),py=!0}function hy(t,e,r){for(var n,s,i,o,a,c,f,u,h=r.length();h>=64;){for(s=t.h0,i=t.h1,o=t.h2,a=t.h3,c=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,f=a^i&(o^a),n=(s<<5|s>>>27)+f+c+1518500249+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=a^i&(o^a),n=(s<<5|s>>>27)+f+c+1518500249+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,f=i^o^a,n=(s<<5|s>>>27)+f+c+1859775393+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=i^o^a,n=(s<<5|s>>>27)+f+c+1859775393+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=i&o|a&(i^o),n=(s<<5|s>>>27)+f+c+2400959708+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,f=i^o^a,n=(s<<5|s>>>27)+f+c+3395469782+n,c=a,a=o,o=(i<<30|i>>>2)>>>0,i=s,s=n;t.h0=t.h0+s|0,t.h1=t.h1+i|0,t.h2=t.h2+o|0,t.h3=t.h3+a|0,t.h4=t.h4+c|0,h-=64}}});var by=k((s_,my)=>{var mr=he();Ne();Hi();gy();var yy=my.exports=mr.pkcs1=mr.pkcs1||{};yy.encode_rsa_oaep=function(t,e,r){var n,s,i,o;typeof r=="string"?(n=r,s=arguments[3]||void 0,i=arguments[4]||void 0):r&&(n=r.label||void 0,s=r.seed||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),i?i.start():i=mr.md.sha1.create(),o||(o=i);var a=Math.ceil(t.n.bitLength()/8),c=a-2*i.digestLength-2;if(e.length>c){var f=new Error("RSAES-OAEP input message length is too long.");throw f.length=e.length,f.maxLength=c,f}n||(n=""),i.update(n,"raw");for(var u=i.digest(),h="",l=c-e.length,g=0;g<l;g++)h+="\0";var p=u.getBytes()+h+""+e;if(!s)s=mr.random.getBytes(i.digestLength);else if(s.length!==i.digestLength){var f=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw f.seedLength=s.length,f.digestLength=i.digestLength,f}var d=Na(s,a-i.digestLength-1,o),y=mr.util.xorBytes(p,d,p.length),m=Na(y,i.digestLength,o),D=mr.util.xorBytes(s,m,s.length);return"\0"+D+y};yy.decode_rsa_oaep=function(t,e,r){var n,s,i;typeof r=="string"?(n=r,s=arguments[3]||void 0):r&&(n=r.label||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(i=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=o,y}if(s===void 0?s=mr.md.sha1.create():s.start(),i||(i=s),o<2*s.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),s.update(n,"raw");for(var a=s.digest().getBytes(),c=e.charAt(0),f=e.substring(1,s.digestLength+1),u=e.substring(1+s.digestLength),h=Na(u,s.digestLength,i),l=mr.util.xorBytes(f,h,f.length),g=Na(l,o-s.digestLength-1,i),p=mr.util.xorBytes(u,g,u.length),d=p.substring(0,s.digestLength),y=c!=="\0",m=0;m<s.digestLength;++m)y|=a.charAt(m)!==d.charAt(m);for(var D=1,E=s.digestLength,w=s.digestLength;w<p.length;w++){var b=p.charCodeAt(w),x=b&1^1,C=D?65534:0;y|=b&C,D=D&x,E+=D}if(y||p.charCodeAt(E)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(E+1)};function Na(t,e,r){r||(r=mr.md.sha1.create());for(var n="",s=Math.ceil(e/r.digestLength),i=0;i<s;++i){var o=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,i&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var Dy=k((i_,Ff)=>{var hn=he();Ne();Ma();Hi();(function(){if(hn.prime){Ff.exports=hn.prime;return}var t=Ff.exports=hn.prime=hn.prime||{},e=hn.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var s=function(h,l){return h|l};t.generateProbablePrime=function(h,l,g){typeof l=="function"&&(g=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var d=l.prng||hn.random,y={nextBytes:function(m){for(var D=d.getBytesSync(m.length),E=0;E<m.length;++E)m[E]=D.charCodeAt(E)}};if(p.name==="PRIMEINC")return i(h,y,p.options,g);throw new Error("Invalid prime generation algorithm: "+p.name)};function i(h,l,g,p){return"workers"in g?c(h,l,g,p):o(h,l,g,p)}function o(h,l,g,p){var d=f(h,l),y=0,m=u(d.bitLength());"millerRabinTests"in g&&(m=g.millerRabinTests);var D=10;"maxBlockTime"in g&&(D=g.maxBlockTime),a(d,h,l,y,m,D,p)}function a(h,l,g,p,d,y,m){var D=+new Date;do{if(h.bitLength()>l&&(h=f(l,g)),h.isProbablePrime(d))return m(null,h);h.dAddOffset(r[p++%8],0)}while(y<0||+new Date-D<y);hn.util.setImmediate(function(){a(h,l,g,p,d,y,m)})}function c(h,l,g,p){if(typeof Worker>"u")return o(h,l,g,p);var d=f(h,l),y=g.workers,m=g.workLoad||100,D=m*30/8,E=g.workerScript||"forge/prime.worker.js";if(y===-1)return hn.util.estimateCores(function(b,x){b&&(x=2),y=x-1,w()});w();function w(){y=Math.max(1,y);for(var b=[],x=0;x<y;++x)b[x]=new Worker(E);for(var C=y,x=0;x<y;++x)b[x].addEventListener("message",O);var I=!1;function O(X){if(!I){--C;var fe=X.data;if(fe.found){for(var Q=0;Q<b.length;++Q)b[Q].terminate();return I=!0,p(null,new e(fe.prime,16))}d.bitLength()>h&&(d=f(h,l));var Tr=d.toString(16);X.target.postMessage({hex:Tr,workLoad:m}),d.dAddOffset(D,0)}}}}function f(h,l){var g=new e(h,l),p=h-1;return g.testBit(p)||g.bitwiseTo(e.ONE.shiftLeft(p),s,g),g.dAddOffset(31-g.mod(n).byteValue(),0),g}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var La=k((o_,Ay)=>{var K=he();Gi();Ma();xa();by();Dy();Hi();Ne();typeof ee>"u"&&(ee=K.jsbn.BigInteger);var ee,Lf=K.util.isNodejs?Ss():null,S=K.asn1,Mt=K.util;K.pki=K.pki||{};Ay.exports=K.pki.rsa=K.rsa=K.rsa||{};var $=K.pki,h3=[6,4,2,4,2,4,6,2],l3={name:"PrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},p3={name:"RSAPrivateKey",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},d3={name:"RSAPublicKey",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},g3=K.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:S.Class.UNIVERSAL,type:S.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},y3={name:"DigestInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},m3=function(t){var e;if(t.algorithm in $.oids)e=$.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=S.oidToDer(e).getBytes(),s=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]),i=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[]);i.value.push(S.create(S.Class.UNIVERSAL,S.Type.OID,!1,n)),i.value.push(S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,""));var o=S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,t.digest().getBytes());return s.value.push(i),s.value.push(o),S.toDer(s).getBytes()},Sy=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(ee.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(ee.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new ee(K.util.bytesToHex(K.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(ee.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var s=t.mod(e.p).modPow(e.dP,e.p),i=t.mod(e.q).modPow(e.dQ,e.q);s.compareTo(i)<0;)s=s.add(e.p);var o=s.subtract(i).multiply(e.qInv).mod(e.p).multiply(e.q).add(i);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};$.rsa.encrypt=function(t,e,r){var n=r,s,i=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,s=Cy(t,e,r)):(s=K.util.createBuffer(),s.putBytes(t));for(var o=new ee(s.toHex(),16),a=Sy(o,e,n),c=a.toString(16),f=K.util.createBuffer(),u=i-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(K.util.hexToBytes(c)),f.getBytes()};$.rsa.decrypt=function(t,e,r,n){var s=Math.ceil(e.n.bitLength()/8);if(t.length!==s){var i=new Error("Encrypted message length is invalid.");throw i.length=t.length,i.expected=s,i}var o=new ee(K.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=Sy(o,e,r),c=a.toString(16),f=K.util.createBuffer(),u=s-Math.ceil(c.length/2);u>0;)f.putByte(0),--u;return f.putBytes(K.util.hexToBytes(c)),n!==!1?Fa(f.getBytes(),e,r):f.getBytes()};$.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||K.random,s={nextBytes:function(a){for(var c=n.getBytesSync(a.length),f=0;f<a.length;++f)a[f]=c.charCodeAt(f)}},i=r.algorithm||"PRIMEINC",o;if(i==="PRIMEINC")o={algorithm:i,state:0,bits:t,rng:s,eInt:e||65537,e:new ee(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+i);return o};$.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new ee(null);r.fromInt(30);for(var n=0,s=function(h,l){return h|l},i=+new Date,o,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var c=t.p===null?t.pBits:t.qBits,f=c-1;t.pqState===0?(t.num=new ee(c,t.rng),t.num.testBit(f)||t.num.bitwiseTo(ee.ONE.shiftLeft(f),s,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>c?t.pqState=0:t.num.isProbablePrime(D3(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(h3[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(ee.ONE).gcd(t.e).compareTo(ee.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(ee.ONE),t.q1=t.q.subtract(ee.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(ee.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:$.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:$.rsa.setPublicKey(t.n,t.e)}}o=+new Date,a+=o-i,i=o}return t.keys!==null};$.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!K.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(vy("generateKeyPair"))return Lf.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,c,f){if(a)return n(a);n(null,{privateKey:$.privateKeyFromPem(f),publicKey:$.publicKeyFromPem(c)})});if(wy("generateKey")&&wy("exportKey"))return Mt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ey(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Mt.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var c=$.privateKeyFromAsn1(S.fromDer(K.util.createBuffer(a)));n(null,{privateKey:c,publicKey:$.setRsaPublicKey(c.n,c.e)})}});if(xy("generateKey")&&xy("exportKey")){var s=Mt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Ey(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);s.oncomplete=function(a){var c=a.target.result,f=Mt.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);f.oncomplete=function(u){var h=u.target.result,l=$.privateKeyFromAsn1(S.fromDer(K.util.createBuffer(h)));n(null,{privateKey:l,publicKey:$.setRsaPublicKey(l.n,l.e)})},f.onerror=function(u){n(u)}},s.onerror=function(a){n(a)};return}}else if(vy("generateKeyPairSync")){var i=Lf.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:$.privateKeyFromPem(i.privateKey),publicKey:$.publicKeyFromPem(i.publicKey)}}}var o=$.rsa.createKeyPairGenerationState(t,e,r);if(!n)return $.rsa.stepKeyPairGenerationState(o,0),o.keys;b3(o,r,n)};$.setRsaPublicKey=$.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,s,i){if(typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSAES-PKCS1-V1_5"),s==="RSAES-PKCS1-V1_5")s={encode:function(a,c,f){return Cy(a,c,2).getBytes()}};else if(s==="RSA-OAEP"||s==="RSAES-OAEP")s={encode:function(a,c){return K.pkcs1.encode_rsa_oaep(c,a,i)}};else if(["RAW","NONE","NULL",null].indexOf(s)!==-1)s={encode:function(a){return a}};else if(typeof s=="string")throw new Error('Unsupported encryption scheme: "'+s+'".');var o=s.encode(n,r,!0);return $.rsa.encrypt(o,r,!0)},r.verify=function(n,s,i,o){typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),i==="RSASSA-PKCS1-V1_5"?i={verify:function(c,f){f=Fa(f,r,!0);var u=S.fromDer(f,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!S.validate(u,y3,h,l)){var g=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw g.errors=l,g}var p=S.derToOid(h.algorithmIdentifier);if(!(p===K.oids.md2||p===K.oids.md5||p===K.oids.sha1||p===K.oids.sha224||p===K.oids.sha256||p===K.oids.sha384||p===K.oids.sha512||p===K.oids["sha512-224"]||p===K.oids["sha512-256"])){var g=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw g.oid=p,g}if((p===K.oids.md2||p===K.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===h.digest}}:(i==="NONE"||i==="NULL"||i===null)&&(i={verify:function(c,f){return f=Fa(f,r,!0),c===f}});var a=$.rsa.decrypt(s,r,!0,!1);return i.verify(n,a,r.n.bitLength())},r};$.setRsaPrivateKey=$.rsa.setPrivateKey=function(t,e,r,n,s,i,o,a){var c={n:t,e,d:r,p:n,q:s,dP:i,dQ:o,qInv:a};return c.decrypt=function(f,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=$.rsa.decrypt(f,c,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Fa};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(g,p){return K.pkcs1.decode_rsa_oaep(p,g,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(g){return g}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,c,!1)},c.sign=function(f,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:m3},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return f}},h=1);var l=u.encode(f,c.n.bitLength());return $.rsa.encrypt(l,c,h)},c};$.wrapRsaPrivateKey=function(t){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(0).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer($.oids.rsaEncryption).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")]),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,S.toDer(t).getBytes())])};$.privateKeyFromAsn1=function(t){var e={},r=[];if(S.validate(t,l3,e,r)&&(t=S.fromDer(K.util.createBuffer(e.privateKey))),e={},r=[],!S.validate(t,p3,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var s,i,o,a,c,f,u,h;return s=K.util.createBuffer(e.privateKeyModulus).toHex(),i=K.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=K.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=K.util.createBuffer(e.privateKeyPrime1).toHex(),c=K.util.createBuffer(e.privateKeyPrime2).toHex(),f=K.util.createBuffer(e.privateKeyExponent1).toHex(),u=K.util.createBuffer(e.privateKeyExponent2).toHex(),h=K.util.createBuffer(e.privateKeyCoefficient).toHex(),$.setRsaPrivateKey(new ee(s,16),new ee(i,16),new ee(o,16),new ee(a,16),new ee(c,16),new ee(f,16),new ee(u,16),new ee(h,16))};$.privateKeyToAsn1=$.privateKeyToRSAPrivateKey=function(t){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,S.integerToDer(0).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.n)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.e)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.d)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.p)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.q)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.dP)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.dQ)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.qInv))])};$.publicKeyFromAsn1=function(t){var e={},r=[];if(S.validate(t,g3,e,r)){var n=S.derToOid(e.publicKeyOid);if(n!==$.oids.rsaEncryption){var s=new Error("Cannot read public key. Unknown OID.");throw s.oid=n,s}t=e.rsaPublicKey}if(r=[],!S.validate(t,d3,e,r)){var s=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw s.errors=r,s}var i=K.util.createBuffer(e.publicKeyModulus).toHex(),o=K.util.createBuffer(e.publicKeyExponent).toHex();return $.setRsaPublicKey(new ee(i,16),new ee(o,16))};$.publicKeyToAsn1=$.publicKeyToSubjectPublicKeyInfo=function(t){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer($.oids.rsaEncryption).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")]),S.create(S.Class.UNIVERSAL,S.Type.BITSTRING,!1,[$.publicKeyToRSAPublicKey(t)])])};$.publicKeyToRSAPublicKey=function(t){return S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.n)),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,br(t.e))])};function Cy(t,e,r){var n=K.util.createBuffer(),s=Math.ceil(e.n.bitLength()/8);if(t.length>s-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=t.length,i.max=s-11,i}n.putByte(0),n.putByte(r);var o=s-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var c=0;c<o;++c)n.putByte(a)}else for(;o>0;){for(var f=0,u=K.random.getBytes(o),c=0;c<o;++c)a=u.charCodeAt(c),a===0?++f:n.putByte(a);o=f}return n.putByte(0),n.putBytes(t),n}function Fa(t,e,r,n){var s=Math.ceil(e.n.bitLength()/8),i=K.util.createBuffer(t),o=i.getByte(),a=i.getByte();if(o!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(a===0){c=s-3-n;for(var f=0;f<c;++f)if(i.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(c=0;i.length()>1;){if(i.getByte()!==255){--i.read;break}++c}else if(a===2)for(c=0;i.length()>1;){if(i.getByte()===0){--i.read;break}++c}var u=i.getByte();if(u!==0||c!==s-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function b3(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),s();function s(){i(t.pBits,function(a,c){if(a)return r(a);if(t.p=c,t.q!==null)return o(a,t.q);i(t.qBits,o)})}function i(a,c){K.prime.generateProbablePrime(a,n,c)}function o(a,c){if(a)return r(a);if(t.q=c,t.p.compareTo(t.q)<0){var f=t.p;t.p=t.q,t.q=f}if(t.p.subtract(ee.ONE).gcd(t.e).compareTo(ee.ONE)!==0){t.p=null,s();return}if(t.q.subtract(ee.ONE).gcd(t.e).compareTo(ee.ONE)!==0){t.q=null,i(t.qBits,o);return}if(t.p1=t.p.subtract(ee.ONE),t.q1=t.q.subtract(ee.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(ee.ONE)!==0){t.p=t.q=null,s();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,i(t.qBits,o);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:$.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:$.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function br(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=K.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function D3(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function vy(t){return K.util.isNodejs&&typeof Lf[t]=="function"}function wy(t){return typeof Mt.globalScope<"u"&&typeof Mt.globalScope.crypto=="object"&&typeof Mt.globalScope.crypto.subtle=="object"&&typeof Mt.globalScope.crypto.subtle[t]=="function"}function xy(t){return typeof Mt.globalScope<"u"&&typeof Mt.globalScope.msCrypto=="object"&&typeof Mt.globalScope.msCrypto.subtle=="object"&&typeof Mt.globalScope.msCrypto.subtle[t]=="function"}function Ey(t){for(var e=K.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var Ry=k((a_,Py)=>{var F=he();Ia();Gi();Fg();Fn();xa();Tf();Gg();Hi();ry();La();Ne();typeof Iy>"u"&&(Iy=F.jsbn.BigInteger);var Iy,A=F.asn1,j=F.pki=F.pki||{};Py.exports=j.pbe=F.pbe=F.pbe||{};var qn=j.oids,v3={name:"EncryptedPrivateKeyInfo",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},w3={name:"PBES2Algorithms",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:A.Class.UNIVERSAL,type:A.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},x3={name:"pkcs-12PbeParams",tagClass:A.Class.UNIVERSAL,type:A.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:A.Class.UNIVERSAL,type:A.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:A.Class.UNIVERSAL,type:A.Type.INTEGER,constructed:!1,capture:"iterations"}]};j.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=F.random.getBytesSync(r.saltSize),s=r.count,i=A.integerToDer(s),o,a,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var f,u,h;switch(r.algorithm){case"aes128":o=16,f=16,u=qn["aes128-CBC"],h=F.aes.createEncryptionCipher;break;case"aes192":o=24,f=16,u=qn["aes192-CBC"],h=F.aes.createEncryptionCipher;break;case"aes256":o=32,f=16,u=qn["aes256-CBC"],h=F.aes.createEncryptionCipher;break;case"des":o=8,f=8,u=qn.desCBC,h=F.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var g="hmacWith"+r.prfAlgorithm.toUpperCase(),p=_y(g),d=F.pkcs5.pbkdf2(e,n,s,o,p),y=F.random.getBytesSync(f),m=h(d);m.start(y),m.update(A.toDer(t)),m.finish(),c=m.output.getBytes();var D=E3(n,i,o,g);a=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(qn.pkcs5PBES2).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(qn.pkcs5PBKDF2).getBytes()),D]),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(u).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){o=24;var E=new F.util.ByteBuffer(n),d=j.pbe.generatePkcs12Key(e,E,1,s,o),y=j.pbe.generatePkcs12Key(e,E,2,s,o),m=F.des.createEncryptionCipher(d);m.start(y),m.update(A.toDer(t)),m.finish(),c=m.output.getBytes(),a=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(qn["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,n),A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,i.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var w=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[a,A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,c)]);return w};j.decryptPrivateKeyInfo=function(t,e){var r=null,n={},s=[];if(!A.validate(t,v3,n,s)){var i=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}var o=A.derToOid(n.encryptionOid),a=j.pbe.getCipher(o,n.encryptionParams,e),c=F.util.createBuffer(n.encryptedData);return a.update(c),a.finish()&&(r=A.fromDer(a.output)),r};j.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:A.toDer(t).getBytes()};return F.pem.encode(r,{maxline:e})};j.encryptedPrivateKeyFromPem=function(t){var e=F.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return A.fromDer(e.body)};j.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=j.wrapRsaPrivateKey(j.privateKeyToAsn1(t));return n=j.encryptPrivateKeyInfo(n,e,r),j.encryptedPrivateKeyToPem(n)}var s,i,o,a;switch(r.algorithm){case"aes128":s="AES-128-CBC",o=16,i=F.random.getBytesSync(16),a=F.aes.createEncryptionCipher;break;case"aes192":s="AES-192-CBC",o=24,i=F.random.getBytesSync(16),a=F.aes.createEncryptionCipher;break;case"aes256":s="AES-256-CBC",o=32,i=F.random.getBytesSync(16),a=F.aes.createEncryptionCipher;break;case"3des":s="DES-EDE3-CBC",o=24,i=F.random.getBytesSync(8),a=F.des.createEncryptionCipher;break;case"des":s="DES-CBC",o=8,i=F.random.getBytesSync(8),a=F.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var f=F.pbe.opensslDeriveBytes(e,i.substr(0,8),o),u=a(f);u.start(i),u.update(A.toDer(j.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:s,parameters:F.util.bytesToHex(i).toUpperCase()},body:u.output.getBytes()};return F.pem.encode(h)};j.decryptRsaPrivateKey=function(t,e){var r=null,n=F.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var s=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw s.headerType=s,s}if(n.procType&&n.procType.type==="ENCRYPTED"){var i,o;switch(n.dekInfo.algorithm){case"DES-CBC":i=8,o=F.des.createDecryptionCipher;break;case"DES-EDE3-CBC":i=24,o=F.des.createDecryptionCipher;break;case"AES-128-CBC":i=16,o=F.aes.createDecryptionCipher;break;case"AES-192-CBC":i=24,o=F.aes.createDecryptionCipher;break;case"AES-256-CBC":i=32,o=F.aes.createDecryptionCipher;break;case"RC2-40-CBC":i=5,o=function(h){return F.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":i=8,o=function(h){return F.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":i=16,o=function(h){return F.rc2.createDecryptionCipher(h,128)};break;default:var s=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw s.algorithm=n.dekInfo.algorithm,s}var a=F.util.hexToBytes(n.dekInfo.parameters),c=F.pbe.opensslDeriveBytes(e,a.substr(0,8),i),f=o(c);if(f.start(a),f.update(F.util.createBuffer(n.body)),f.finish())r=f.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=j.decryptPrivateKeyInfo(A.fromDer(r),e):r=A.fromDer(r),r!==null&&(r=j.privateKeyFromAsn1(r)),r};j.pbe.generatePkcs12Key=function(t,e,r,n,s,i){var o,a;if(typeof i>"u"||i===null){if(!("sha1"in F.md))throw new Error('"sha1" hash algorithm unavailable.');i=F.md.sha1.create()}var c=i.digestLength,f=i.blockLength,u=new F.util.ByteBuffer,h=new F.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var l=h.length(),g=e.length(),p=new F.util.ByteBuffer;p.fillWithByte(r,f);var d=f*Math.ceil(g/f),y=new F.util.ByteBuffer;for(a=0;a<d;a++)y.putByte(e.at(a%g));var m=f*Math.ceil(l/f),D=new F.util.ByteBuffer;for(a=0;a<m;a++)D.putByte(h.at(a%l));var E=y;E.putBuffer(D);for(var w=Math.ceil(s/c),b=1;b<=w;b++){var x=new F.util.ByteBuffer;x.putBytes(p.bytes()),x.putBytes(E.bytes());for(var C=0;C<n;C++)i.start(),i.update(x.getBytes()),x=i.digest();var I=new F.util.ByteBuffer;for(a=0;a<f;a++)I.putByte(x.at(a%c));var O=Math.ceil(g/f)+Math.ceil(l/f),X=new F.util.ByteBuffer;for(o=0;o<O;o++){var fe=new F.util.ByteBuffer(E.getBytes(f)),Q=511;for(a=I.length()-1;a>=0;a--)Q=Q>>8,Q+=I.at(a)+fe.at(a),fe.setAt(a,Q&255);X.putBuffer(fe)}E=X,u.putBuffer(x)}return u.truncate(u.length()-s),u};j.pbe.getCipher=function(t,e,r){switch(t){case j.oids.pkcs5PBES2:return j.pbe.getCipherForPBES2(t,e,r);case j.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case j.oids["pbewithSHAAnd40BitRC2-CBC"]:return j.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};j.pbe.getCipherForPBES2=function(t,e,r){var n={},s=[];if(!A.validate(e,w3,n,s)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}if(t=A.derToOid(n.kdfOid),t!==j.oids.pkcs5PBKDF2){var i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw i.oid=t,i.supportedOids=["pkcs5PBKDF2"],i}if(t=A.derToOid(n.encOid),t!==j.oids["aes128-CBC"]&&t!==j.oids["aes192-CBC"]&&t!==j.oids["aes256-CBC"]&&t!==j.oids["des-EDE3-CBC"]&&t!==j.oids.desCBC){var i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw i.oid=t,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i}var o=n.kdfSalt,a=F.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var c,f;switch(j.oids[t]){case"aes128-CBC":c=16,f=F.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,f=F.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,f=F.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,f=F.des.createDecryptionCipher;break;case"desCBC":c=8,f=F.des.createDecryptionCipher;break}var u=Ty(n.prfOid),h=F.pkcs5.pbkdf2(r,o,a,c,u),l=n.encIv,g=f(h);return g.start(l),g};j.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},s=[];if(!A.validate(e,x3,n,s)){var i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw i.errors=s,i}var o=F.util.createBuffer(n.salt),a=F.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var c,f,u;switch(t){case j.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,f=8,u=F.des.startDecrypting;break;case j.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,f=8,u=function(d,y){var m=F.rc2.createDecryptionCipher(d,40);return m.start(y,null),m};break;default:var i=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw i.oid=t,i}var h=Ty(n.prfOid),l=j.pbe.generatePkcs12Key(r,o,1,a,c,h);h.start();var g=j.pbe.generatePkcs12Key(r,o,2,a,f,h);return u(l,g)};j.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in F.md))throw new Error('"md5" hash algorithm unavailable.');n=F.md.md5.create()}e===null&&(e="");for(var s=[By(n,t+e)],i=16,o=1;i<r;++o,i+=16)s.push(By(n,s[o-1]+t+e));return s.join("").substr(0,r)};function By(t,e){return t.start().update(e).digest().getBytes()}function Ty(t){var e;if(!t)e="hmacWithSHA1";else if(e=j.oids[A.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return _y(e)}function _y(t){var e=F.md;switch(t){case"hmacWithSHA224":e=F.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function E3(t,e,r,n){var s=A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OCTETSTRING,!1,t),A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&s.value.push(A.create(A.Class.UNIVERSAL,A.Type.INTEGER,!1,F.util.hexToBytes(r.toString(16))),A.create(A.Class.UNIVERSAL,A.Type.SEQUENCE,!0,[A.create(A.Class.UNIVERSAL,A.Type.OID,!1,A.oidToDer(j.oids[n]).getBytes()),A.create(A.Class.UNIVERSAL,A.Type.NULL,!1,"")])),s}});var am=k((RP,om)=>{var De=he();Fn();Ne();var Xi=om.exports=De.sha512=De.sha512||{};De.md.sha512=De.md.algorithms.sha512=Xi;var sm=De.sha384=De.sha512.sha384=De.sha512.sha384||{};sm.create=function(){return Xi.create("SHA-384")};De.md.sha384=De.md.algorithms.sha384=sm;De.sha512.sha256=De.sha512.sha256||{create:function(){return Xi.create("SHA-512/256")}};De.md["sha512/256"]=De.md.algorithms["sha512/256"]=De.sha512.sha256;De.sha512.sha224=De.sha512.sha224||{create:function(){return Xi.create("SHA-512/224")}};De.md["sha512/224"]=De.md.algorithms["sha512/224"]=De.sha512.sha224;Xi.create=function(t){if(im||ME(),typeof t>"u"&&(t="SHA-512"),!(t in Kn))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Kn[t],r=null,n=De.util.createBuffer(),s=new Array(80),i=0;i<80;++i)s[i]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var c=a.messageLengthSize/4,f=0;f<c;++f)a.fullMessageLength.push(0);n=De.util.createBuffer(),r=new Array(e.length);for(var f=0;f<e.length;++f)r[f]=e[f].slice(0);return a},a.start(),a.update=function(c,f){f==="utf8"&&(c=De.util.encodeUtf8(c));var u=c.length;a.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=u[1],u[1]=u[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(c),nm(r,s,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var c=De.util.createBuffer();c.putBytes(n.bytes());var f=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,u=f&a.blockLength-1;c.putBytes(uh.substr(0,a.blockLength-u));for(var h,l,g=a.fullMessageLength[0]*8,p=0;p<a.fullMessageLength.length-1;++p)h=a.fullMessageLength[p+1]*8,l=h/4294967296>>>0,g+=l,c.putInt32(g>>>0),g=h>>>0;c.putInt32(g);for(var d=new Array(r.length),p=0;p<r.length;++p)d[p]=r[p].slice(0);nm(d,s,c);var y=De.util.createBuffer(),m;t==="SHA-512"?m=d.length:t==="SHA-384"?m=d.length-2:m=d.length-4;for(var p=0;p<m;++p)y.putInt32(d[p][0]),(p!==m-1||t!=="SHA-512/224")&&y.putInt32(d[p][1]);return y},a};var uh=null,im=!1,ch=null,Kn=null;function ME(){uh=String.fromCharCode(128),uh+=De.util.fillString(String.fromCharCode(0),128),ch=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Kn={},Kn["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Kn["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Kn["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Kn["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],im=!0}function nm(t,e,r){for(var n,s,i,o,a,c,f,u,h,l,g,p,d,y,m,D,E,w,b,x,C,I,O,X,fe,Q,Tr,Qe,Ae,et,G,is,Ci,ct,os,as=r.length();as>=128;){for(Ae=0;Ae<16;++Ae)e[Ae][0]=r.getInt32()>>>0,e[Ae][1]=r.getInt32()>>>0;for(;Ae<80;++Ae)is=e[Ae-2],et=is[0],G=is[1],n=((et>>>19|G<<13)^(G>>>29|et<<3)^et>>>6)>>>0,s=((et<<13|G>>>19)^(G<<3|et>>>29)^(et<<26|G>>>6))>>>0,ct=e[Ae-15],et=ct[0],G=ct[1],i=((et>>>1|G<<31)^(et>>>8|G<<24)^et>>>7)>>>0,o=((et<<31|G>>>1)^(et<<24|G>>>8)^(et<<25|G>>>7))>>>0,Ci=e[Ae-7],os=e[Ae-16],G=s+Ci[1]+o+os[1],e[Ae][0]=n+Ci[0]+i+os[0]+(G/4294967296>>>0)>>>0,e[Ae][1]=G>>>0;for(d=t[0][0],y=t[0][1],m=t[1][0],D=t[1][1],E=t[2][0],w=t[2][1],b=t[3][0],x=t[3][1],C=t[4][0],I=t[4][1],O=t[5][0],X=t[5][1],fe=t[6][0],Q=t[6][1],Tr=t[7][0],Qe=t[7][1],Ae=0;Ae<80;++Ae)f=((C>>>14|I<<18)^(C>>>18|I<<14)^(I>>>9|C<<23))>>>0,u=((C<<18|I>>>14)^(C<<14|I>>>18)^(I<<23|C>>>9))>>>0,h=(fe^C&(O^fe))>>>0,l=(Q^I&(X^Q))>>>0,a=((d>>>28|y<<4)^(y>>>2|d<<30)^(y>>>7|d<<25))>>>0,c=((d<<4|y>>>28)^(y<<30|d>>>2)^(y<<25|d>>>7))>>>0,g=(d&m|E&(d^m))>>>0,p=(y&D|w&(y^D))>>>0,G=Qe+u+l+ch[Ae][1]+e[Ae][1],n=Tr+f+h+ch[Ae][0]+e[Ae][0]+(G/4294967296>>>0)>>>0,s=G>>>0,G=c+p,i=a+g+(G/4294967296>>>0)>>>0,o=G>>>0,Tr=fe,Qe=Q,fe=O,Q=X,O=C,X=I,G=x+s,C=b+n+(G/4294967296>>>0)>>>0,I=G>>>0,b=E,x=w,E=m,w=D,m=d,D=y,G=s+o,d=n+i+(G/4294967296>>>0)>>>0,y=G>>>0;G=t[0][1]+y,t[0][0]=t[0][0]+d+(G/4294967296>>>0)>>>0,t[0][1]=G>>>0,G=t[1][1]+D,t[1][0]=t[1][0]+m+(G/4294967296>>>0)>>>0,t[1][1]=G>>>0,G=t[2][1]+w,t[2][0]=t[2][0]+E+(G/4294967296>>>0)>>>0,t[2][1]=G>>>0,G=t[3][1]+x,t[3][0]=t[3][0]+b+(G/4294967296>>>0)>>>0,t[3][1]=G>>>0,G=t[4][1]+I,t[4][0]=t[4][0]+C+(G/4294967296>>>0)>>>0,t[4][1]=G>>>0,G=t[5][1]+X,t[5][0]=t[5][0]+O+(G/4294967296>>>0)>>>0,t[5][1]=G>>>0,G=t[6][1]+Q,t[6][0]=t[6][0]+fe+(G/4294967296>>>0)>>>0,t[6][1]=G>>>0,G=t[7][1]+Qe,t[7][0]=t[7][0]+Tr+(G/4294967296>>>0)>>>0,t[7][1]=G>>>0,as-=128}}});var oD=k(($O,iD)=>{iD.exports=Pl;var sD=128,bA=127,DA=~bA,vA=Math.pow(2,31);function Pl(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw Pl.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=vA;)e[r++]=t&255|sD,t/=128;for(;t&DA;)e[r++]=t&255|sD,t>>>=7;return e[r]=t|0,Pl.bytes=r-n+1,e}});var cD=k((jO,uD)=>{uD.exports=Rl;var wA=128,aD=127;function Rl(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a||s>49)throw Rl.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&aD)<<s:(o&aD)*Math.pow(2,s),s+=7}while(o>=wA);return Rl.bytes=i-n,r}});var hD=k((JO,fD)=>{var xA=Math.pow(2,7),EA=Math.pow(2,14),SA=Math.pow(2,21),CA=Math.pow(2,28),AA=Math.pow(2,35),IA=Math.pow(2,42),BA=Math.pow(2,49),TA=Math.pow(2,56),_A=Math.pow(2,63);fD.exports=function(t){return t<xA?1:t<EA?2:t<SA?3:t<CA?4:t<AA?5:t<IA?6:t<BA?7:t<TA?8:t<_A?9:10}});var yu=k((ZO,lD)=>{lD.exports={encode:oD(),decode:cD(),encodingLength:hD()}});var TD=k((NM,BD)=>{var ui=1e3,ci=ui*60,fi=ci*60,Zn=fi*24,XA=Zn*7,QA=Zn*365.25;BD.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return YA(t);if(r==="number"&&isFinite(t))return e.long?tI(t):eI(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function YA(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*QA;case"weeks":case"week":case"w":return r*XA;case"days":case"day":case"d":return r*Zn;case"hours":case"hour":case"hrs":case"hr":case"h":return r*fi;case"minutes":case"minute":case"mins":case"min":case"m":return r*ci;case"seconds":case"second":case"secs":case"sec":case"s":return r*ui;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function eI(t){var e=Math.abs(t);return e>=Zn?Math.round(t/Zn)+"d":e>=fi?Math.round(t/fi)+"h":e>=ci?Math.round(t/ci)+"m":e>=ui?Math.round(t/ui)+"s":t+"ms"}function tI(t){var e=Math.abs(t);return e>=Zn?wu(t,e,Zn,"day"):e>=fi?wu(t,e,fi,"hour"):e>=ci?wu(t,e,ci,"minute"):e>=ui?wu(t,e,ui,"second"):t+" ms"}function wu(t,e,r,n){var s=e>=r*1.5;return Math.round(t/r)+" "+n+(s?"s":"")}});var PD=k((FM,_D)=>{function rI(t){r.debug=r,r.default=r,r.coerce=c,r.disable=i,r.enable=s,r.enabled=o,r.humanize=TD(),r.destroy=f,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(u){let h,l=null,g,p;function d(...y){if(!d.enabled)return;let m=d,D=Number(new Date),E=D-(h||D);m.diff=E,m.prev=h,m.curr=D,h=D,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let w=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(x,C)=>{if(x==="%%")return"%";w++;let I=r.formatters[C];if(typeof I=="function"){let O=y[w];x=I.call(m,O),y.splice(w,1),w--}return x}),r.formatArgs.call(m,y),(m.log||r.log).apply(m,y)}return d.namespace=u,d.useColors=r.useColors(),d.color=r.selectColor(u),d.extend=n,d.destroy=r.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(g!==r.namespaces&&(g=r.namespaces,p=r.enabled(u)),p),set:y=>{l=y}}),typeof r.init=="function"&&r.init(d),d}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function s(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),g=l.length;for(h=0;h<g;h++)!l[h]||(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function i(){let u=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}_D.exports=rI});var RD=k((It,xu)=>{It.formatArgs=sI;It.save=iI;It.load=oI;It.useColors=nI;It.storage=aI();It.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();It.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function nI(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function sI(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+xu.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(n=r))}),t.splice(n,0,e)}It.log=console.debug||console.log||(()=>{});function iI(t){try{t?It.storage.setItem("debug",t):It.storage.removeItem("debug")}catch{}}function oI(){let t;try{t=It.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function aI(){try{return localStorage}catch{}}xu.exports=PD()(It);var{formatters:uI}=xu.exports;uI.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var KD=k((mN,VD)=>{"use strict";VD.exports=Xe;var Bo=Cn();function Xe(t,e){this.lo=t>>>0,this.hi=e>>>0}var Yn=Xe.zero=new Xe(0,0);Yn.toNumber=function(){return 0};Yn.zzEncode=Yn.zzDecode=function(){return this};Yn.length=function(){return 1};var dI=Xe.zeroHash="\0\0\0\0\0\0\0\0";Xe.fromNumber=function(e){if(e===0)return Yn;var r=e<0;r&&(e=-e);var n=e>>>0,s=(e-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new Xe(n,s)};Xe.from=function(e){if(typeof e=="number")return Xe.fromNumber(e);if(Bo.isString(e))if(Bo.Long)e=Bo.Long.fromString(e);else return Xe.fromNumber(parseInt(e,10));return e.low||e.high?new Xe(e.low>>>0,e.high>>>0):Yn};Xe.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Xe.prototype.toLong=function(e){return Bo.Long?new Bo.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Sn=String.prototype.charCodeAt;Xe.fromHash=function(e){return e===dI?Yn:new Xe((Sn.call(e,0)|Sn.call(e,1)<<8|Sn.call(e,2)<<16|Sn.call(e,3)<<24)>>>0,(Sn.call(e,4)|Sn.call(e,5)<<8|Sn.call(e,6)<<16|Sn.call(e,7)<<24)>>>0)};Xe.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Xe.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Xe.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Xe.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Cn=k(Zl=>{"use strict";var z=Zl;z.asPromise=jo();z.base64=yc();z.EventEmitter=mc();z.float=bc();z.inquire=Xo();z.utf8=vc();z.pool=wc();z.LongBits=KD();z.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);z.global=z.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Zl;z.emptyArray=Object.freeze?Object.freeze([]):[];z.emptyObject=Object.freeze?Object.freeze({}):{};z.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};z.isString=function(e){return typeof e=="string"||e instanceof String};z.isObject=function(e){return e&&typeof e=="object"};z.isset=z.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};z.Buffer=function(){try{var t=z.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();z._Buffer_from=null;z._Buffer_allocUnsafe=null;z.newBuffer=function(e){return typeof e=="number"?z.Buffer?z._Buffer_allocUnsafe(e):new z.Array(e):z.Buffer?z._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};z.Array=typeof Uint8Array<"u"?Uint8Array:Array;z.Long=z.global.dcodeIO&&z.global.dcodeIO.Long||z.global.Long||z.inquire("long");z.key2Re=/^true|false|0|1$/;z.key32Re=/^-?(?:0|[1-9][0-9]*)$/;z.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;z.longToHash=function(e){return e?z.LongBits.from(e).toHash():z.LongBits.zeroHash};z.longFromHash=function(e,r){var n=z.LongBits.fromHash(e);return z.Long?z.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function GD(t,e,r){for(var n=Object.keys(e),s=0;s<n.length;++s)(t[n[s]]===void 0||!r)&&(t[n[s]]=e[n[s]]);return t}z.merge=GD;z.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function HD(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&GD(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}z.newError=HD;z.ProtocolError=HD("ProtocolError");z.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var s=Object.keys(this),i=s.length-1;i>-1;--i)if(r[s[i]]===1&&this[s[i]]!==void 0&&this[s[i]]!==null)return s[i]}};z.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};z.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};z._configure=function(){var t=z.Buffer;if(!t){z._Buffer_from=z._Buffer_allocUnsafe=null;return}z._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},z._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var np=k((DN,JD)=>{"use strict";JD.exports=oe;var qt=Cn(),Xl,Au=qt.LongBits,WD=qt.base64,$D=qt.utf8;function To(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Yl(){}function gI(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function oe(){this.len=0,this.head=new To(Yl,0,0),this.tail=this.head,this.states=null}var jD=function(){return qt.Buffer?function(){return(oe.create=function(){return new Xl})()}:function(){return new oe}};oe.create=jD();oe.alloc=function(e){return new qt.Array(e)};qt.Array!==Array&&(oe.alloc=qt.pool(oe.alloc,qt.Array.prototype.subarray));oe.prototype._push=function(e,r,n){return this.tail=this.tail.next=new To(e,r,n),this.len+=r,this};function ep(t,e,r){e[r]=t&255}function yI(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function tp(t,e){this.len=t,this.next=void 0,this.val=e}tp.prototype=Object.create(To.prototype);tp.prototype.fn=yI;oe.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new tp((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};oe.prototype.int32=function(e){return e<0?this._push(rp,10,Au.fromNumber(e)):this.uint32(e)};oe.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function rp(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}oe.prototype.uint64=function(e){var r=Au.from(e);return this._push(rp,r.length(),r)};oe.prototype.int64=oe.prototype.uint64;oe.prototype.sint64=function(e){var r=Au.from(e).zzEncode();return this._push(rp,r.length(),r)};oe.prototype.bool=function(e){return this._push(ep,1,e?1:0)};function Ql(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}oe.prototype.fixed32=function(e){return this._push(Ql,4,e>>>0)};oe.prototype.sfixed32=oe.prototype.fixed32;oe.prototype.fixed64=function(e){var r=Au.from(e);return this._push(Ql,4,r.lo)._push(Ql,4,r.hi)};oe.prototype.sfixed64=oe.prototype.fixed64;oe.prototype.float=function(e){return this._push(qt.float.writeFloatLE,4,e)};oe.prototype.double=function(e){return this._push(qt.float.writeDoubleLE,8,e)};var mI=qt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var s=0;s<e.length;++s)r[n+s]=e[s]};oe.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(ep,1,0);if(qt.isString(e)){var n=oe.alloc(r=WD.length(e));WD.decode(e,n,0),e=n}return this.uint32(r)._push(mI,r,e)};oe.prototype.string=function(e){var r=$D.length(e);return r?this.uint32(r)._push($D.write,r,e):this._push(ep,1,0)};oe.prototype.fork=function(){return this.states=new gI(this),this.head=this.tail=new To(Yl,0,0),this.len=0,this};oe.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new To(Yl,0,0),this.len=0),this};oe.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};oe.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};oe._configure=function(t){Xl=t,oe.create=jD(),Xl._configure()}});var QD=k((vN,XD)=>{"use strict";XD.exports=Cr;var ZD=np();(Cr.prototype=Object.create(ZD.prototype)).constructor=Cr;var An=Cn();function Cr(){ZD.call(this)}Cr._configure=function(){Cr.alloc=An._Buffer_allocUnsafe,Cr.writeBytesBuffer=An.Buffer&&An.Buffer.prototype instanceof Uint8Array&&An.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var s=0;s<e.length;)r[n++]=e[s++]}};Cr.prototype.bytes=function(e){An.isString(e)&&(e=An._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Cr.writeBytesBuffer,r,e),this};function bI(t,e,r){t.length<40?An.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Cr.prototype.string=function(e){var r=An.Buffer.byteLength(e);return this.uint32(r),r&&this._push(bI,r,e),this};Cr._configure()});var op=k((wN,nv)=>{"use strict";nv.exports=Fe;var Ar=Cn(),ip,tv=Ar.LongBits,DI=Ar.utf8;function er(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Fe(t){this.buf=t,this.pos=0,this.len=t.length}var YD=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Fe(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Fe(e);throw Error("illegal buffer")},rv=function(){return Ar.Buffer?function(r){return(Fe.create=function(s){return Ar.Buffer.isBuffer(s)?new ip(s):YD(s)})(r)}:YD};Fe.create=rv();Fe.prototype._slice=Ar.Array.prototype.subarray||Ar.Array.prototype.slice;Fe.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,er(this,10);return e}}();Fe.prototype.int32=function(){return this.uint32()|0};Fe.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function sp(){var t=new tv(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw er(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw er(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Fe.prototype.bool=function(){return this.uint32()!==0};function Iu(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Fe.prototype.fixed32=function(){if(this.pos+4>this.len)throw er(this,4);return Iu(this.buf,this.pos+=4)};Fe.prototype.sfixed32=function(){if(this.pos+4>this.len)throw er(this,4);return Iu(this.buf,this.pos+=4)|0};function ev(){if(this.pos+8>this.len)throw er(this,8);return new tv(Iu(this.buf,this.pos+=4),Iu(this.buf,this.pos+=4))}Fe.prototype.float=function(){if(this.pos+4>this.len)throw er(this,4);var e=Ar.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Fe.prototype.double=function(){if(this.pos+8>this.len)throw er(this,4);var e=Ar.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Fe.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw er(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Fe.prototype.string=function(){var e=this.bytes();return DI.read(e,0,e.length)};Fe.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw er(this,e);this.pos+=e}else do if(this.pos>=this.len)throw er(this);while(this.buf[this.pos++]&128);return this};Fe.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Fe._configure=function(t){ip=t,Fe.create=rv(),ip._configure();var e=Ar.Long?"toLong":"toNumber";Ar.merge(Fe.prototype,{int64:function(){return sp.call(this)[e](!1)},uint64:function(){return sp.call(this)[e](!0)},sint64:function(){return sp.call(this).zzDecode()[e](!1)},fixed64:function(){return ev.call(this)[e](!0)},sfixed64:function(){return ev.call(this)[e](!1)}})}});var av=k((xN,ov)=>{"use strict";ov.exports=es;var iv=op();(es.prototype=Object.create(iv.prototype)).constructor=es;var sv=Cn();function es(t){iv.call(this,t)}es._configure=function(){sv.Buffer&&(es.prototype._slice=sv.Buffer.prototype.slice)};es.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};es._configure()});var cv=k((EN,uv)=>{"use strict";uv.exports=_o;var ap=Cn();(_o.prototype=Object.create(ap.EventEmitter.prototype)).constructor=_o;function _o(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");ap.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}_o.prototype.rpcCall=function t(e,r,n,s,i){if(!s)throw TypeError("request must be specified");var o=this;if(!i)return ap.asPromise(t,o,e,r,n,s);if(!o.rpcImpl){setTimeout(function(){i(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(c,f){if(c)return o.emit("error",c,e),i(c);if(f===null){o.end(!0);return}if(!(f instanceof n))try{f=n[o.responseDelimited?"decodeDelimited":"decode"](f)}catch(u){return o.emit("error",u,e),i(u)}return o.emit("data",f,e),i(null,f)})}catch(a){o.emit("error",a,e),setTimeout(function(){i(a)},0);return}};_o.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var hv=k(fv=>{"use strict";var vI=fv;vI.Service=cv()});var pv=k((CN,lv)=>{"use strict";lv.exports={}});var yv=k(gv=>{"use strict";var mt=gv;mt.build="minimal";mt.Writer=np();mt.BufferWriter=QD();mt.Reader=op();mt.BufferReader=av();mt.util=Cn();mt.rpc=hv();mt.roots=pv();mt.configure=dv;function dv(){mt.util._configure(),mt.Writer._configure(mt.BufferWriter),mt.Reader._configure(mt.BufferReader)}dv()});var up=k((IN,mv)=>{"use strict";mv.exports=yv()});var Dv=k((bv,Po)=>{"use strict";(function(t,e){typeof define=="function"&&define.amd?define(["protobufjs/minimal"],e):typeof Lp=="function"&&typeof Po=="object"&&Po&&Po.exports&&(Po.exports=e(up()))})(bv,function(t){"use strict";var e=t.Reader,r=t.Writer,n=t.util,s=t.roots.default||(t.roots.default={});return s.RPC=function(){function i(a){if(this.subscriptions=[],this.messages=[],a)for(var c=Object.keys(a),f=0;f<c.length;++f)a[c[f]]!=null&&(this[c[f]]=a[c[f]])}i.prototype.subscriptions=n.emptyArray,i.prototype.messages=n.emptyArray,i.prototype.control=null;var o;return Object.defineProperty(i.prototype,"_control",{get:n.oneOfGetter(o=["control"]),set:n.oneOfSetter(o)}),i.encode=function(c,f){if(f||(f=r.create()),c.subscriptions!=null&&c.subscriptions.length)for(var u=0;u<c.subscriptions.length;++u)s.RPC.SubOpts.encode(c.subscriptions[u],f.uint32(10).fork()).ldelim();if(c.messages!=null&&c.messages.length)for(var u=0;u<c.messages.length;++u)s.RPC.Message.encode(c.messages[u],f.uint32(18).fork()).ldelim();return c.control!=null&&Object.hasOwnProperty.call(c,"control")&&s.RPC.ControlMessage.encode(c.control,f.uint32(26).fork()).ldelim(),f},i.decode=function(c,f){c instanceof e||(c=e.create(c));for(var u=f===void 0?c.len:c.pos+f,h=new s.RPC;c.pos<u;){var l=c.uint32();switch(l>>>3){case 1:h.subscriptions&&h.subscriptions.length||(h.subscriptions=[]),h.subscriptions.push(s.RPC.SubOpts.decode(c,c.uint32()));break;case 2:h.messages&&h.messages.length||(h.messages=[]),h.messages.push(s.RPC.Message.decode(c,c.uint32()));break;case 3:h.control=s.RPC.ControlMessage.decode(c,c.uint32());break;default:c.skipType(l&7);break}}return h},i.fromObject=function(c){if(c instanceof s.RPC)return c;var f=new s.RPC;if(c.subscriptions){if(!Array.isArray(c.subscriptions))throw TypeError(".RPC.subscriptions: array expected");f.subscriptions=[];for(var u=0;u<c.subscriptions.length;++u){if(typeof c.subscriptions[u]!="object")throw TypeError(".RPC.subscriptions: object expected");f.subscriptions[u]=s.RPC.SubOpts.fromObject(c.subscriptions[u])}}if(c.messages){if(!Array.isArray(c.messages))throw TypeError(".RPC.messages: array expected");f.messages=[];for(var u=0;u<c.messages.length;++u){if(typeof c.messages[u]!="object")throw TypeError(".RPC.messages: object expected");f.messages[u]=s.RPC.Message.fromObject(c.messages[u])}}if(c.control!=null){if(typeof c.control!="object")throw TypeError(".RPC.control: object expected");f.control=s.RPC.ControlMessage.fromObject(c.control)}return f},i.toObject=function(c,f){f||(f={});var u={};if((f.arrays||f.defaults)&&(u.subscriptions=[],u.messages=[]),c.subscriptions&&c.subscriptions.length){u.subscriptions=[];for(var h=0;h<c.subscriptions.length;++h)u.subscriptions[h]=s.RPC.SubOpts.toObject(c.subscriptions[h],f)}if(c.messages&&c.messages.length){u.messages=[];for(var h=0;h<c.messages.length;++h)u.messages[h]=s.RPC.Message.toObject(c.messages[h],f)}return c.control!=null&&c.hasOwnProperty("control")&&(u.control=s.RPC.ControlMessage.toObject(c.control,f),f.oneofs&&(u._control="control")),u},i.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},i.SubOpts=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.subscribe=null,a.prototype.topic=null;var c;return Object.defineProperty(a.prototype,"_subscribe",{get:n.oneOfGetter(c=["subscribe"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_topic",{get:n.oneOfGetter(c=["topic"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.subscribe!=null&&Object.hasOwnProperty.call(u,"subscribe")&&h.uint32(8).bool(u.subscribe),u.topic!=null&&Object.hasOwnProperty.call(u,"topic")&&h.uint32(18).string(u.topic),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,g=new s.RPC.SubOpts;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:g.subscribe=u.bool();break;case 2:g.topic=u.string();break;default:u.skipType(p&7);break}}return g},a.fromObject=function(u){if(u instanceof s.RPC.SubOpts)return u;var h=new s.RPC.SubOpts;return u.subscribe!=null&&(h.subscribe=Boolean(u.subscribe)),u.topic!=null&&(h.topic=String(u.topic)),h},a.toObject=function(u,h){h||(h={});var l={};return u.subscribe!=null&&u.hasOwnProperty("subscribe")&&(l.subscribe=u.subscribe,h.oneofs&&(l._subscribe="subscribe")),u.topic!=null&&u.hasOwnProperty("topic")&&(l.topic=u.topic,h.oneofs&&(l._topic="topic")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.Message=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.from=null,a.prototype.data=null,a.prototype.seqno=null,a.prototype.topic="",a.prototype.signature=null,a.prototype.key=null;var c;return Object.defineProperty(a.prototype,"_from",{get:n.oneOfGetter(c=["from"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_data",{get:n.oneOfGetter(c=["data"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_seqno",{get:n.oneOfGetter(c=["seqno"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signature",{get:n.oneOfGetter(c=["signature"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_key",{get:n.oneOfGetter(c=["key"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.from!=null&&Object.hasOwnProperty.call(u,"from")&&h.uint32(10).bytes(u.from),u.data!=null&&Object.hasOwnProperty.call(u,"data")&&h.uint32(18).bytes(u.data),u.seqno!=null&&Object.hasOwnProperty.call(u,"seqno")&&h.uint32(26).bytes(u.seqno),h.uint32(34).string(u.topic),u.signature!=null&&Object.hasOwnProperty.call(u,"signature")&&h.uint32(42).bytes(u.signature),u.key!=null&&Object.hasOwnProperty.call(u,"key")&&h.uint32(50).bytes(u.key),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,g=new s.RPC.Message;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:g.from=u.bytes();break;case 2:g.data=u.bytes();break;case 3:g.seqno=u.bytes();break;case 4:g.topic=u.string();break;case 5:g.signature=u.bytes();break;case 6:g.key=u.bytes();break;default:u.skipType(p&7);break}}if(!g.hasOwnProperty("topic"))throw n.ProtocolError("missing required 'topic'",{instance:g});return g},a.fromObject=function(u){if(u instanceof s.RPC.Message)return u;var h=new s.RPC.Message;return u.from!=null&&(typeof u.from=="string"?n.base64.decode(u.from,h.from=n.newBuffer(n.base64.length(u.from)),0):u.from.length&&(h.from=u.from)),u.data!=null&&(typeof u.data=="string"?n.base64.decode(u.data,h.data=n.newBuffer(n.base64.length(u.data)),0):u.data.length&&(h.data=u.data)),u.seqno!=null&&(typeof u.seqno=="string"?n.base64.decode(u.seqno,h.seqno=n.newBuffer(n.base64.length(u.seqno)),0):u.seqno.length&&(h.seqno=u.seqno)),u.topic!=null&&(h.topic=String(u.topic)),u.signature!=null&&(typeof u.signature=="string"?n.base64.decode(u.signature,h.signature=n.newBuffer(n.base64.length(u.signature)),0):u.signature.length&&(h.signature=u.signature)),u.key!=null&&(typeof u.key=="string"?n.base64.decode(u.key,h.key=n.newBuffer(n.base64.length(u.key)),0):u.key.length&&(h.key=u.key)),h},a.toObject=function(u,h){h||(h={});var l={};return h.defaults&&(l.topic=""),u.from!=null&&u.hasOwnProperty("from")&&(l.from=h.bytes===String?n.base64.encode(u.from,0,u.from.length):h.bytes===Array?Array.prototype.slice.call(u.from):u.from,h.oneofs&&(l._from="from")),u.data!=null&&u.hasOwnProperty("data")&&(l.data=h.bytes===String?n.base64.encode(u.data,0,u.data.length):h.bytes===Array?Array.prototype.slice.call(u.data):u.data,h.oneofs&&(l._data="data")),u.seqno!=null&&u.hasOwnProperty("seqno")&&(l.seqno=h.bytes===String?n.base64.encode(u.seqno,0,u.seqno.length):h.bytes===Array?Array.prototype.slice.call(u.seqno):u.seqno,h.oneofs&&(l._seqno="seqno")),u.topic!=null&&u.hasOwnProperty("topic")&&(l.topic=u.topic),u.signature!=null&&u.hasOwnProperty("signature")&&(l.signature=h.bytes===String?n.base64.encode(u.signature,0,u.signature.length):h.bytes===Array?Array.prototype.slice.call(u.signature):u.signature,h.oneofs&&(l._signature="signature")),u.key!=null&&u.hasOwnProperty("key")&&(l.key=h.bytes===String?n.base64.encode(u.key,0,u.key.length):h.bytes===Array?Array.prototype.slice.call(u.key):u.key,h.oneofs&&(l._key="key")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlMessage=function(){function a(c){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],c)for(var f=Object.keys(c),u=0;u<f.length;++u)c[f[u]]!=null&&(this[f[u]]=c[f[u]])}return a.prototype.ihave=n.emptyArray,a.prototype.iwant=n.emptyArray,a.prototype.graft=n.emptyArray,a.prototype.prune=n.emptyArray,a.encode=function(f,u){if(u||(u=r.create()),f.ihave!=null&&f.ihave.length)for(var h=0;h<f.ihave.length;++h)s.RPC.ControlIHave.encode(f.ihave[h],u.uint32(10).fork()).ldelim();if(f.iwant!=null&&f.iwant.length)for(var h=0;h<f.iwant.length;++h)s.RPC.ControlIWant.encode(f.iwant[h],u.uint32(18).fork()).ldelim();if(f.graft!=null&&f.graft.length)for(var h=0;h<f.graft.length;++h)s.RPC.ControlGraft.encode(f.graft[h],u.uint32(26).fork()).ldelim();if(f.prune!=null&&f.prune.length)for(var h=0;h<f.prune.length;++h)s.RPC.ControlPrune.encode(f.prune[h],u.uint32(34).fork()).ldelim();return u},a.decode=function(f,u){f instanceof e||(f=e.create(f));for(var h=u===void 0?f.len:f.pos+u,l=new s.RPC.ControlMessage;f.pos<h;){var g=f.uint32();switch(g>>>3){case 1:l.ihave&&l.ihave.length||(l.ihave=[]),l.ihave.push(s.RPC.ControlIHave.decode(f,f.uint32()));break;case 2:l.iwant&&l.iwant.length||(l.iwant=[]),l.iwant.push(s.RPC.ControlIWant.decode(f,f.uint32()));break;case 3:l.graft&&l.graft.length||(l.graft=[]),l.graft.push(s.RPC.ControlGraft.decode(f,f.uint32()));break;case 4:l.prune&&l.prune.length||(l.prune=[]),l.prune.push(s.RPC.ControlPrune.decode(f,f.uint32()));break;default:f.skipType(g&7);break}}return l},a.fromObject=function(f){if(f instanceof s.RPC.ControlMessage)return f;var u=new s.RPC.ControlMessage;if(f.ihave){if(!Array.isArray(f.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");u.ihave=[];for(var h=0;h<f.ihave.length;++h){if(typeof f.ihave[h]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");u.ihave[h]=s.RPC.ControlIHave.fromObject(f.ihave[h])}}if(f.iwant){if(!Array.isArray(f.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");u.iwant=[];for(var h=0;h<f.iwant.length;++h){if(typeof f.iwant[h]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");u.iwant[h]=s.RPC.ControlIWant.fromObject(f.iwant[h])}}if(f.graft){if(!Array.isArray(f.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");u.graft=[];for(var h=0;h<f.graft.length;++h){if(typeof f.graft[h]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");u.graft[h]=s.RPC.ControlGraft.fromObject(f.graft[h])}}if(f.prune){if(!Array.isArray(f.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");u.prune=[];for(var h=0;h<f.prune.length;++h){if(typeof f.prune[h]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");u.prune[h]=s.RPC.ControlPrune.fromObject(f.prune[h])}}return u},a.toObject=function(f,u){u||(u={});var h={};if((u.arrays||u.defaults)&&(h.ihave=[],h.iwant=[],h.graft=[],h.prune=[]),f.ihave&&f.ihave.length){h.ihave=[];for(var l=0;l<f.ihave.length;++l)h.ihave[l]=s.RPC.ControlIHave.toObject(f.ihave[l],u)}if(f.iwant&&f.iwant.length){h.iwant=[];for(var l=0;l<f.iwant.length;++l)h.iwant[l]=s.RPC.ControlIWant.toObject(f.iwant[l],u)}if(f.graft&&f.graft.length){h.graft=[];for(var l=0;l<f.graft.length;++l)h.graft[l]=s.RPC.ControlGraft.toObject(f.graft[l],u)}if(f.prune&&f.prune.length){h.prune=[];for(var l=0;l<f.prune.length;++l)h.prune[l]=s.RPC.ControlPrune.toObject(f.prune[l],u)}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlIHave=function(){function a(f){if(this.messageIDs=[],f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.topicID=null,a.prototype.messageIDs=n.emptyArray;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){if(h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),u.messageIDs!=null&&u.messageIDs.length)for(var l=0;l<u.messageIDs.length;++l)h.uint32(18).bytes(u.messageIDs[l]);return h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,g=new s.RPC.ControlIHave;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:g.topicID=u.string();break;case 2:g.messageIDs&&g.messageIDs.length||(g.messageIDs=[]),g.messageIDs.push(u.bytes());break;default:u.skipType(p&7);break}}return g},a.fromObject=function(u){if(u instanceof s.RPC.ControlIHave)return u;var h=new s.RPC.ControlIHave;if(u.topicID!=null&&(h.topicID=String(u.topicID)),u.messageIDs){if(!Array.isArray(u.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");h.messageIDs=[];for(var l=0;l<u.messageIDs.length;++l)typeof u.messageIDs[l]=="string"?n.base64.decode(u.messageIDs[l],h.messageIDs[l]=n.newBuffer(n.base64.length(u.messageIDs[l])),0):u.messageIDs[l].length&&(h.messageIDs[l]=u.messageIDs[l])}return h},a.toObject=function(u,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.messageIDs=[]),u.topicID!=null&&u.hasOwnProperty("topicID")&&(l.topicID=u.topicID,h.oneofs&&(l._topicID="topicID")),u.messageIDs&&u.messageIDs.length){l.messageIDs=[];for(var g=0;g<u.messageIDs.length;++g)l.messageIDs[g]=h.bytes===String?n.base64.encode(u.messageIDs[g],0,u.messageIDs[g].length):h.bytes===Array?Array.prototype.slice.call(u.messageIDs[g]):u.messageIDs[g]}return l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlIWant=function(){function a(c){if(this.messageIDs=[],c)for(var f=Object.keys(c),u=0;u<f.length;++u)c[f[u]]!=null&&(this[f[u]]=c[f[u]])}return a.prototype.messageIDs=n.emptyArray,a.encode=function(f,u){if(u||(u=r.create()),f.messageIDs!=null&&f.messageIDs.length)for(var h=0;h<f.messageIDs.length;++h)u.uint32(10).bytes(f.messageIDs[h]);return u},a.decode=function(f,u){f instanceof e||(f=e.create(f));for(var h=u===void 0?f.len:f.pos+u,l=new s.RPC.ControlIWant;f.pos<h;){var g=f.uint32();switch(g>>>3){case 1:l.messageIDs&&l.messageIDs.length||(l.messageIDs=[]),l.messageIDs.push(f.bytes());break;default:f.skipType(g&7);break}}return l},a.fromObject=function(f){if(f instanceof s.RPC.ControlIWant)return f;var u=new s.RPC.ControlIWant;if(f.messageIDs){if(!Array.isArray(f.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");u.messageIDs=[];for(var h=0;h<f.messageIDs.length;++h)typeof f.messageIDs[h]=="string"?n.base64.decode(f.messageIDs[h],u.messageIDs[h]=n.newBuffer(n.base64.length(f.messageIDs[h])),0):f.messageIDs[h].length&&(u.messageIDs[h]=f.messageIDs[h])}return u},a.toObject=function(f,u){u||(u={});var h={};if((u.arrays||u.defaults)&&(h.messageIDs=[]),f.messageIDs&&f.messageIDs.length){h.messageIDs=[];for(var l=0;l<f.messageIDs.length;++l)h.messageIDs[l]=u.bytes===String?n.base64.encode(f.messageIDs[l],0,f.messageIDs[l].length):u.bytes===Array?Array.prototype.slice.call(f.messageIDs[l]):f.messageIDs[l]}return h},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlGraft=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.topicID=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,g=new s.RPC.ControlGraft;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:g.topicID=u.string();break;default:u.skipType(p&7);break}}return g},a.fromObject=function(u){if(u instanceof s.RPC.ControlGraft)return u;var h=new s.RPC.ControlGraft;return u.topicID!=null&&(h.topicID=String(u.topicID)),h},a.toObject=function(u,h){h||(h={});var l={};return u.topicID!=null&&u.hasOwnProperty("topicID")&&(l.topicID=u.topicID,h.oneofs&&(l._topicID="topicID")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.ControlPrune=function(){function a(f){if(this.peers=[],f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.topicID=null,a.prototype.peers=n.emptyArray,a.prototype.backoff=null;var c;return Object.defineProperty(a.prototype,"_topicID",{get:n.oneOfGetter(c=["topicID"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_backoff",{get:n.oneOfGetter(c=["backoff"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){if(h||(h=r.create()),u.topicID!=null&&Object.hasOwnProperty.call(u,"topicID")&&h.uint32(10).string(u.topicID),u.peers!=null&&u.peers.length)for(var l=0;l<u.peers.length;++l)s.RPC.PeerInfo.encode(u.peers[l],h.uint32(18).fork()).ldelim();return u.backoff!=null&&Object.hasOwnProperty.call(u,"backoff")&&h.uint32(24).uint64(u.backoff),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,g=new s.RPC.ControlPrune;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:g.topicID=u.string();break;case 2:g.peers&&g.peers.length||(g.peers=[]),g.peers.push(s.RPC.PeerInfo.decode(u,u.uint32()));break;case 3:g.backoff=u.uint64();break;default:u.skipType(p&7);break}}return g},a.fromObject=function(u){if(u instanceof s.RPC.ControlPrune)return u;var h=new s.RPC.ControlPrune;if(u.topicID!=null&&(h.topicID=String(u.topicID)),u.peers){if(!Array.isArray(u.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");h.peers=[];for(var l=0;l<u.peers.length;++l){if(typeof u.peers[l]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");h.peers[l]=s.RPC.PeerInfo.fromObject(u.peers[l])}}return u.backoff!=null&&(n.Long?(h.backoff=n.Long.fromValue(u.backoff)).unsigned=!0:typeof u.backoff=="string"?h.backoff=parseInt(u.backoff,10):typeof u.backoff=="number"?h.backoff=u.backoff:typeof u.backoff=="object"&&(h.backoff=new n.LongBits(u.backoff.low>>>0,u.backoff.high>>>0).toNumber(!0))),h},a.toObject=function(u,h){h||(h={});var l={};if((h.arrays||h.defaults)&&(l.peers=[]),u.topicID!=null&&u.hasOwnProperty("topicID")&&(l.topicID=u.topicID,h.oneofs&&(l._topicID="topicID")),u.peers&&u.peers.length){l.peers=[];for(var g=0;g<u.peers.length;++g)l.peers[g]=s.RPC.PeerInfo.toObject(u.peers[g],h)}return u.backoff!=null&&u.hasOwnProperty("backoff")&&(typeof u.backoff=="number"?l.backoff=h.longs===String?String(u.backoff):u.backoff:l.backoff=h.longs===String?n.Long.prototype.toString.call(u.backoff):h.longs===Number?new n.LongBits(u.backoff.low>>>0,u.backoff.high>>>0).toNumber(!0):u.backoff,h.oneofs&&(l._backoff="backoff")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i.PeerInfo=function(){function a(f){if(f)for(var u=Object.keys(f),h=0;h<u.length;++h)f[u[h]]!=null&&(this[u[h]]=f[u[h]])}a.prototype.peerID=null,a.prototype.signedPeerRecord=null;var c;return Object.defineProperty(a.prototype,"_peerID",{get:n.oneOfGetter(c=["peerID"]),set:n.oneOfSetter(c)}),Object.defineProperty(a.prototype,"_signedPeerRecord",{get:n.oneOfGetter(c=["signedPeerRecord"]),set:n.oneOfSetter(c)}),a.encode=function(u,h){return h||(h=r.create()),u.peerID!=null&&Object.hasOwnProperty.call(u,"peerID")&&h.uint32(10).bytes(u.peerID),u.signedPeerRecord!=null&&Object.hasOwnProperty.call(u,"signedPeerRecord")&&h.uint32(18).bytes(u.signedPeerRecord),h},a.decode=function(u,h){u instanceof e||(u=e.create(u));for(var l=h===void 0?u.len:u.pos+h,g=new s.RPC.PeerInfo;u.pos<l;){var p=u.uint32();switch(p>>>3){case 1:g.peerID=u.bytes();break;case 2:g.signedPeerRecord=u.bytes();break;default:u.skipType(p&7);break}}return g},a.fromObject=function(u){if(u instanceof s.RPC.PeerInfo)return u;var h=new s.RPC.PeerInfo;return u.peerID!=null&&(typeof u.peerID=="string"?n.base64.decode(u.peerID,h.peerID=n.newBuffer(n.base64.length(u.peerID)),0):u.peerID.length&&(h.peerID=u.peerID)),u.signedPeerRecord!=null&&(typeof u.signedPeerRecord=="string"?n.base64.decode(u.signedPeerRecord,h.signedPeerRecord=n.newBuffer(n.base64.length(u.signedPeerRecord)),0):u.signedPeerRecord.length&&(h.signedPeerRecord=u.signedPeerRecord)),h},a.toObject=function(u,h){h||(h={});var l={};return u.peerID!=null&&u.hasOwnProperty("peerID")&&(l.peerID=h.bytes===String?n.base64.encode(u.peerID,0,u.peerID.length):h.bytes===Array?Array.prototype.slice.call(u.peerID):u.peerID,h.oneofs&&(l._peerID="peerID")),u.signedPeerRecord!=null&&u.hasOwnProperty("signedPeerRecord")&&(l.signedPeerRecord=h.bytes===String?n.base64.encode(u.signedPeerRecord,0,u.signedPeerRecord.length):h.bytes===Array?Array.prototype.slice.call(u.signedPeerRecord):u.signedPeerRecord,h.oneofs&&(l._signedPeerRecord="signedPeerRecord")),l},a.prototype.toJSON=function(){return this.constructor.toObject(this,t.util.toJSONOptions)},a}(),i}(),s})});var Zv=k((UF,Jv)=>{"use strict";function ke(t,r){var r=r||{};this._head=0,this._tail=0,this._capacity=r.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}ke.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};ke.prototype.get=function(e){return this.peekAt(e)};ke.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};ke.prototype.peekFront=function(){return this.peek()};ke.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(ke.prototype,"length",{get:function(){return this.size()}});ke.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ke.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ke.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};ke.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};ke.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};ke.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),s=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var i=this._list[r],o;if(e<n/2){for(o=e;o>0;o--)this._list[r]=this._list[r=r-1+s&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+s&this._capacityMask}else{for(o=n-1-e;o>0;o--)this._list[r]=this._list[r=r+1+s&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+s&this._capacityMask}return i}}};ke.prototype.remove=function(e,r){var n=e,s,i=r;if(n===(n|0)&&this._head!==this._tail){var o=this.size(),a=this._list.length;if(!(n>=o||n<-o||r<1)){if(n<0&&(n+=o),r===1||!r)return s=new Array(1),s[0]=this.removeOne(n),s;if(n===0&&n+r>=o)return s=this.toArray(),this.clear(),s;n+r>o&&(r=o-n);var c;for(s=new Array(r),c=0;c<r;c++)s[c]=this._list[this._head+n+c&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===o){for(this._tail=this._tail-r+a&this._capacityMask,c=r;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return s}if(e===0){for(this._head=this._head+r+a&this._capacityMask,c=r-1;c>0;c--)this._list[n=n+1+a&this._capacityMask]=void 0;return s}if(n<o/2){for(this._head=this._head+e+r+a&this._capacityMask,c=e;c>0;c--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;i>0;)this._list[n=n-1+a&this._capacityMask]=void 0,i--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,c=o-(r+e);c>0;c--)this.push(this._list[n++]);for(n=this._tail;i>0;)this._list[n=n+1+a&this._capacityMask]=void 0,i--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),s}}};ke.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var s=this.size();if(n<0&&(n+=s),!(n>s))if(arguments.length>2){var i,o,a,c=arguments.length,f=this._list.length,u=2;if(!s||n<s/2){for(o=new Array(n),i=0;i<n;i++)o[i]=this._list[this._head+i&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+f&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+f&this._capacityMask);c>u;)this.unshift(arguments[--c]);for(i=n;i>0;i--)this.unshift(o[i-1])}else{o=new Array(s-(n+r));var h=o.length;for(i=0;i<h;i++)o[i]=this._list[this._head+n+r+i&this._capacityMask];for(r===0?(a=[],n!=s&&(this._tail=this._head+n+f&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-h+f&this._capacityMask);u<c;)this.push(arguments[u++]);for(i=0;i<h;i++)this.push(o[i])}return a}else return this.remove(n,r)}};ke.prototype.clear=function(){this._head=0,this._tail=0};ke.prototype.isEmpty=function(){return this._head===this._tail};ke.prototype.toArray=function(){return this._copyArray(!1)};ke.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};ke.prototype._copyArray=function(e){var r=[],n=this._list,s=n.length,i;if(e||this._head>this._tail){for(i=this._head;i<s;i++)r.push(n[i]);for(i=0;i<this._tail;i++)r.push(n[i])}else for(i=this._head;i<this._tail;i++)r.push(n[i]);return r};ke.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};ke.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Jv.exports=ke});var PB={};U(PB,{GossipSub:()=>qo,gossipsub:()=>_B,multicodec:()=>TB});var Ko=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},us=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new Ko(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new Ko(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};function Tn(t={}){return C1(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function C1(t,e){e=e??{};let r=e.onEnd,n=new us,s,i,o,a=async()=>n.isEmpty()?o?{done:!0}:await new Promise((d,y)=>{i=m=>{i=null,n.push(m);try{d(t(n))}catch(D){y(D)}return s}}):t(n),c=d=>i!=null?i(d):(n.push(d),s),f=d=>(n=new us,i!=null?i({error:d}):(n.push({error:d}),s)),u=d=>{if(o)return s;if(e?.objectMode!==!0&&d?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return c({done:!1,value:d})},h=d=>o?s:(o=!0,d!=null?f(d):c({done:!0})),l=()=>(n=new us,h(),{done:!0}),g=d=>(h(d),{done:!0});if(s={[Symbol.asyncIterator](){return this},next:a,return:l,throw:g,push:u,end:h,get readableLength(){return n.size}},r==null)return s;let p=s;return s={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(d){return p.throw(d),r!=null&&(r(d),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:u,end(d){return p.end(d),r!=null&&(r(d),r=void 0),s},get readableLength(){return p.readableLength}},s}var Jp=W(jp(),1),B1=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},Zp=t=>t!=null&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),ju=t=>t!=null&&typeof t.sink=="function"&&Zp(t.source),T1=t=>e=>{let r=t.sink(e);if(r.then!=null){let n=Tn({objectMode:!0});return r.then(()=>{n.end()},i=>{n.end(i)}),(0,Jp.default)(n,async function*(){yield*t.source,n.end()}())}return t.source};function cs(t,...e){if(ju(t)){let n=t;t=()=>n.source}else if(Zp(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&ju(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)ju(r[n])&&(r[n]=T1(r[n]));return B1(...r)}var Tb=W(Le(),1);var Yu={};U(Yu,{identity:()=>N1});function P1(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,D=p.length;m!==D&&p[m]===0;)m++,d++;for(var E=(D-m)*u+1>>>0,w=new Uint8Array(E);m!==D;){for(var b=p[m],x=0,C=E-1;(b!==0||x<y)&&C!==-1;C--,x++)b+=256*w[C]>>>0,w[C]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=x,m++}for(var I=E-y;I!==E&&w[I]===0;)I++;for(var O=c.repeat(d);I<E;++I)O+=t.charAt(w[I]);return O}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===c;)y++,d++;for(var D=(p.length-d)*f+1>>>0,E=new Uint8Array(D);p[d];){var w=r[p.charCodeAt(d)];if(w===255)return;for(var b=0,x=D-1;(w!==0||b<m)&&x!==-1;x--,b++)w+=a*E[x]>>>0,E[x]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var C=D-m;C!==D&&E[C]===0;)C++;for(var I=new Uint8Array(y+(D-C)),O=y;C!==D;)I[O++]=E[C++];return I}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var R1=P1,k1=R1,Yp=k1;var $B=new Uint8Array(0);var e0=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},_r=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var t0=t=>new TextEncoder().encode(t),r0=t=>new TextDecoder().decode(t);var Ju=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Zu=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return s0(this,e)}},Xu=class{constructor(e){this.decoders=e}or(e){return s0(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},s0=(t,e)=>new Xu({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Qu=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Ju(e,r,n),this.decoder=new Zu(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},fs=({name:t,prefix:e,encode:r,decode:n})=>new Qu(t,e,r,n),en=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:s}=Yp(r,e);return fs({prefix:t,name:e,encode:n,decode:i=>_r(s(i))})},O1=(t,e,r,n)=>{let s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,c=0,f=0;for(let u=0;u<i;++u){let h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},M1=(t,e,r)=>{let n=e[e.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Ie=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>fs({prefix:e,name:t,encode(s){return M1(s,n,r)},decode(s){return O1(s,n,r,t)}});var N1=fs({prefix:"\0",name:"identity",encode:t=>r0(t),decode:t=>t0(t)});var ec={};U(ec,{base2:()=>F1});var F1=Ie({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var tc={};U(tc,{base8:()=>L1});var L1=Ie({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var rc={};U(rc,{base10:()=>U1});var U1=en({prefix:"9",name:"base10",alphabet:"0123456789"});var nc={};U(nc,{base16:()=>q1,base16upper:()=>z1});var q1=Ie({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),z1=Ie({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sc={};U(sc,{base32:()=>hs,base32hex:()=>H1,base32hexpad:()=>$1,base32hexpadupper:()=>j1,base32hexupper:()=>W1,base32pad:()=>K1,base32padupper:()=>G1,base32upper:()=>V1,base32z:()=>J1});var hs=Ie({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),V1=Ie({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),K1=Ie({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),G1=Ie({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),H1=Ie({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),W1=Ie({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$1=Ie({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j1=Ie({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J1=Ie({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ic={};U(ic,{base36:()=>Z1,base36upper:()=>X1});var Z1=en({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),X1=en({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var oc={};U(oc,{base58btc:()=>rr,base58flickr:()=>Q1});var rr=en({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q1=en({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ac={};U(ac,{base64:()=>Y1,base64pad:()=>e2,base64url:()=>t2,base64urlpad:()=>r2});var Y1=Ie({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),e2=Ie({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),t2=Ie({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),r2=Ie({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var uc={};U(uc,{base256emoji:()=>a2});var i0=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),n2=i0.reduce((t,e,r)=>(t[r]=e,t),[]),s2=i0.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function i2(t){return t.reduce((e,r)=>(e+=n2[r],e),"")}function o2(t){let e=[];for(let r of t){let n=s2[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var a2=fs({prefix:"\u{1F680}",name:"base256emoji",encode:i2,decode:o2});var lc={};U(lc,{sha256:()=>A2,sha512:()=>I2});var u2=u0,o0=128,c2=127,f2=~c2,h2=Math.pow(2,31);function u0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=h2;)e[r++]=t&255|o0,t/=128;for(;t&f2;)e[r++]=t&255|o0,t>>>=7;return e[r]=t|0,u0.bytes=r-n+1,e}var l2=cc,p2=128,a0=127;function cc(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw cc.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&a0)<<s:(o&a0)*Math.pow(2,s),s+=7}while(o>=p2);return cc.bytes=i-n,r}var d2=Math.pow(2,7),g2=Math.pow(2,14),y2=Math.pow(2,21),m2=Math.pow(2,28),b2=Math.pow(2,35),D2=Math.pow(2,42),v2=Math.pow(2,49),w2=Math.pow(2,56),x2=Math.pow(2,63),E2=function(t){return t<d2?1:t<g2?2:t<y2?3:t<m2?4:t<b2?5:t<D2?6:t<v2?7:t<w2?8:t<x2?9:10},S2={encode:u2,decode:l2,encodingLength:E2},C2=S2,Ai=C2;var Ii=(t,e=0)=>[Ai.decode(t,e),Ai.decode.bytes],ls=(t,e,r=0)=>(Ai.encode(t,e,r),e),ps=t=>Ai.encodingLength(t);var _n=(t,e)=>{let r=e.byteLength,n=ps(t),s=n+ps(r),i=new Uint8Array(s+r);return ls(t,i,0),ls(r,i,n),i.set(e,s),new ds(t,r,e,i)},c0=t=>{let e=_r(t),[r,n]=Ii(e),[s,i]=Ii(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new ds(r,s,o,e)},f0=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&e0(t.bytes,e.bytes),ds=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};var hc=({name:t,code:e,encode:r})=>new fc(t,e,r),fc=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?_n(this.code,r):r.then(n=>_n(this.code,n))}else throw Error("Unknown type, must be binary type")}};var l0=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),A2=hc({name:"sha2-256",code:18,encode:l0("SHA-256")}),I2=hc({name:"sha2-512",code:19,encode:l0("SHA-512")});var pc={};U(pc,{identity:()=>_2});var p0=0,B2="identity",d0=_r,T2=t=>_n(p0,d0(t)),_2={code:p0,name:B2,encode:d0,digest:T2};var d5=new TextEncoder,g5=new TextDecoder;var Ke=class{constructor(e,r,n,s){this.code=r,this.version=e,this.multihash=n,this.bytes=s,this.byteOffset=s.byteOffset,this.byteLength=s.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Wo,byteLength:Wo,code:Ho,version:Ho,multihash:Ho,bytes:Ho,_baseCache:Wo,asCID:Wo})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Ti)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==N2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ke.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=_n(e,r);return Ke.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&f0(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:s}=this;switch(n){case 0:return O2(r,s,e||rr.encoder);default:return M2(r,s,e||hs.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return L2(/^0\.0/,U2),!!(e&&(e[y0]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof Ke)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:s,bytes:i}=e;return new Ke(r,n,s,i||g0(r,n,s.bytes))}else if(e!=null&&e[y0]===!0){let{version:r,multihash:n,code:s}=e,i=c0(n);return Ke.create(r,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Ti)throw new Error(`Version 0 CID must use dag-pb (code: ${Ti}) block encoding`);return new Ke(e,r,n,n.bytes)}case 1:{let s=g0(e,r,n.bytes);return new Ke(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Ke.create(0,Ti,e)}static createV1(e,r){return Ke.create(1,e,r)}static decode(e){let[r,n]=Ke.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ke.inspectBytes(e),n=r.size-r.multihashSize,s=_r(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=s.subarray(r.multihashSize-r.digestSize),o=new ds(r.multihashCode,r.digestSize,i,s);return[r.version===0?Ke.createV0(o):Ke.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Ii(e.subarray(r));return r+=l,h},s=n(),i=Ti;if(s===18?(s=0,r=0):s===1&&(i=n()),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,s]=k2(e,r),i=Ke.decode(s);return i._baseCache.set(n,e),i}},k2=(t,e)=>{switch(t[0]){case"Q":{let r=e||rr;return[rr.prefix,r.decode(`${rr.prefix}${t}`)]}case rr.prefix:{let r=e||rr;return[rr.prefix,r.decode(t)]}case hs.prefix:{let r=e||hs;return[hs.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},O2=(t,e,r)=>{let{prefix:n}=r;if(n!==rr.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=e.get(n);if(s==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return s},M2=(t,e,r)=>{let{prefix:n}=r,s=e.get(n);if(s==null){let i=r.encode(t);return e.set(n,i),i}else return s},Ti=112,N2=18,g0=(t,e,r)=>{let n=ps(t),s=n+ps(e),i=new Uint8Array(s+r.byteLength);return ls(t,i,0),ls(e,i,n),i.set(r,s),i},y0=Symbol.for("@ipld/js-cid/CID"),Ho={writable:!1,configurable:!1,enumerable:!0},Wo={writable:!1,enumerable:!1,configurable:!1},F2="0.0.0-dev",L2=(t,e)=>{if(t.test(F2))console.warn(e);else throw new Error(e)},U2=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var dc={...Yu,...ec,...tc,...rc,...nc,...sc,...ic,...oc,...ac,...uc},E5={...lc,...pc};function $o(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function m0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?$o(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function D0(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var b0=D0("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),gc=D0("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=m0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),q2={utf8:b0,"utf-8":b0,hex:dc.base16,latin1:gc,ascii:gc,binary:gc,...dc},v0=q2;function w0(t,e="utf8"){let r=v0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?$o(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function x0(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var yg=W(lf(),1),pf=yg.default.Reader,Qw=["uint64","int64","sint64","fixed64","sfixed64"];Qw.forEach(t=>{let e=pf.prototype[t];pf.prototype[t]=function(){return BigInt(e.call(this).toString())}});function Or(t,e){let r=pf.create(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}var mg=W(lf(),1),df=mg.default.Writer,Yw=["uint64","int64","sint64","fixed64","sfixed64"];Yw.forEach(t=>{let e=df.prototype[t];df.prototype[t]=function(r){return e.call(this,r.toString())}});function Mr(t,e){let r=df.create();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var ws;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(ws||(ws={}));function Da(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function gf(t){function e(s){if(t[s.toString()]==null)throw new Error("Invalid enum value");return t[s]}let r=function(i,o){let a=e(i);o.int32(a)},n=function(i){let o=i.uint32();return e(o)};return Da("enum",ws.VARINT,r,n)}function Nr(t,e){return Da("message",ws.LENGTH_DELIMITED,t,e)}var ye;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(ye||(ye={}));var yf;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(yf||(yf={}));(function(t){t.codec=()=>gf(yf)})(ye||(ye={}));var hr;(function(t){let e;t.codec=()=>(e==null&&(e=Nr((r,n,s={})=>{if(s.lengthDelimited!==!1&&n.fork(),r.Type!=null)n.uint32(8),ye.codec().encode(r.Type,n);else throw new Error('Protocol error: required field "Type" was not found in object');if(r.Data!=null)n.uint32(18),n.bytes(r.Data);else throw new Error('Protocol error: required field "Data" was not found in object');s.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let s={Type:ye.RSA,Data:new Uint8Array(0)},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let o=r.uint32();switch(o>>>3){case 1:s.Type=ye.codec().decode(r);break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(s.Type==null)throw new Error('Protocol error: value for required field "Type" was not found in protobuf');if(s.Data==null)throw new Error('Protocol error: value for required field "Data" was not found in protobuf');return s})),e),t.encode=r=>Mr(r,t.codec()),t.decode=r=>Or(r,t.codec())})(hr||(hr={}));var lr;(function(t){let e;t.codec=()=>(e==null&&(e=Nr((r,n,s={})=>{if(s.lengthDelimited!==!1&&n.fork(),r.Type!=null)n.uint32(8),ye.codec().encode(r.Type,n);else throw new Error('Protocol error: required field "Type" was not found in object');if(r.Data!=null)n.uint32(18),n.bytes(r.Data);else throw new Error('Protocol error: required field "Data" was not found in object');s.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let s={Type:ye.RSA,Data:new Uint8Array(0)},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let o=r.uint32();switch(o>>>3){case 1:s.Type=ye.codec().decode(r);break;case 2:s.Data=r.bytes();break;default:r.skipType(o&7);break}}if(s.Type==null)throw new Error('Protocol error: value for required field "Type" was not found in protobuf');if(s.Data==null)throw new Error('Protocol error: value for required field "Data" was not found in protobuf');return s})),e),t.encode=r=>Mr(r,t.codec()),t.decode=r=>Or(r,t.codec())})(lr||(lr={}));var gR=W(Gi(),1),yR=W(Ry(),1),PS=W(he(),1),Ym=W(Le(),1);var Kf={};U(Kf,{identity:()=>T3});function S3(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,D=p.length;m!==D&&p[m]===0;)m++,d++;for(var E=(D-m)*u+1>>>0,w=new Uint8Array(E);m!==D;){for(var b=p[m],x=0,C=E-1;(b!==0||x<y)&&C!==-1;C--,x++)b+=256*w[C]>>>0,w[C]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=x,m++}for(var I=E-y;I!==E&&w[I]===0;)I++;for(var O=c.repeat(d);I<E;++I)O+=t.charAt(w[I]);return O}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===c;)y++,d++;for(var D=(p.length-d)*f+1>>>0,E=new Uint8Array(D);p[d];){var w=r[p.charCodeAt(d)];if(w===255)return;for(var b=0,x=D-1;(w!==0||b<m)&&x!==-1;x--,b++)w+=a*E[x]>>>0,E[x]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var C=D-m;C!==D&&E[C]===0;)C++;for(var I=new Uint8Array(y+(D-C)),O=y;C!==D;)I[O++]=E[C++];return I}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var C3=S3,A3=C3,ky=A3;var c_=new Uint8Array(0);var Oy=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},qr=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var My=t=>new TextEncoder().encode(t),Ny=t=>new TextDecoder().decode(t);var Uf=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},qf=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ly(this,e)}},zf=class{constructor(e){this.decoders=e}or(e){return Ly(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ly=(t,e)=>new zf({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Vf=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Uf(e,r,n),this.decoder=new qf(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Is=({name:t,prefix:e,encode:r,decode:n})=>new Vf(t,e,r,n),ln=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:s}=ky(r,e);return Is({prefix:t,name:e,encode:n,decode:i=>qr(s(i))})},I3=(t,e,r,n)=>{let s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,c=0,f=0;for(let u=0;u<i;++u){let h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},B3=(t,e,r)=>{let n=e[e.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Be=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Is({prefix:e,name:t,encode(s){return B3(s,n,r)},decode(s){return I3(s,n,r,t)}});var T3=Is({prefix:"\0",name:"identity",encode:t=>Ny(t),decode:t=>My(t)});var Gf={};U(Gf,{base2:()=>_3});var _3=Be({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Hf={};U(Hf,{base8:()=>P3});var P3=Be({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Wf={};U(Wf,{base10:()=>R3});var R3=ln({prefix:"9",name:"base10",alphabet:"0123456789"});var $f={};U($f,{base16:()=>k3,base16upper:()=>O3});var k3=Be({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O3=Be({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var jf={};U(jf,{base32:()=>Bs,base32hex:()=>L3,base32hexpad:()=>q3,base32hexpadupper:()=>z3,base32hexupper:()=>U3,base32pad:()=>N3,base32padupper:()=>F3,base32upper:()=>M3,base32z:()=>V3});var Bs=Be({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),M3=Be({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),N3=Be({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),F3=Be({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),L3=Be({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),U3=Be({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),q3=Be({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),z3=Be({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),V3=Be({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Jf={};U(Jf,{base36:()=>K3,base36upper:()=>G3});var K3=ln({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),G3=ln({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Zf={};U(Zf,{base58btc:()=>Nt,base58flickr:()=>H3});var Nt=ln({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),H3=ln({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xf={};U(Xf,{base64:()=>Ua,base64pad:()=>W3,base64url:()=>$3,base64urlpad:()=>j3});var Ua=Be({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),W3=Be({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),$3=Be({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),j3=Be({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Qf={};U(Qf,{base256emoji:()=>Y3});var Uy=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),J3=Uy.reduce((t,e,r)=>(t[r]=e,t),[]),Z3=Uy.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function X3(t){return t.reduce((e,r)=>(e+=J3[r],e),"")}function Q3(t){let e=[];for(let r of t){let n=Z3[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var Y3=Is({prefix:"\u{1F680}",name:"base256emoji",encode:X3,decode:Q3});var rh={};U(rh,{sha256:()=>wt,sha512:()=>bE});var eE=Vy,qy=128,tE=127,rE=~tE,nE=Math.pow(2,31);function Vy(t,e,r){e=e||[],r=r||0;for(var n=r;t>=nE;)e[r++]=t&255|qy,t/=128;for(;t&rE;)e[r++]=t&255|qy,t>>>=7;return e[r]=t|0,Vy.bytes=r-n+1,e}var sE=Yf,iE=128,zy=127;function Yf(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Yf.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&zy)<<s:(o&zy)*Math.pow(2,s),s+=7}while(o>=iE);return Yf.bytes=i-n,r}var oE=Math.pow(2,7),aE=Math.pow(2,14),uE=Math.pow(2,21),cE=Math.pow(2,28),fE=Math.pow(2,35),hE=Math.pow(2,42),lE=Math.pow(2,49),pE=Math.pow(2,56),dE=Math.pow(2,63),gE=function(t){return t<oE?1:t<aE?2:t<uE?3:t<cE?4:t<fE?5:t<hE?6:t<lE?7:t<pE?8:t<dE?9:10},yE={encode:eE,decode:sE,encodingLength:gE},mE=yE,$i=mE;var ji=(t,e=0)=>[$i.decode(t,e),$i.decode.bytes],Ts=(t,e,r=0)=>($i.encode(t,e,r),e),_s=t=>$i.encodingLength(t);var zn=(t,e)=>{let r=e.byteLength,n=_s(t),s=n+_s(r),i=new Uint8Array(s+r);return Ts(t,i,0),Ts(r,i,n),i.set(e,s),new Ps(t,r,e,i)},Ky=t=>{let e=qr(t),[r,n]=ji(e),[s,i]=ji(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new Ps(r,s,o,e)},Gy=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&Oy(t.bytes,e.bytes),Ps=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};var th=({name:t,code:e,encode:r})=>new eh(t,e,r),eh=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?zn(this.code,r):r.then(n=>zn(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Wy=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),wt=th({name:"sha2-256",code:18,encode:Wy("SHA-256")}),bE=th({name:"sha2-512",code:19,encode:Wy("SHA-512")});var sh={};U(sh,{identity:()=>nh});var $y=0,DE="identity",jy=qr,vE=t=>zn($y,jy(t)),nh={code:$y,name:DE,encode:jy,digest:vE};var __=new TextEncoder,P_=new TextDecoder;var Ge=class{constructor(e,r,n,s){this.code=r,this.version=e,this.multihash=n,this.bytes=s,this.byteOffset=s.byteOffset,this.byteLength=s.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:Va,byteLength:Va,code:za,version:za,multihash:za,bytes:za,_baseCache:Va,asCID:Va})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Zi)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==AE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ge.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=zn(e,r);return Ge.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&Gy(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:s}=this;switch(n){case 0:return SE(r,s,e||Nt.encoder);default:return CE(r,s,e||Bs.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return BE(/^0\.0/,TE),!!(e&&(e[Zy]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof Ge)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:s,bytes:i}=e;return new Ge(r,n,s,i||Jy(r,n,s.bytes))}else if(e!=null&&e[Zy]===!0){let{version:r,multihash:n,code:s}=e,i=Ky(n);return Ge.create(r,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Zi)throw new Error(`Version 0 CID must use dag-pb (code: ${Zi}) block encoding`);return new Ge(e,r,n,n.bytes)}case 1:{let s=Jy(e,r,n.bytes);return new Ge(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Ge.create(0,Zi,e)}static createV1(e,r){return Ge.create(1,e,r)}static decode(e){let[r,n]=Ge.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ge.inspectBytes(e),n=r.size-r.multihashSize,s=qr(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=s.subarray(r.multihashSize-r.digestSize),o=new Ps(r.multihashCode,r.digestSize,i,s);return[r.version===0?Ge.createV0(o):Ge.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=ji(e.subarray(r));return r+=l,h},s=n(),i=Zi;if(s===18?(s=0,r=0):s===1&&(i=n()),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,s]=EE(e,r),i=Ge.decode(s);return i._baseCache.set(n,e),i}},EE=(t,e)=>{switch(t[0]){case"Q":{let r=e||Nt;return[Nt.prefix,r.decode(`${Nt.prefix}${t}`)]}case Nt.prefix:{let r=e||Nt;return[Nt.prefix,r.decode(t)]}case Bs.prefix:{let r=e||Bs;return[Bs.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},SE=(t,e,r)=>{let{prefix:n}=r;if(n!==Nt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=e.get(n);if(s==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return s},CE=(t,e,r)=>{let{prefix:n}=r,s=e.get(n);if(s==null){let i=r.encode(t);return e.set(n,i),i}else return s},Zi=112,AE=18,Jy=(t,e,r)=>{let n=_s(t),s=n+_s(e),i=new Uint8Array(s+r.byteLength);return Ts(t,i,0),Ts(e,i,n),i.set(r,s),i},Zy=Symbol.for("@ipld/js-cid/CID"),za={writable:!1,configurable:!1,enumerable:!0},Va={writable:!1,enumerable:!1,configurable:!1},IE="0.0.0-dev",BE=(t,e)=>{if(t.test(IE))console.warn(e);else throw new Error(e)},TE=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var ih={...Kf,...Gf,...Hf,...Wf,...$f,...jf,...Jf,...Zf,...Xf,...Qf},U_={...rh,...sh};function Rs(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Ka(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Rs(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Qy(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Xy=Qy("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),oh=Qy("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Ka(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),_E={utf8:Xy,"utf-8":Xy,hex:ih.base16,latin1:oh,ascii:oh,binary:oh,...ih},Ga=_E;function xt(t,e="utf8"){let r=Ga[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Rs(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var PE=W(Le(),1);function Vn(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));let r=Ka(e),n=0;for(let s of t)r.set(s,n),n+=s.length;return Rs(r)}var pt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var RE=W(Le(),1);var fP=W(Ne(),1),hP=W(Ma(),1),em=W(he(),1);function dt(t,e="utf8"){let r=Ga[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Jt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Vn([new Uint8Array(e-r.length),r])}return dt(r,"base64url")}function Et(t){let e=tm(t);return new em.default.jsbn.BigInteger(dt(e,"base16"),16)}function tm(t,e){let r=xt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Vn([new Uint8Array(e-r.length),r])}return r}function Dr(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var kE={"P-256":256,"P-384":384,"P-521":521},OE=Object.keys(kE),xP=OE.join(" / ");function ah(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,s=t?.digest??"SHA-256",i=t?.saltLength??16,o=t?.iterations??32767,a=pt.get();r*=8;async function c(h,l){let g=a.getRandomValues(new Uint8Array(i)),p=a.getRandomValues(new Uint8Array(n)),d={name:e,iv:p};typeof l=="string"&&(l=xt(l));let y={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},m=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),D=await a.subtle.deriveKey(y,m,{name:e,length:r},!0,["encrypt"]),E=await a.subtle.encrypt(d,D,h);return Vn([g,d.iv,new Uint8Array(E)])}async function f(h,l){let g=h.slice(0,i),p=h.slice(i,i+n),d=h.slice(i+n),y={name:e,iv:p};typeof l=="string"&&(l=xt(l));let m={name:"PBKDF2",salt:g,iterations:o,hash:{name:s}},D=await a.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),E=await a.subtle.deriveKey(m,D,{name:e,length:r},!0,["decrypt"]),w=await a.subtle.decrypt(y,E,d);return new Uint8Array(w)}return{encrypt:c,decrypt:f}}var Dh={};U(Dh,{RsaPrivateKey:()=>qs,RsaPublicKey:()=>no,fromJwk:()=>iS,generateKeyPair:()=>oS,unmarshalRsaPrivateKey:()=>nS,unmarshalRsaPublicKey:()=>sS});var bh=W(Le(),1);var YP=W(am(),1),ro=W(he(),1);var NE=W(Ss(),1);var te=BigInt(0),ve=BigInt(1),pn=BigInt(2),Yi=BigInt(3),FE=BigInt(8),xe=Object.freeze({a:te,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:ve,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});function um(t){let{a:e,b:r}=xe,n=L(t*t),s=L(n*t);return L(s+e*t+r)}var Ha=xe.a===te,$a=class extends Error{constructor(e){super(e)}},ue=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof le))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new ue(e.x,e.y,ve)}static toAffineBatch(e){let r=VE(e.map(n=>n.z));return e.map((n,s)=>n.toAffine(r[s]))}static normalizeZ(e){return ue.toAffineBatch(e).map(ue.fromAffine)}equals(e){if(!(e instanceof ue))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:s}=this,{x:i,y:o,z:a}=e,c=L(s*s),f=L(a*a),u=L(r*f),h=L(i*c),l=L(L(n*a)*f),g=L(L(o*s)*c);return u===h&&l===g}negate(){return new ue(this.x,L(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,s=L(e*e),i=L(r*r),o=L(i*i),a=e+i,c=L(pn*(L(a*a)-s-o)),f=L(Yi*s),u=L(f*f),h=L(u-pn*c),l=L(f*(c-h)-FE*o),g=L(pn*r*n);return new ue(h,l,g)}add(e){if(!(e instanceof ue))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:s}=this,{x:i,y:o,z:a}=e;if(i===te||o===te)return this;if(r===te||n===te)return e;let c=L(s*s),f=L(a*a),u=L(r*f),h=L(i*c),l=L(L(n*a)*f),g=L(L(o*s)*c),p=L(h-u),d=L(g-l);if(p===te)return d===te?this.double():ue.ZERO;let y=L(p*p),m=L(p*y),D=L(u*y),E=L(d*d-m-pn*D),w=L(d*(D-E)-l*m),b=L(s*a*p);return new ue(E,w,b)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=ue.ZERO;if(typeof e=="bigint"&&e===te)return r;let n=hm(e);if(n===ve)return this;if(!Ha){let h=r,l=this;for(;n>te;)n&ve&&(h=h.add(l)),l=l.double(),n>>=ve;return h}let{k1neg:s,k1:i,k2neg:o,k2:a}=pm(n),c=r,f=r,u=this;for(;i>te||a>te;)i&ve&&(c=c.add(u)),a&ve&&(f=f.add(u)),u=u.double(),i>>=ve,a>>=ve;return s&&(c=c.negate()),o&&(f=f.negate()),f=new ue(L(f.x*xe.beta),f.y,f.z),c.add(f)}precomputeWindow(e){let r=Ha?128/e+1:256/e+1,n=[],s=this,i=s;for(let o=0;o<r;o++){i=s,n.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(s),n.push(i);s=i.double()}return n}wNAF(e,r){!r&&this.equals(ue.BASE)&&(r=le.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=r&&hh.get(r);s||(s=this.precomputeWindow(n),r&&n!==1&&(s=ue.normalizeZ(s),hh.set(r,s)));let i=ue.ZERO,o=ue.ZERO,a=1+(Ha?128/n:256/n),c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let g=l*c,p=Number(e&f);if(e>>=h,p>c&&(p-=u,e+=ve),p===0){let d=s[g];l%2&&(d=d.negate()),o=o.add(d)}else{let d=s[g+Math.abs(p)-1];p<0&&(d=d.negate()),i=i.add(d)}}return{p:i,f:o}}multiply(e,r){let n=hm(e),s,i;if(Ha){let{k1neg:o,k1:a,k2neg:c,k2:f}=pm(n),{p:u,f:h}=this.wNAF(a,r),{p:l,f:g}=this.wNAF(f,r);o&&(u=u.negate()),c&&(l=l.negate()),l=new ue(L(l.x*xe.beta),l.y,l.z),s=u.add(l),i=h.add(g)}else{let{p:o,f:a}=this.wNAF(n,r);s=o,i=a}return ue.normalizeZ([s,i])[0]}toAffine(e=Ls(this.z)){let{x:r,y:n,z:s}=this,i=e,o=L(i*i),a=L(o*i),c=L(r*o),f=L(n*a);if(L(s*i)!==ve)throw new Error("invZ was invalid");return new le(c,f)}};ue.BASE=new ue(xe.Gx,xe.Gy,ve);ue.ZERO=new ue(te,ve,te);var hh=new WeakMap,le=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,hh.delete(this)}hasEvenY(){return this.y%pn===te}static fromCompressedHex(e){let r=e.length===32,n=zr(r?e:e.subarray(1));if(!fh(n))throw new Error("Point is not on curve");let s=um(n),i=zE(s),o=(i&ve)===ve;r?o&&(i=L(-i)):(e[0]&1)===1!==o&&(i=L(-i));let a=new le(n,i);return a.assertValidity(),a}static fromUncompressedHex(e){let r=zr(e.subarray(1,33)),n=zr(e.subarray(33,65)),s=new le(r,n);return s.assertValidity(),s}static fromHex(e){let r=Fs(e),n=r.length,s=r[0];if(n===32||n===33&&(s===2||s===3))return this.fromCompressedHex(r);if(n===65&&s===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return le.BASE.multiply(Ja(e))}static fromSignature(e,r,n){e=Fs(e);let s=dm(e),{r:i,s:o}=gm(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");let a=n&1?"03":"02",c=le.fromHex(a+Os(i)),{n:f}=xe,u=Ls(i,f),h=L(-s*u,f),l=L(o*u,f),g=le.BASE.multiplyAndAddUnsafe(c,h,l);if(!g)throw new Error("Cannot recover signature: point at infinify");return g.assertValidity(),g}toRawBytes(e=!1){return Gn(this.toHex(e))}toHex(e=!1){let r=Os(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${Os(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!fh(r)||!fh(n))throw new Error(e);let s=L(n*n),i=um(r);if(L(s-i)!==te)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new le(this.x,L(-this.y))}double(){return ue.fromAffine(this).double().toAffine()}add(e){return ue.fromAffine(this).add(ue.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return ue.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let s=ue.fromAffine(this),i=r===te||r===ve||this!==le.BASE?s.multiplyUnsafe(r):s.multiply(r),o=ue.fromAffine(e).multiplyUnsafe(n),a=i.add(o);return a.equals(ue.ZERO)?void 0:a.toAffine()}};le.BASE=new le(xe.Gx,xe.Gy);le.ZERO=new le(te,te);function cm(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function fm(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${Ns(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:zr(r),left:t.subarray(e+2)}}function LE(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${Ns(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=fm(t.subarray(2)),{data:n,left:s}=fm(r);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${Ns(s)}`);return{r:e,s:n}}var vr=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let s=r?Ns(e):e;if(s.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new vr(ja(s.slice(0,64)),ja(s.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s}=LE(r?e:Gn(e));return new vr(n,s)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!to(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!to(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=xe.n>>ve;return this.s>e}normalizeS(){return this.hasHighS()?new vr(this.r,xe.n-this.s):this}toDERRawBytes(e=!1){return Gn(this.toDERHex(e))}toDERHex(e=!1){let r=cm(Qi(this.s));if(e)return r;let n=cm(Qi(this.r)),s=Qi(n.length/2),i=Qi(r.length/2);return`30${Qi(n.length/2+r.length/2+4)}02${s}${n}02${i}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Gn(this.toCompactHex())}toCompactHex(){return Os(this.r)+Os(this.s)}};function ks(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,s)=>n+s.length,0),r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){let i=t[n];r.set(i,s),s+=i.length}return r}var UE=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ns(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=UE[t[r]];return e}var qE=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Os(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(te<=t&&t<qE))throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function lh(t){let e=Gn(Os(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Qi(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function ja(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Gn(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,s=t.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[r]=i}return e}function zr(t){return ja(Ns(t))}function Fs(t){return t instanceof Uint8Array?Uint8Array.from(t):Gn(t)}function hm(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&to(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function L(t,e=xe.P){let r=t%e;return r>=te?r:e+r}function Ft(t,e){let{P:r}=xe,n=t;for(;e-- >te;)n*=n,n%=r;return n}function zE(t){let{P:e}=xe,r=BigInt(6),n=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),c=t*t*t%e,f=c*c*t%e,u=Ft(f,Yi)*f%e,h=Ft(u,Yi)*f%e,l=Ft(h,pn)*c%e,g=Ft(l,n)*l%e,p=Ft(g,s)*g%e,d=Ft(p,o)*p%e,y=Ft(d,a)*d%e,m=Ft(y,o)*p%e,D=Ft(m,Yi)*f%e,E=Ft(D,i)*g%e,w=Ft(E,r)*c%e;return Ft(w,pn)}function Ls(t,e=xe.P){if(t===te||e<=te)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=L(t,e),n=e,s=te,i=ve,o=ve,a=te;for(;r!==te;){let f=n/r,u=n%r,h=s-o*f,l=i-a*f;n=r,r=u,s=o,i=a,o=h,a=l}if(n!==ve)throw new Error("invert: does not exist");return L(s,e)}function VE(t,e=xe.P){let r=new Array(t.length),n=t.reduce((i,o,a)=>o===te?i:(r[a]=i,L(i*o,e)),ve),s=Ls(n,e);return t.reduceRight((i,o,a)=>o===te?i:(r[a]=L(i*r[a],e),L(i*o,e)),s),r}var lm=(t,e)=>(t+e/pn)/e,KE={a1:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),b1:-ve*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a2:BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),b2:BigInt("0x3086d221a7d46bcde86c90e49284eb15"),POW_2_128:BigInt("0x100000000000000000000000000000000")};function pm(t){let{n:e}=xe,{a1:r,b1:n,a2:s,b2:i,POW_2_128:o}=KE,a=lm(i*t,e),c=lm(-n*t,e),f=L(t-a*r-c*s,e),u=L(-a*n-c*i,e),h=f>o,l=u>o;if(h&&(f=e-f),l&&(u=e-u),f>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:f,k2neg:l,k2:u}}function dm(t){let{n:e}=xe,n=t.length*8-256,s=zr(t);return n>0&&(s=s>>BigInt(n)),s>=e&&(s-=e),s}var Ms,eo,ph=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return Zt.hmacSha256(this.k,...e)}hmacSync(...e){return eo(this.k,...e)}checkSync(){if(typeof eo!="function")throw new $a("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.checkSync(),this.incr(),this.v=this.hmacSync(this.v),this.v}};function to(t){return te<t&&t<xe.n}function fh(t){return te<t&&t<xe.P}function GE(t,e,r){let n=zr(t);if(!to(n))return;let{n:s}=xe,i=le.BASE.multiply(n),o=L(i.x,s);if(o===te)return;let a=L(Ls(n,s)*L(e+r*o,s),s);if(a===te)return;let c=new vr(o,a),f=(i.x===c.r?0:2)|Number(i.y&ve);return{sig:c,recovery:f}}function Ja(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=ja(t)}else if(t instanceof Uint8Array){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=zr(t)}else throw new TypeError("Expected valid private key");if(!to(e))throw new Error("Expected private key: 0 < key < n");return e}function HE(t){return t instanceof le?(t.assertValidity(),t):le.fromHex(t)}function gm(t){if(t instanceof vr)return t.assertValidity(),t;try{return vr.fromDER(t)}catch{return vr.fromCompact(t)}}function dh(t,e=!1){return le.fromPrivateKey(t).toRawBytes(e)}function ym(t){let e=t.length>32?t.slice(0,32):t;return zr(e)}function WE(t){let e=ym(t),r=L(e,xe.n);return mm(r<te?e:r)}function mm(t){return lh(t)}function $E(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=Fs(t),s=Ja(e),i=[mm(s),WE(n)];if(r!=null){r===!0&&(r=Zt.randomBytes(32));let c=Fs(r);if(c.length!==32)throw new Error("sign: Expected 32 bytes of extra data");i.push(c)}let o=ks(...i),a=ym(n);return{seed:o,m:a,d:s}}function jE(t,e){let{sig:r,recovery:n}=t,{canonical:s,der:i,recovered:o}=Object.assign({canonical:!0,der:!0},e);s&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let a=i?r.toDERRawBytes():r.toCompactRawBytes();return o?[a,n]:a}async function bm(t,e,r={}){let{seed:n,m:s,d:i}=$E(t,e,r.extraEntropy),o,a=new ph;for(await a.reseed(n);!(o=GE(await a.generate(),s,i));)await a.reseed();return jE(o,r)}var JE={strict:!0};function Dm(t,e,r,n=JE){let s;try{s=gm(t),e=Fs(e)}catch{return!1}let{r:i,s:o}=s;if(n.strict&&s.hasHighS())return!1;let a=dm(e),c;try{c=HE(r)}catch{return!1}let{n:f}=xe,u=Ls(o,f),h=L(a*u,f),l=L(i*u,f),g=le.BASE.multiplyAndAddUnsafe(c,h,l);return g?L(g.x,f)===i:!1}le.BASE._setWindowSize(8);var St={node:NE,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Wa={},Zt={bytesToHex:Ns,hexToBytes:Gn,concatBytes:ks,mod:L,invert:Ls,isValidPrivateKey(t){try{return Ja(t),!0}catch{return!1}},_bigintTo32Bytes:lh,_normalizePrivateKey:Ja,hashToPrivateKey:t=>{if(t=Fs(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=L(zr(t),xe.n-ve)+ve;return lh(e)},randomBytes:(t=32)=>{if(St.web)return St.web.getRandomValues(new Uint8Array(t));if(St.node){let{randomBytes:e}=St.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Zt.hashToPrivateKey(Zt.randomBytes(40)),sha256:async(...t)=>{if(St.web){let e=await St.web.subtle.digest("SHA-256",ks(...t));return new Uint8Array(e)}else if(St.node){let{createHash:e}=St.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(St.web){let r=await St.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=ks(...e),s=await St.web.subtle.sign("HMAC",r,n);return new Uint8Array(s)}else if(St.node){let{createHmac:r}=St.node,n=r("sha256",t);return e.forEach(s=>n.update(s)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Wa[t];if(r===void 0){let n=await Zt.sha256(Uint8Array.from(t,s=>s.charCodeAt(0)));r=ks(n,n),Wa[t]=r}return Zt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof Ms!="function")throw new $a("sha256Sync is undefined, you need to set it");let r=Wa[t];if(r===void 0){let n=Ms(Uint8Array.from(t,s=>s.charCodeAt(0)));r=ks(n,n),Wa[t]=r}return Ms(r,...e)},precompute(t=8,e=le.BASE){let r=e===le.BASE?e:new le(e.x,e.y);return r._setWindowSize(t),r.multiply(Yi),r}};Object.defineProperties(Zt,{sha256Sync:{configurable:!1,get(){return Ms},set(t){Ms||(Ms=t)}},hmacSha256Sync:{configurable:!1,get(){return eo},set(t){eo||(eo=t)}}});var vm=W(Le(),1);function dn(t){if(isNaN(t)||t<=0)throw(0,vm.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return Zt.randomBytes(t)}var Hn={};U(Hn,{jwkToPkcs1:()=>QE,jwkToPkix:()=>eS,pkcs1ToJwk:()=>XE,pkixToJwk:()=>YE});var MP=W(Gi(),1),NP=W(La(),1),Vr=W(he(),1);var gh=W(Le(),1);function XE(t){let e=Vr.default.asn1.fromDer(dt(t,"ascii")),r=Vr.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Jt(r.n),e:Jt(r.e),d:Jt(r.d),p:Jt(r.p),q:Jt(r.q),dp:Jt(r.dP),dq:Jt(r.dQ),qi:Jt(r.qInv),alg:"RS256"}}function QE(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw(0,gh.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=Vr.default.pki.privateKeyToAsn1({n:Et(t.n),e:Et(t.e),d:Et(t.d),p:Et(t.p),q:Et(t.q),dP:Et(t.dp),dQ:Et(t.dq),qInv:Et(t.qi)});return xt(Vr.default.asn1.toDer(e).getBytes(),"ascii")}function YE(t){let e=Vr.default.asn1.fromDer(dt(t,"ascii")),r=Vr.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Jt(r.n),e:Jt(r.e)}}function eS(t){if(t.n==null||t.e==null)throw(0,gh.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=Vr.default.pki.publicKeyToAsn1({n:Et(t.n),e:Et(t.e)});return xt(Vr.default.asn1.toDer(e).getBytes(),"ascii")}var qP=W(La(),1),yh=W(he(),1);function wm(t,e){return e.map(r=>Et(t[r]))}function xm(t){return yh.default.pki.setRsaPrivateKey(...wm(t,["n","e","d","p","q","dp","dq","qi"]))}function Em(t){return yh.default.pki.setRsaPublicKey(...wm(t,["n","e"]))}var Sm=W(Le(),1);async function Cm(t){let e=await pt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Bm(e);return{privateKey:r[0],publicKey:r[1]}}async function mh(t){let r=[await pt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await tS(t)],n=await Bm({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Am(t,e){let r=await pt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await pt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Im(t,e,r){let n=await pt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await pt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Bm(t){if(t.privateKey==null||t.publicKey==null)throw(0,Sm.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([pt.get().subtle.exportKey("jwk",t.privateKey),pt.get().subtle.exportKey("jwk",t.publicKey)])}async function tS(t){return await pt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Tm(t,e,r,n){let s=e?Em(t):xm(t),i=dt(Uint8Array.from(r),"ascii"),o=n(i,s);return xt(o,"ascii")}function _m(t,e){return Tm(t,!0,e,(r,n)=>n.encrypt(r))}function Pm(t,e){return Tm(t,!1,e,(r,n)=>n.decrypt(r))}async function Us(t,e){let n=await ah().encrypt(t,e);return Ua.encode(n)}var no=class{constructor(e){this._key=e}async verify(e,r){return await Im(this._key,r,e)}marshal(){return Hn.jwkToPkix(this._key)}get bytes(){return hr.encode({Type:ye.RSA,Data:this.marshal()}).subarray()}encrypt(e){return _m(this._key,e)}equals(e){return Dr(this.bytes,e.bytes)}async hash(){let{bytes:e}=await wt.digest(this.bytes);return e}},qs=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return dn(16)}async sign(e){return await Am(this._key,e)}get public(){if(this._publicKey==null)throw(0,bh.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new no(this._publicKey)}decrypt(e){return Pm(this._key,e)}marshal(){return Hn.jwkToPkcs1(this._key)}get bytes(){return lr.encode({Type:ye.RSA,Data:this.marshal()}).subarray()}equals(e){return Dr(this.bytes,e.bytes)}async hash(){let{bytes:e}=await wt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return dt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new ro.default.util.ByteBuffer(this.marshal()),s=ro.default.asn1.fromDer(n),i=ro.default.pki.privateKeyFromAsn1(s),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return ro.default.pki.encryptRsaPrivateKey(i,e,o)}else{if(r==="libp2p-key")return await Us(this.bytes,e);throw(0,bh.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function nS(t){let e=Hn.pkcs1ToJwk(t),r=await mh(e);return new qs(r.privateKey,r.publicKey)}function sS(t){let e=Hn.pkixToJwk(t);return new no(e)}async function iS(t){let e=await mh(t);return new qs(e.privateKey,e.publicKey)}async function oS(t){let e=await Cm(t);return new qs(e.privateKey,e.publicKey)}var Th={};U(Th,{Ed25519PrivateKey:()=>$n,Ed25519PublicKey:()=>uo,generateKeyPair:()=>AS,generateKeyPairFromSeed:()=>Hm,unmarshalEd25519PrivateKey:()=>SS,unmarshalEd25519PublicKey:()=>CS});var Bh=W(Le(),1);var aS=W(Ss(),1);var Ze=BigInt(0),ne=BigInt(1),zs=BigInt(2),Rm=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),Ee=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Rm,n:Rm,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var Nm=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),so=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),tR=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),uS=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),cS=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),fS=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),hS=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),re=class{constructor(e,r,n,s){this.x=e,this.y=r,this.z=n,this.t=s}static fromAffine(e){if(!(e instanceof Se))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Se.ZERO)?re.ZERO:new re(e.x,e.y,ne,T(e.x*e.y))}static toAffineBatch(e){let r=dS(e.map(n=>n.z));return e.map((n,s)=>n.toAffine(r[s]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){km(e);let{x:r,y:n,z:s}=this,{x:i,y:o,z:a}=e,c=T(r*a),f=T(i*s),u=T(n*a),h=T(o*s);return c===f&&u===h}negate(){return new re(T(-this.x),this.y,this.z,T(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:s}=Ee,i=T(e*e),o=T(r*r),a=T(zs*T(n*n)),c=T(s*i),f=e+r,u=T(T(f*f)-i-o),h=c+o,l=h-a,g=c-o,p=T(u*l),d=T(h*g),y=T(u*g),m=T(l*h);return new re(p,d,m,y)}add(e){km(e);let{x:r,y:n,z:s,t:i}=this,{x:o,y:a,z:c,t:f}=e,u=T((n-r)*(a+o)),h=T((n+r)*(a-o)),l=T(h-u);if(l===Ze)return this.double();let g=T(s*zs*f),p=T(i*zs*c),d=p+g,y=h+u,m=p-g,D=T(d*l),E=T(y*m),w=T(d*m),b=T(l*y);return new re(D,E,b,w)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],s=this,i=s;for(let o=0;o<r;o++){i=s,n.push(i);for(let a=1;a<2**(e-1);a++)i=i.add(s),n.push(i);s=i.double()}return n}wNAF(e,r){!r&&this.equals(re.BASE)&&(r=Se.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=r&&Sh.get(r);s||(s=this.precomputeWindow(n),r&&n!==1&&(s=re.normalizeZ(s),Sh.set(r,s)));let i=re.ZERO,o=re.ZERO,a=1+256/n,c=2**(n-1),f=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<a;l++){let g=l*c,p=Number(e&f);if(e>>=h,p>c&&(p-=u,e+=ne),p===0){let d=s[g];l%2&&(d=d.negate()),o=o.add(d)}else{let d=s[g+Math.abs(p)-1];p<0&&(d=d.negate()),i=i.add(d)}}return re.normalizeZ([i,o])[0]}multiply(e,r){return this.wNAF(Xa(e,Ee.l),r)}multiplyUnsafe(e){let r=Xa(e,Ee.l,!1),n=re.BASE,s=re.ZERO;if(r===Ze)return s;if(this.equals(s)||r===ne)return this;if(this.equals(n))return this.wNAF(r);let i=s,o=this;for(;r>Ze;)r&ne&&(i=i.add(o)),o=o.double(),r>>=ne;return i}isSmallOrder(){return this.multiplyUnsafe(Ee.h).equals(re.ZERO)}isTorsionFree(){return this.multiplyUnsafe(Ee.l).equals(re.ZERO)}toAffine(e=Qa(this.z)){let{x:r,y:n,z:s}=this,i=T(r*e),o=T(n*e);if(T(s*e)!==ne)throw new Error("invZ was invalid");return new Se(i,o)}fromRistrettoBytes(){wh()}toRistrettoBytes(){wh()}fromRistrettoHash(){wh()}};re.BASE=new re(Ee.Gx,Ee.Gy,ne,T(Ee.Gx*Ee.Gy));re.ZERO=new re(Ze,ne,ne,Ze);function km(t){if(!(t instanceof re))throw new TypeError("ExtendedPoint expected")}function vh(t){if(!(t instanceof gt))throw new TypeError("RistrettoPoint expected")}function wh(){throw new Error("Legacy method: switch to RistrettoPoint")}var gt=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=Ee,n=T(so*e*e),s=T((n+ne)*fS),i=BigInt(-1),o=T((i-r*n)*T(n+r)),{isValid:a,value:c}=Ah(s,o),f=T(c*e);yn(f)||(f=T(-f)),a||(c=f),a||(i=n);let u=T(i*(n-ne)*hS-o),h=c*c,l=T((c+c)*o),g=T(u*uS),p=T(ne-h),d=T(ne+h);return new re(T(l*d),T(p*g),T(g*d),T(l*p))}static hashToCurve(e){e=mn(e,64);let r=xh(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),s=xh(e.slice(32,64)),i=this.calcElligatorRistrettoMap(s);return new gt(n.add(i))}static fromHex(e){e=mn(e,32);let{a:r,d:n}=Ee,s="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",i=xh(e);if(!yS(io(i),e)||yn(i))throw new Error(s);let o=T(i*i),a=T(ne+r*o),c=T(ne-r*o),f=T(a*a),u=T(c*c),h=T(r*n*f-u),{isValid:l,value:g}=Mm(T(h*u)),p=T(g*c),d=T(g*p*h),y=T((i+i)*p);yn(y)&&(y=T(-y));let m=T(a*d),D=T(y*m);if(!l||yn(D)||m===Ze)throw new Error(s);return new gt(new re(y,m,ne,D))}toRawBytes(){let{x:e,y:r,z:n,t:s}=this.ep,i=T(T(n+r)*T(n-r)),o=T(e*r),a=T(o*o),{value:c}=Mm(T(i*a)),f=T(c*i),u=T(c*o),h=T(f*u*s),l;if(yn(s*h)){let p=T(r*so),d=T(e*so);e=p,r=d,l=T(f*cS)}else l=u;yn(e*h)&&(r=T(-r));let g=T((n-r)*l);return yn(g)&&(g=T(-g)),io(g)}toHex(){return oo(this.toRawBytes())}toString(){return this.toHex()}equals(e){vh(e);let r=this.ep,n=e.ep,s=T(r.x*n.y)===T(r.y*n.x),i=T(r.y*n.y)===T(r.x*n.x);return s||i}add(e){return vh(e),new gt(this.ep.add(e.ep))}subtract(e){return vh(e),new gt(this.ep.subtract(e.ep))}multiply(e){return new gt(this.ep.multiply(e))}multiplyUnsafe(e){return new gt(this.ep.multiplyUnsafe(e))}};gt.BASE=new gt(re.BASE);gt.ZERO=new gt(re.ZERO);var Sh=new WeakMap,Se=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Sh.delete(this)}static fromHex(e,r=!0){let{d:n,P:s}=Ee;e=mn(e,32);let i=e.slice();i[31]=e[31]&-129;let o=ao(i);if(r&&o>=s)throw new Error("Expected 0 < hex < P");if(!r&&o>=Nm)throw new Error("Expected 0 < hex < 2**256");let a=T(o*o),c=T(a-ne),f=T(n*a+ne),{isValid:u,value:h}=Ah(c,f);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&ne)===ne;return(e[31]&128)!==0!==l&&(h=T(-h)),new Se(h,o)}static async fromPrivateKey(e){return(await Ya(e)).point}toRawBytes(){let e=io(this.y);return e[31]|=this.x&ne?128:0,e}toHex(){return oo(this.toRawBytes())}toX25519(){let{y:e}=this,r=T((ne+e)*Qa(ne-e));return io(r)}isTorsionFree(){return re.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Se(T(-this.x),this.y)}add(e){return re.fromAffine(this).add(re.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return re.fromAffine(this).multiply(e,this).toAffine()}};Se.BASE=new Se(Ee.Gx,Ee.Gy);Se.ZERO=new Se(Ze,ne);var Wn=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=mn(e,64),n=Se.fromHex(r.slice(0,32),!1),s=ao(r.slice(32,64));return new Wn(n,s)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof Se))throw new Error("Expected Point instance");return Xa(r,Ee.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(io(this.s),32),e}toHex(){return oo(this.toRawBytes())}};function Om(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,s)=>n+s.length,0),r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){let i=t[n];r.set(i,s),s+=i.length}return r}var lS=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function oo(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=lS[t[r]];return e}function Ch(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,s=t.slice(n,n+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");e[r]=i}return e}function Fm(t){let r=t.toString(16).padStart(64,"0");return Ch(r)}function io(t){return Fm(t).reverse()}function yn(t){return(T(t)&ne)===ne}function ao(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+oo(Uint8Array.from(t).reverse()))}var pS=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function xh(t){return T(ao(t)&pS)}function T(t,e=Ee.P){let r=t%e;return r>=Ze?r:e+r}function Qa(t,e=Ee.P){if(t===Ze||e<=Ze)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=T(t,e),n=e,s=Ze,i=ne,o=ne,a=Ze;for(;r!==Ze;){let f=n/r,u=n%r,h=s-o*f,l=i-a*f;n=r,r=u,s=o,i=a,o=h,a=l}if(n!==ne)throw new Error("invert: does not exist");return T(s,e)}function dS(t,e=Ee.P){let r=new Array(t.length),n=t.reduce((i,o,a)=>o===Ze?i:(r[a]=i,T(i*o,e)),ne),s=Qa(n,e);return t.reduceRight((i,o,a)=>o===Ze?i:(r[a]=T(i*r[a],e),T(i*o,e)),s),r}function wr(t,e){let{P:r}=Ee,n=t;for(;e-- >Ze;)n*=n,n%=r;return n}function gS(t){let{P:e}=Ee,r=BigInt(5),n=BigInt(10),s=BigInt(20),i=BigInt(40),o=BigInt(80),c=t*t%e*t%e,f=wr(c,zs)*c%e,u=wr(f,ne)*t%e,h=wr(u,r)*u%e,l=wr(h,n)*h%e,g=wr(l,s)*l%e,p=wr(g,i)*g%e,d=wr(p,o)*p%e,y=wr(d,o)*p%e,m=wr(y,n)*h%e;return{pow_p_5_8:wr(m,zs)*t%e,b2:c}}function Ah(t,e){let r=T(e*e*e),n=T(r*r*e),s=gS(t*n).pow_p_5_8,i=T(t*r*s),o=T(e*i*i),a=i,c=T(i*so),f=o===t,u=o===T(-t),h=o===T(-t*so);return f&&(i=a),(u||h)&&(i=c),yn(i)&&(i=T(-i)),{isValid:f||u,value:i}}function Mm(t){return Ah(ne,t)}function Za(t){return T(ao(t),Ee.l)}function yS(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function mn(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):Ch(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Xa(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(Ze<t)return t}else if(Ze<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function mS(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function bS(t){if(t=typeof t=="bigint"||typeof t=="number"?Fm(Xa(t,Nm)):mn(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function DS(t){let e=mS(t.slice(0,32)),r=t.slice(32,64),n=Za(e),s=Se.BASE.multiply(n),i=s.toRawBytes();return{head:e,prefix:r,scalar:n,point:s,pointBytes:i}}var Eh;async function Ya(t){return DS(await bn.sha512(bS(t)))}async function Ih(t){return(await Ya(t)).pointBytes}async function Lm(t,e){t=mn(t);let{prefix:r,scalar:n,pointBytes:s}=await Ya(e),i=Za(await bn.sha512(r,t)),o=Se.BASE.multiply(i),a=Za(await bn.sha512(o.toRawBytes(),s,t)),c=T(i+a*n,Ee.l);return new Wn(o,c).toRawBytes()}function vS(t,e,r){e=mn(e),r instanceof Se||(r=Se.fromHex(r,!1));let{r:n,s}=t instanceof Wn?t.assertValidity():Wn.fromHex(t),i=re.BASE.multiplyUnsafe(s);return{r:n,s,SB:i,pub:r,msg:e}}function wS(t,e,r,n){let s=Za(n),i=re.fromAffine(t).multiplyUnsafe(s);return re.fromAffine(e).add(i).subtract(r).multiplyUnsafe(Ee.h).equals(re.ZERO)}async function Um(t,e,r){let{r:n,SB:s,msg:i,pub:o}=vS(t,e,r),a=await bn.sha512(n.toRawBytes(),o.toRawBytes(),i);return wS(o,n,s,a)}Se.BASE._setWindowSize(8);var gn={node:aS,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},bn={bytesToHex:oo,hexToBytes:Ch,concatBytes:Om,getExtendedPublicKey:Ya,mod:T,invert:Qa,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=mn(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return T(ao(t),Ee.l-ne)+ne},randomBytes:(t=32)=>{if(gn.web)return gn.web.getRandomValues(new Uint8Array(t));if(gn.node){let{randomBytes:e}=gn.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>bn.randomBytes(32),sha512:async(...t)=>{let e=Om(...t);if(gn.web){let r=await gn.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(gn.node)return Uint8Array.from(gn.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Se.BASE){let r=e.equals(Se.BASE)?e:new Se(e.x,e.y);return r._setWindowSize(t),r.multiply(zs),r},sha512Sync:void 0};Object.defineProperties(bn,{sha512Sync:{configurable:!1,get(){return Eh},set(t){Eh||(Eh=t)}}});var Vs=32,Kr=64,eu=32;async function qm(){let t=bn.randomPrivateKey(),e=await Ih(t);return{privateKey:Gm(t,e),publicKey:e}}async function zm(t){if(t.length!==eu)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Ih(e);return{privateKey:Gm(e,r),publicKey:r}}async function Vm(t,e){let r=t.slice(0,eu);return await Lm(e,r)}async function Km(t,e,r){return await Um(e,r,t)}function Gm(t,e){let r=new Uint8Array(Kr);for(let n=0;n<eu;n++)r[n]=t[n],r[eu+n]=e[n];return r}var uo=class{constructor(e){this._key=Ks(e,Vs)}async verify(e,r){return await Km(this._key,r,e)}marshal(){return this._key}get bytes(){return hr.encode({Type:ye.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Dr(this.bytes,e.bytes)}async hash(){let{bytes:e}=await wt.digest(this.bytes);return e}},$n=class{constructor(e,r){this._key=Ks(e,Kr),this._publicKey=Ks(r,Vs)}async sign(e){return await Vm(this._key,e)}get public(){return new uo(this._publicKey)}marshal(){return this._key}get bytes(){return lr.encode({Type:ye.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Dr(this.bytes,e.bytes)}async hash(){let{bytes:e}=await wt.digest(this.bytes);return e}async id(){let e=await nh.digest(this.public.bytes);return Nt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await Us(this.bytes,e);throw(0,Bh.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function SS(t){if(t.length>Kr){t=Ks(t,Kr+Vs);let n=t.slice(0,Kr),s=t.slice(Kr,t.length);return new $n(n,s)}t=Ks(t,Kr);let e=t.slice(0,Kr),r=t.slice(Vs);return new $n(e,r)}function CS(t){return t=Ks(t,Vs),new uo(t)}async function AS(){let{privateKey:t,publicKey:e}=await qm();return new $n(t,e)}async function Hm(t){let{privateKey:e,publicKey:r}=await zm(t);return new $n(e,r)}function Ks(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw(0,Bh.default)(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}var Ph={};U(Ph,{Secp256k1PrivateKey:()=>fo,Secp256k1PublicKey:()=>co,generateKeyPair:()=>_S,unmarshalSecp256k1PrivateKey:()=>BS,unmarshalSecp256k1PublicKey:()=>TS});var Qm=W(Le(),1);var Gs=W(Le(),1);function Wm(){return Zt.randomPrivateKey()}async function $m(t,e){let{digest:r}=await wt.digest(e);try{return await bm(r,t)}catch(n){throw(0,Gs.default)(n,"ERR_INVALID_INPUT")}}async function jm(t,e,r){try{let{digest:n}=await wt.digest(r);return Dm(e,n,t)}catch(n){throw(0,Gs.default)(n,"ERR_INVALID_INPUT")}}function Jm(t){return le.fromHex(t).toRawBytes(!0)}function Zm(t){try{dh(t,!0)}catch(e){throw(0,Gs.default)(e,"ERR_INVALID_PRIVATE_KEY")}}function _h(t){try{le.fromHex(t)}catch(e){throw(0,Gs.default)(e,"ERR_INVALID_PUBLIC_KEY")}}function Xm(t){try{return dh(t,!0)}catch(e){throw(0,Gs.default)(e,"ERR_INVALID_PRIVATE_KEY")}}var co=class{constructor(e){_h(e),this._key=e}async verify(e,r){return await jm(this._key,r,e)}marshal(){return Jm(this._key)}get bytes(){return hr.encode({Type:ye.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Dr(this.bytes,e.bytes)}async hash(){let{bytes:e}=await wt.digest(this.bytes);return e}},fo=class{constructor(e,r){this._key=e,this._publicKey=r??Xm(e),Zm(this._key),_h(this._publicKey)}async sign(e){return await $m(this._key,e)}get public(){return new co(this._publicKey)}marshal(){return this._key}get bytes(){return lr.encode({Type:ye.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Dr(this.bytes,e.bytes)}async hash(){let{bytes:e}=await wt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return dt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await Us(this.bytes,e);throw(0,Qm.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function BS(t){return new fo(t)}function TS(t){return new co(t)}async function _S(){let t=await Wm();return new fo(t)}var Dn={rsa:Dh,ed25519:Th,secp256k1:Ph};function Rh(t){let e=Object.keys(Dn).join(" / ");return(0,Ym.default)(new Error(`invalid or unsupported key type ${t}. Must be ${e}`),"ERR_UNSUPPORTED_KEY_TYPE")}function RS(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return Dn[t];throw Rh(t)}function ho(t){let e=hr.decode(t),r=e.Data;switch(e.Type){case ye.RSA:return Dn.rsa.unmarshalRsaPublicKey(r);case ye.Ed25519:return Dn.ed25519.unmarshalEd25519PublicKey(r);case ye.Secp256k1:return Dn.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Rh(e.Type)}}function eb(t,e){return e=(e??"rsa").toLowerCase(),RS(e),t.bytes}async function tu(t){let e=lr.decode(t),r=e.Data;switch(e.Type){case ye.RSA:return await Dn.rsa.unmarshalRsaPrivateKey(r);case ye.Ed25519:return Dn.ed25519.unmarshalEd25519PrivateKey(r);case ye.Secp256k1:return Dn.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Rh(e.Type)}}var tb={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var lo;(function(t){let e;t.codec=()=>(e==null&&(e=Nr((r,n,s={})=>{if(s.lengthDelimited!==!1&&n.fork(),r.publicKey!=null)n.uint32(10),n.bytes(r.publicKey);else throw new Error('Protocol error: required field "publicKey" was not found in object');if(r.payloadType!=null)n.uint32(18),n.bytes(r.payloadType);else throw new Error('Protocol error: required field "payloadType" was not found in object');if(r.payload!=null)n.uint32(26),n.bytes(r.payload);else throw new Error('Protocol error: required field "payload" was not found in object');if(r.signature!=null)n.uint32(42),n.bytes(r.signature);else throw new Error('Protocol error: required field "signature" was not found in object');s.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let s={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let o=r.uint32();switch(o>>>3){case 1:s.publicKey=r.bytes();break;case 2:s.payloadType=r.bytes();break;case 3:s.payload=r.bytes();break;case 5:s.signature=r.bytes();break;default:r.skipType(o&7);break}}if(s.publicKey==null)throw new Error('Protocol error: value for required field "publicKey" was not found in protobuf');if(s.payloadType==null)throw new Error('Protocol error: value for required field "payloadType" was not found in protobuf');if(s.payload==null)throw new Error('Protocol error: value for required field "payload" was not found in protobuf');if(s.signature==null)throw new Error('Protocol error: value for required field "signature" was not found in protobuf');return s})),e),t.encode=r=>Mr(r,t.codec()),t.decode=r=>Or(r,t.codec())})(lo||(lo={}));var OS=sb,rb=128,MS=127,NS=~MS,FS=Math.pow(2,31);function sb(t,e,r){e=e||[],r=r||0;for(var n=r;t>=FS;)e[r++]=t&255|rb,t/=128;for(;t&NS;)e[r++]=t&255|rb,t>>>=7;return e[r]=t|0,sb.bytes=r-n+1,e}var LS=kh,US=128,nb=127;function kh(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw kh.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&nb)<<s:(o&nb)*Math.pow(2,s),s+=7}while(o>=US);return kh.bytes=i-n,r}var qS=Math.pow(2,7),zS=Math.pow(2,14),VS=Math.pow(2,21),KS=Math.pow(2,28),GS=Math.pow(2,35),HS=Math.pow(2,42),WS=Math.pow(2,49),$S=Math.pow(2,56),jS=Math.pow(2,63),JS=function(t){return t<qS?1:t<zS?2:t<VS?3:t<KS?4:t<GS?5:t<HS?6:t<WS?7:t<$S?8:t<jS?9:10},ZS={encode:OS,decode:LS,encodingLength:JS},XS=ZS,po=XS;var go=(t,e=0)=>[po.decode(t,e),po.decode.bytes],Hs=(t,e,r=0)=>(po.encode(t,e,r),e),Ws=t=>po.encodingLength(t);var AR=new Uint8Array(0);var ib=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Gr=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var ob=t=>new TextEncoder().encode(t),ab=t=>new TextDecoder().decode(t);var xr=(t,e)=>{let r=e.byteLength,n=Ws(t),s=n+Ws(r),i=new Uint8Array(s+r);return Hs(t,i,0),Hs(r,i,n),i.set(e,s),new $s(t,r,e,i)},yo=t=>{let e=Gr(t),[r,n]=go(e),[s,i]=go(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new $s(r,s,o,e)},cb=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&ib(t.bytes,e.bytes),$s=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};var Lh={};U(Lh,{base58btc:()=>Ct,base58flickr:()=>nC});function QS(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,D=p.length;m!==D&&p[m]===0;)m++,d++;for(var E=(D-m)*u+1>>>0,w=new Uint8Array(E);m!==D;){for(var b=p[m],x=0,C=E-1;(b!==0||x<y)&&C!==-1;C--,x++)b+=256*w[C]>>>0,w[C]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=x,m++}for(var I=E-y;I!==E&&w[I]===0;)I++;for(var O=c.repeat(d);I<E;++I)O+=t.charAt(w[I]);return O}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===c;)y++,d++;for(var D=(p.length-d)*f+1>>>0,E=new Uint8Array(D);p[d];){var w=r[p.charCodeAt(d)];if(w===255)return;for(var b=0,x=D-1;(w!==0||b<m)&&x!==-1;x--,b++)w+=a*E[x]>>>0,E[x]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var C=D-m;C!==D&&E[C]===0;)C++;for(var I=new Uint8Array(y+(D-C)),O=y;C!==D;)I[O++]=E[C++];return I}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var YS=QS,eC=YS,fb=eC;var Oh=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Mh=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return hb(this,e)}},Nh=class{constructor(e){this.decoders=e}or(e){return hb(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},hb=(t,e)=>new Nh({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Fh=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Oh(e,r,n),this.decoder=new Mh(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Js=({name:t,prefix:e,encode:r,decode:n})=>new Fh(t,e,r,n),vn=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:s}=fb(r,e);return Js({prefix:t,name:e,encode:n,decode:i=>Gr(s(i))})},tC=(t,e,r,n)=>{let s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,c=0,f=0;for(let u=0;u<i;++u){let h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},rC=(t,e,r)=>{let n=e[e.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Te=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Js({prefix:e,name:t,encode(s){return rC(s,n,r)},decode(s){return tC(s,n,r,t)}});var Ct=vn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),nC=vn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Uh={};U(Uh,{base32:()=>Zs,base32hex:()=>aC,base32hexpad:()=>cC,base32hexpadupper:()=>fC,base32hexupper:()=>uC,base32pad:()=>iC,base32padupper:()=>oC,base32upper:()=>sC,base32z:()=>hC});var Zs=Te({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sC=Te({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),iC=Te({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oC=Te({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),aC=Te({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),uC=Te({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cC=Te({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),fC=Te({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hC=Te({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var _e=class{constructor(e,r,n,s){this.code=r,this.version=e,this.multihash=n,this.bytes=s,this.byteOffset=s.byteOffset,this.byteLength=s.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:su,byteLength:su,code:nu,version:nu,multihash:nu,bytes:nu,_baseCache:su,asCID:su})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==mo)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==gC)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return _e.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=xr(e,r);return _e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&cb(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:s}=this;switch(n){case 0:return pC(r,s,e||Ct.encoder);default:return dC(r,s,e||Zs.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return mC(/^0\.0/,bC),!!(e&&(e[pb]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof _e)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:s,bytes:i}=e;return new _e(r,n,s,i||lb(r,n,s.bytes))}else if(e!=null&&e[pb]===!0){let{version:r,multihash:n,code:s}=e,i=yo(n);return _e.create(r,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==mo)throw new Error(`Version 0 CID must use dag-pb (code: ${mo}) block encoding`);return new _e(e,r,n,n.bytes)}case 1:{let s=lb(e,r,n.bytes);return new _e(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return _e.create(0,mo,e)}static createV1(e,r){return _e.create(1,e,r)}static decode(e){let[r,n]=_e.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=_e.inspectBytes(e),n=r.size-r.multihashSize,s=Gr(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=s.subarray(r.multihashSize-r.digestSize),o=new $s(r.multihashCode,r.digestSize,i,s);return[r.version===0?_e.createV0(o):_e.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=go(e.subarray(r));return r+=l,h},s=n(),i=mo;if(s===18?(s=0,r=0):s===1&&(i=n()),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,s]=lC(e,r),i=_e.decode(s);return i._baseCache.set(n,e),i}},lC=(t,e)=>{switch(t[0]){case"Q":{let r=e||Ct;return[Ct.prefix,r.decode(`${Ct.prefix}${t}`)]}case Ct.prefix:{let r=e||Ct;return[Ct.prefix,r.decode(t)]}case Zs.prefix:{let r=e||Zs;return[Zs.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},pC=(t,e,r)=>{let{prefix:n}=r;if(n!==Ct.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=e.get(n);if(s==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return s},dC=(t,e,r)=>{let{prefix:n}=r,s=e.get(n);if(s==null){let i=r.encode(t);return e.set(n,i),i}else return s},mo=112,gC=18,lb=(t,e,r)=>{let n=Ws(t),s=n+Ws(e),i=new Uint8Array(s+r.byteLength);return Hs(t,i,0),Hs(e,i,n),i.set(r,s),i},pb=Symbol.for("@ipld/js-cid/CID"),nu={writable:!1,configurable:!1,enumerable:!0},su={writable:!1,enumerable:!1,configurable:!1},yC="0.0.0-dev",mC=(t,e)=>{if(t.test(yC))console.warn(e);else throw new Error(e)},bC=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var qh={};U(qh,{identity:()=>DC});var DC=Js({prefix:"\0",name:"identity",encode:t=>ab(t),decode:t=>ob(t)});var zh={};U(zh,{base2:()=>vC});var vC=Te({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Vh={};U(Vh,{base8:()=>wC});var wC=Te({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Kh={};U(Kh,{base10:()=>xC});var xC=vn({prefix:"9",name:"base10",alphabet:"0123456789"});var Gh={};U(Gh,{base16:()=>EC,base16upper:()=>SC});var EC=Te({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),SC=Te({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Hh={};U(Hh,{base36:()=>CC,base36upper:()=>AC});var CC=vn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),AC=vn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Wh={};U(Wh,{base64:()=>IC,base64pad:()=>BC,base64url:()=>TC,base64urlpad:()=>_C});var IC=Te({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),BC=Te({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),TC=Te({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_C=Te({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $h={};U($h,{base256emoji:()=>MC});var db=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),PC=db.reduce((t,e,r)=>(t[r]=e,t),[]),RC=db.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function kC(t){return t.reduce((e,r)=>(e+=PC[r],e),"")}function OC(t){let e=[];for(let r of t){let n=RC[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var MC=Js({prefix:"\u{1F680}",name:"base256emoji",encode:kC,decode:OC});var Zh={};U(Zh,{sha256:()=>bo,sha512:()=>NC});var Jh=({name:t,code:e,encode:r})=>new jh(t,e,r),jh=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?xr(this.code,r):r.then(n=>xr(this.code,n))}else throw Error("Unknown type, must be binary type")}};var yb=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),bo=Jh({name:"sha2-256",code:18,encode:yb("SHA-256")}),NC=Jh({name:"sha2-512",code:19,encode:yb("SHA-512")});var Xh={};U(Xh,{identity:()=>Xs});var mb=0,FC="identity",bb=Gr,LC=t=>xr(mb,bb(t)),Xs={code:mb,name:FC,encode:bb,digest:LC};var ZR=new TextEncoder,XR=new TextDecoder;var Qh={...qh,...zh,...Vh,...Kh,...Gh,...Uh,...Hh,...Lh,...Wh,...$h},tk={...Zh,...Xh};function Yh(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var zC=W(Le(),1);var Db=Symbol.for("@libp2p/peer-id");var vb=Object.values(Qh).map(t=>t.decoder).reduce((t,e)=>t.or(e),Qh.identity.decoder),wb=114,el=36,tl=37,Do=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Db](){return!0}toString(){return this.string==null&&(this.string=Ct.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return _e.createV1(wb,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Yh(this.multihash.bytes,e);if(typeof e=="string")return jn(e).equals(this);if(e?.multihash?.bytes!=null)return Yh(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},Qs=class extends Do{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},Ys=class extends Do{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},ei=class extends Do{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function jn(t,e){if(e=e??vb,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=yo(Ct.decode(`z${t}`));return t.startsWith("12D")?new Ys({multihash:r}):t.startsWith("16U")?new ei({multihash:r}):new Qs({multihash:r})}return wn(vb.decode(t))}function wn(t){try{let e=yo(t);if(e.code===Xs.code){if(e.digest.length===el)return new Ys({multihash:e});if(e.digest.length===tl)return new ei({multihash:e})}if(e.code===bo.code)return new Qs({multihash:e})}catch{return VC(_e.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function VC(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==wb)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===bo.code)return new Qs({multihash:t.multihash});if(e.code===Xs.code){if(e.digest.length===el)return new Ys({multihash:t.multihash});if(e.digest.length===tl)return new ei({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function xb(t,e){return t.length===el?new Ys({multihash:xr(Xs.code,t),privateKey:e}):t.length===tl?new ei({multihash:xr(Xs.code,t),privateKey:e}):new Qs({multihash:await bo.digest(t),publicKey:t,privateKey:e})}function vo(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Hr(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.alloc!=null?vo(globalThis.Buffer.alloc(t)):new Uint8Array(t)}function wo(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?vo(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function rl(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));let r=wo(e),n=0;for(let s of t)r.set(s,n),n+=s.length;return vo(r)}function Eb(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Cb=Symbol.for("@achingbrain/uint8arraylist");function Sb(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let s=r+n.byteLength;if(e<s)return{buf:n,index:e-r};r=s}throw new RangeError("index is out of bounds")}function nl(t){return Boolean(t?.[Cb])}var Lt=class{constructor(...e){Object.defineProperty(this,Cb,{value:!0}),this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(nl(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(nl(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=Sb(this.bufs,e);return r.buf[r.index]}set(e,r){let n=Sb(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(nl(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}slice(e,r){let{bufs:n,length:s}=this._subList(e,r);return rl(n,s)}subarray(e,r){let{bufs:n,length:s}=this._subList(e,r);return n.length===1?n[0]:rl(n,s)}sublist(e,r){let{bufs:n,length:s}=this._subList(e,r),i=new Lt;return i.length=s,i.bufs=n,i}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],s=0;for(let i=0;i<this.bufs.length;i++){let o=this.bufs[i],a=s,c=a+o.byteLength;if(s=c,e>=c)continue;let f=e>=a&&e<c,u=r>a&&r<=c;if(f&&u){if(e===a&&r===c){n.push(o);break}let h=e-a;n.push(o.subarray(h,h+(r-e)));break}if(f){if(e===0){n.push(o);continue}n.push(o.subarray(e-a));continue}if(u){if(r===c){n.push(o);break}n.push(o.subarray(0,r-a));break}n.push(o)}return{bufs:n,length:r-e}}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=wo(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let s=Hr(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt16(0,r,n),this.write(s,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let s=Hr(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setInt32(0,r,n),this.write(s,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let s=Hr(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigInt64(0,r,n),this.write(s,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=wo(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let s=Hr(2);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint16(0,r,n),this.write(s,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let s=Hr(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setUint32(0,r,n),this.write(s,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let s=Hr(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setBigUint64(0,r,n),this.write(s,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let s=Hr(4);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat32(0,r,n),this.write(s,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let s=Hr(8);new DataView(s.buffer,s.byteOffset,s.byteLength).setFloat64(0,r,n),this.write(s,e)}equals(e){if(e==null||!(e instanceof Lt)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Eb(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new Lt;return n.bufs=e,r==null&&(r=e.reduce((s,i)=>s+i.byteLength,0)),n.length=r,n}};function iu(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}var Ab=4294967296,At=class{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(e){return Number(this.toBigInt(e))}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new At(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new At(r,n)}toBytes(e,r=0){let n=iu(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new At;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,s=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,s=~s>>>0,++s>Ab&&(s=0,++n>Ab&&(n=0))),new At(n,s)}static fromNumber(e){if(e===0)return new At;let r=e<0;r&&(e=-e);let n=e>>>0,s=(e-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new At(s,n)}static fromBytes(e,r=0){let n=iu(e),s=new At,i=0;if(e.length-r>4){for(;i<4;++i)if(s.lo=(s.lo|(n.get(r)&127)<<i*7)>>>0,n.get(r++)<128)return s;if(s.lo=(s.lo|(n.get(r)&127)<<28)>>>0,s.hi=(s.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return s;i=0}else for(;i<4;++i){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(s.lo=(s.lo|(n.get(r)&127)<<i*7)>>>0,n.get(r++)<128)return s}if(e.length-r>4){for(;i<5;++i)if(s.hi=(s.hi|(n.get(r)&127)<<i*7+3)>>>0,n.get(r++)<128)return s}else if(r<e.byteLength)for(;i<5;++i){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(s.hi=(s.hi|(n.get(r)&127)<<i*7+3)>>>0,n.get(r++)<128)return s}throw RangeError("invalid varint encoding")}};function Ib(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Bb(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Ib(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}var KC=Math.pow(2,7),GC=Math.pow(2,14),HC=Math.pow(2,21),WC=Math.pow(2,28),$C=Math.pow(2,35),jC=Math.pow(2,42),JC=Math.pow(2,49),ZC=Math.pow(2,56),XC=Math.pow(2,63),Xt={encodingLength(t){return t<KC?1:t<GC?2:t<HC?3:t<WC?4:t<$C?5:t<jC?6:t<JC?7:t<ZC?8:t<XC?9:10},encode(t,e,r=0){if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return e==null&&(e=Bb(Xt.encodingLength(t))),At.fromNumber(t).toBytes(e,r),e},decode(t,e=0){return At.fromBytes(t,e).toNumber(!0)}};var QC,Ut=class{constructor(e){let{peerId:r,payloadType:n,payload:s,signature:i}=e;this.peerId=r,this.payloadType=n,this.payload=s,this.signature=i}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=lo.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(e){return x0(this.marshal(),e.marshal())}async validate(e){let r=_b(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await ho(this.peerId.publicKey).verify(r.subarray(),this.signature)}};QC=Ut;Ut.createFromProtobuf=async t=>{let e=lo.decode(t),r=await xb(e.publicKey);return new Ut({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};Ut.seal=async(t,e)=>{if(e.privateKey==null)throw new Error("Missing private key");let r=t.domain,n=t.codec,s=t.marshal(),i=_b(r,n,s),a=await(await tu(e.privateKey)).sign(i.subarray());return new Ut({peerId:e,payloadType:n,payload:s,signature:a})};Ut.openAndCertify=async(t,e)=>{let r=await Ut.createFromProtobuf(t);if(!await r.validate(e))throw(0,Tb.default)(new Error("envelope signature is not valid for the given domain"),tb.ERR_SIGNATURE_NOT_VALID);return r};var _b=(t,e,r)=>{let n=w0(t),s=Xt.encode(n.byteLength),i=Xt.encode(e.length),o=Xt.encode(r.length);return new Lt(s,n,i,e,o,r)};var Pb="[a-fA-F\\d:]",xn=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${Pb})|(?<=${Pb})(?=\\s|$))`:"",Qt="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",qe="[a-fA-F\\d]{1,4}",ou=`
(?:
(?:${qe}:){7}(?:${qe}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${qe}:){6}(?:${Qt}|:${qe}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${qe}:){5}(?::${Qt}|(?::${qe}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${qe}:){4}(?:(?::${qe}){0,1}:${Qt}|(?::${qe}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${qe}:){3}(?:(?::${qe}){0,2}:${Qt}|(?::${qe}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${qe}:){2}(?:(?::${qe}){0,3}:${Qt}|(?::${qe}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${qe}:){1}(?:(?::${qe}){0,4}:${Qt}|(?::${qe}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${qe}){0,5}:${Qt}|(?::${qe}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),YC=new RegExp(`(?:^${Qt}$)|(?:^${ou}$)`),e4=new RegExp(`^${Qt}$`),t4=new RegExp(`^${ou}$`),sl=t=>t&&t.exact?YC:new RegExp(`(?:${xn(t)}${Qt}${xn(t)})|(?:${xn(t)}${ou}${xn(t)})`,"g");sl.v4=t=>t&&t.exact?e4:new RegExp(`${xn(t)}${Qt}${xn(t)}`,"g");sl.v6=t=>t&&t.exact?t4:new RegExp(`${xn(t)}${ou}${xn(t)}`,"g");var au=sl;function il(t){let e=(...r)=>t(...r);return Object.defineProperty(e,"name",{value:`functionTimeout(${t.name||"<anonymous>"})`,configurable:!0}),e}function Rb(){return!1}var{toString:r4}=Object.prototype;function ol(t){return r4.call(t)==="[object RegExp]"}var kb={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function al(t,e={}){if(!ol(t))throw new TypeError("Expected a RegExp instance");let r=Object.keys(kb).map(s=>(typeof e[s]=="boolean"?e[s]:t[s])?kb[s]:"").join(""),n=new RegExp(e.source||t.source,r);return n.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:t.lastIndex,n}function uu(t,e,{timeout:r}={}){try{return il(()=>al(t).test(e),{timeout:r})()}catch(n){if(Rb(n))return!1;throw n}}var n4=15,Ob=45,ul={timeout:400};function cu(t){return uu(au({exact:!0}),t.slice(0,Ob),ul)}function Mb(t){return uu(au.v6({exact:!0}),t.slice(0,Ob),ul)}function Nb(t){return uu(au.v4({exact:!0}),t.slice(0,n4),ul)}var pl={};U(pl,{identity:()=>c4});function s4(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,D=p.length;m!==D&&p[m]===0;)m++,d++;for(var E=(D-m)*u+1>>>0,w=new Uint8Array(E);m!==D;){for(var b=p[m],x=0,C=E-1;(b!==0||x<y)&&C!==-1;C--,x++)b+=256*w[C]>>>0,w[C]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=x,m++}for(var I=E-y;I!==E&&w[I]===0;)I++;for(var O=c.repeat(d);I<E;++I)O+=t.charAt(w[I]);return O}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===c;)y++,d++;for(var D=(p.length-d)*f+1>>>0,E=new Uint8Array(D);p[d];){var w=r[p.charCodeAt(d)];if(w===255)return;for(var b=0,x=D-1;(w!==0||b<m)&&x!==-1;x--,b++)w+=a*E[x]>>>0,E[x]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var C=D-m;C!==D&&E[C]===0;)C++;for(var I=new Uint8Array(y+(D-C)),O=y;C!==D;)I[O++]=E[C++];return I}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var i4=s4,o4=i4,Fb=o4;var nO=new Uint8Array(0);var Lb=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Wr=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Ub=t=>new TextEncoder().encode(t),qb=t=>new TextDecoder().decode(t);var cl=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},fl=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Vb(this,e)}},hl=class{constructor(e){this.decoders=e}or(e){return Vb(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Vb=(t,e)=>new hl({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),ll=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new cl(e,r,n),this.decoder=new fl(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ti=({name:t,prefix:e,encode:r,decode:n})=>new ll(t,e,r,n),En=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:s}=Fb(r,e);return ti({prefix:t,name:e,encode:n,decode:i=>Wr(s(i))})},a4=(t,e,r,n)=>{let s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,c=0,f=0;for(let u=0;u<i;++u){let h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},u4=(t,e,r)=>{let n=e[e.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Pe=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ti({prefix:e,name:t,encode(s){return u4(s,n,r)},decode(s){return a4(s,n,r,t)}});var c4=ti({prefix:"\0",name:"identity",encode:t=>qb(t),decode:t=>Ub(t)});var dl={};U(dl,{base2:()=>f4});var f4=Pe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var gl={};U(gl,{base8:()=>h4});var h4=Pe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var yl={};U(yl,{base10:()=>l4});var l4=En({prefix:"9",name:"base10",alphabet:"0123456789"});var ml={};U(ml,{base16:()=>p4,base16upper:()=>d4});var p4=Pe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),d4=Pe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var bl={};U(bl,{base32:()=>$r,base32hex:()=>b4,base32hexpad:()=>v4,base32hexpadupper:()=>w4,base32hexupper:()=>D4,base32pad:()=>y4,base32padupper:()=>m4,base32upper:()=>g4,base32z:()=>x4});var $r=Pe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),g4=Pe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),y4=Pe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),m4=Pe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),b4=Pe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),D4=Pe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),v4=Pe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),w4=Pe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),x4=Pe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Dl={};U(Dl,{base36:()=>E4,base36upper:()=>S4});var E4=En({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),S4=En({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var vl={};U(vl,{base58btc:()=>yt,base58flickr:()=>C4});var yt=En({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),C4=En({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var wl={};U(wl,{base64:()=>A4,base64pad:()=>I4,base64url:()=>B4,base64urlpad:()=>T4});var A4=Pe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),I4=Pe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),B4=Pe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),T4=Pe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var xl={};U(xl,{base256emoji:()=>O4});var Kb=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),_4=Kb.reduce((t,e,r)=>(t[r]=e,t),[]),P4=Kb.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function R4(t){return t.reduce((e,r)=>(e+=_4[r],e),"")}function k4(t){let e=[];for(let r of t){let n=P4[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var O4=ti({prefix:"\u{1F680}",name:"base256emoji",encode:R4,decode:k4});var Al={};U(Al,{sha256:()=>Y4,sha512:()=>eA});var M4=Wb,Gb=128,N4=127,F4=~N4,L4=Math.pow(2,31);function Wb(t,e,r){e=e||[],r=r||0;for(var n=r;t>=L4;)e[r++]=t&255|Gb,t/=128;for(;t&F4;)e[r++]=t&255|Gb,t>>>=7;return e[r]=t|0,Wb.bytes=r-n+1,e}var U4=El,q4=128,Hb=127;function El(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw El.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&Hb)<<s:(o&Hb)*Math.pow(2,s),s+=7}while(o>=q4);return El.bytes=i-n,r}var z4=Math.pow(2,7),V4=Math.pow(2,14),K4=Math.pow(2,21),G4=Math.pow(2,28),H4=Math.pow(2,35),W4=Math.pow(2,42),$4=Math.pow(2,49),j4=Math.pow(2,56),J4=Math.pow(2,63),Z4=function(t){return t<z4?1:t<V4?2:t<K4?3:t<G4?4:t<H4?5:t<W4?6:t<$4?7:t<j4?8:t<J4?9:10},X4={encode:M4,decode:U4,encodingLength:Z4},Q4=X4,xo=Q4;var Eo=(t,e=0)=>[xo.decode(t,e),xo.decode.bytes],ri=(t,e,r=0)=>(xo.encode(t,e,r),e),ni=t=>xo.encodingLength(t);var Jn=(t,e)=>{let r=e.byteLength,n=ni(t),s=n+ni(r),i=new Uint8Array(s+r);return ri(t,i,0),ri(r,i,n),i.set(e,s),new si(t,r,e,i)},hu=t=>{let e=Wr(t),[r,n]=Eo(e),[s,i]=Eo(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new si(r,s,o,e)},$b=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&Lb(t.bytes,e.bytes),si=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};var Cl=({name:t,code:e,encode:r})=>new Sl(t,e,r),Sl=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Jn(this.code,r):r.then(n=>Jn(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Jb=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Y4=Cl({name:"sha2-256",code:18,encode:Jb("SHA-256")}),eA=Cl({name:"sha2-512",code:19,encode:Jb("SHA-512")});var Il={};U(Il,{identity:()=>nA});var Zb=0,tA="identity",Xb=Wr,rA=t=>Jn(Zb,Xb(t)),nA={code:Zb,name:tA,encode:Xb,digest:rA};var SO=new TextEncoder,CO=new TextDecoder;var Ce=class{constructor(e,r,n,s){this.code=r,this.version=e,this.multihash=n,this.bytes=s,this.byteOffset=s.byteOffset,this.byteLength=s.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:pu,byteLength:pu,code:lu,version:lu,multihash:lu,bytes:lu,_baseCache:pu,asCID:pu})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==So)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==cA)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ce.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Jn(e,r);return Ce.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&$b(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:s}=this;switch(n){case 0:return aA(r,s,e||yt.encoder);default:return uA(r,s,e||$r.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return hA(/^0\.0/,lA),!!(e&&(e[Yb]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof Ce)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:s,bytes:i}=e;return new Ce(r,n,s,i||Qb(r,n,s.bytes))}else if(e!=null&&e[Yb]===!0){let{version:r,multihash:n,code:s}=e,i=hu(n);return Ce.create(r,s,i)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==So)throw new Error(`Version 0 CID must use dag-pb (code: ${So}) block encoding`);return new Ce(e,r,n,n.bytes)}case 1:{let s=Qb(e,r,n.bytes);return new Ce(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Ce.create(0,So,e)}static createV1(e,r){return Ce.create(1,e,r)}static decode(e){let[r,n]=Ce.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ce.inspectBytes(e),n=r.size-r.multihashSize,s=Wr(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=s.subarray(r.multihashSize-r.digestSize),o=new si(r.multihashCode,r.digestSize,i,s);return[r.version===0?Ce.createV0(o):Ce.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Eo(e.subarray(r));return r+=l,h},s=n(),i=So;if(s===18?(s=0,r=0):s===1&&(i=n()),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,s]=oA(e,r),i=Ce.decode(s);return i._baseCache.set(n,e),i}},oA=(t,e)=>{switch(t[0]){case"Q":{let r=e||yt;return[yt.prefix,r.decode(`${yt.prefix}${t}`)]}case yt.prefix:{let r=e||yt;return[yt.prefix,r.decode(t)]}case $r.prefix:{let r=e||$r;return[$r.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},aA=(t,e,r)=>{let{prefix:n}=r;if(n!==yt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=e.get(n);if(s==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return s},uA=(t,e,r)=>{let{prefix:n}=r,s=e.get(n);if(s==null){let i=r.encode(t);return e.set(n,i),i}else return s},So=112,cA=18,Qb=(t,e,r)=>{let n=ni(t),s=n+ni(e),i=new Uint8Array(s+r.byteLength);return ri(t,i,0),ri(e,i,n),i.set(r,s),i},Yb=Symbol.for("@ipld/js-cid/CID"),lu={writable:!1,configurable:!1,enumerable:!0},pu={writable:!1,enumerable:!1,configurable:!1},fA="0.0.0-dev",hA=(t,e)=>{if(t.test(fA))console.warn(e);else throw new Error(e)},lA=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var Co={...pl,...dl,...gl,...yl,...ml,...bl,...Dl,...vl,...wl,...xl},kO={...Al,...Il};function oi(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function du(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?oi(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function tD(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var eD=tD("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Bl=tD("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=du(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),pA={utf8:eD,"utf-8":eD,hex:Co.base16,latin1:Bl,ascii:Bl,binary:Bl,...Co},gu=pA;function it(t,e="utf8"){let r=gu[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var rD=Nb,dA=Mb,Tl=function(t){let e=0;if(t=t.toString().trim(),rD(t)){let r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(dA(t)){let r=t.split(":",8),n;for(n=0;n<r.length;n++){let i=rD(r[n]),o;i&&(o=Tl(r[n]),r[n]=it(o.slice(0,2),"base16")),o!=null&&++n<8&&r.splice(n,0,it(o.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let i=[n,1];for(n=9-r.length;n>0;n--)i.push("0");r.splice.apply(r,i)}let s=new Uint8Array(e+16);for(n=0;n<r.length;n++){let i=parseInt(r[n],16);s[e++]=i>>8&255,s[e++]=i&255}return s}throw new Error("invalid ip address")},nD=function(t,e=0,r){e=~~e,r=r??t.length-e;let n=new DataView(t.buffer);if(r===4){let s=[];for(let i=0;i<r;i++)s.push(t[e+i]);return s.join(".")}if(r===16){let s=[];for(let i=0;i<r;i+=2)s.push(n.getUint16(e+i).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Ao={},_l={},yA=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];yA.forEach(t=>{let e=mA(...t);_l[e.code]=e,Ao[e.name]=e});function mA(t,e,r,n,s){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(s)}}function ze(t){if(typeof t=="number"){if(_l[t]!=null)return _l[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(Ao[t]!=null)return Ao[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}var Er=W(yu(),1);function kl(t,e="utf8"){let r=gu[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?oi(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function jr(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));let r=du(e),n=0;for(let s of t)r.set(s,n),n+=s.length;return oi(r)}function mu(t,e){switch(ze(t).code){case 4:case 41:return RA(e);case 6:case 273:case 33:case 132:return yD(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return OA(e);case 421:return LA(e);case 444:return dD(e);case 445:return dD(e);case 466:return FA(e);default:return it(e,"base16")}}function gD(t,e){switch(ze(t).code){case 4:return pD(e);case 41:return pD(e);case 6:case 273:case 33:case 132:return Ml(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return kA(e);case 421:return MA(e);case 444:return UA(e);case 445:return qA(e);case 466:return NA(e);default:return kl(e,"base16")}}var Ol=Object.values(Co).map(t=>t.decoder),PA=function(){let t=Ol[0].or(Ol[1]);return Ol.slice(2).forEach(e=>t=t.or(e)),t}();function pD(t){if(!cu(t))throw new Error("invalid ip address");return Tl(t)}function RA(t){let e=nD(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!cu(e))throw new Error("invalid ip address");return e}function Ml(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function yD(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function kA(t){let e=kl(t),r=Uint8Array.from(Er.default.encode(e.length));return jr([r,e],r.length+e.length)}function OA(t){let e=Er.default.decode(t);if(t=t.slice(Er.default.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return it(t)}function MA(t){let e;t[0]==="Q"||t[0]==="1"?e=hu(yt.decode(`z${t}`)).bytes:e=Ce.parse(t).multihash.bytes;let r=Uint8Array.from(Er.default.encode(e.length));return jr([r,e],r.length+e.length)}function NA(t){let e=PA.decode(t),r=Uint8Array.from(Er.default.encode(e.length));return jr([r,e],r.length+e.length)}function FA(t){let e=Er.default.decode(t),r=t.slice(Er.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return"u"+it(r,"base64url")}function LA(t){let e=Er.default.decode(t),r=t.slice(Er.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return it(r,"base58btc")}function UA(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=$r.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let s=Ml(n);return jr([r,s],r.length+s.length)}function qA(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=$r.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let s=Ml(n);return jr([r,s],r.length+s.length)}function dD(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=it(e,"base32"),s=yD(r);return`${n}:${s}`}var ai=W(yu(),1);function zA(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let s=r[n],i=ze(s);if(i.size===0){e.push([s]);continue}if(n++,n>=r.length)throw bD("invalid address: "+t);if(i.path===!0){e.push([s,ql(r.slice(n).join("/"))]);break}e.push([s,r[n]])}return e}function VA(t){let e=[];return t.map(r=>{let n=vu(r);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),ql(e.join("/"))}function KA(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=vu(e);return e.length>1?[r.code,gD(r.code,e[1])]:[r.code]})}function Nl(t){return t.map(e=>{let r=vu(e);return e[1]!=null?[r.code,mu(r.code,e[1])]:[r.code]})}function Fl(t){return Du(jr(t.map(e=>{let r=vu(e),n=Uint8Array.from(ai.default.encode(r.code));return e.length>1&&e[1]!=null&&(n=jr([n,e[1]])),n})))}function Ll(t,e){return t.size>0?t.size/8:t.size===0?0:ai.default.decode(e)+ai.default.decode.bytes}function bu(t){let e=[],r=0;for(;r<t.length;){let n=ai.default.decode(t,r),s=ai.default.decode.bytes,i=ze(n),o=Ll(i,t.slice(r+s));if(o===0){e.push([n]),r+=s;continue}let a=t.slice(r+s,r+s+o);if(r+=o+s,r>t.length)throw bD("Invalid address Uint8Array: "+it(t,"base16"));e.push([n,a])}return e}function Ul(t){let e=bu(t),r=Nl(e);return VA(r)}function GA(t){t=ql(t);let e=zA(t),r=KA(e);return Fl(r)}function mD(t){return GA(t)}function Du(t){let e=HA(t);if(e!=null)throw e;return Uint8Array.from(t)}function HA(t){try{bu(t)}catch(e){return e}}function ql(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function bD(t){return new Error("Error parsing address: "+t)}function vu(t){return ze(t[0])}var zl=W(yu(),1);var xD=W(Le(),1);function DD(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var vD,$A=Symbol.for("nodejs.util.inspect.custom"),wD=[ze("dns").code,ze("dns4").code,ze("dns6").code,ze("dnsaddr").code],jA=[ze("p2p").code,ze("ipfs").code],JA=new Map,ED=Symbol.for("@multiformats/js-multiaddr/multiaddr");function ZA(t){return Boolean(t?.[ED])}var Jr=class{constructor(e){if(this[vD]=!0,e==null&&(e=""),e instanceof Uint8Array)this.bytes=Du(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=mD(e)}else if(ZA(e))this.bytes=Du(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return this._string==null&&(this._string=Ul(this.bytes)),this._string}toJSON(){return this.toString()}toOptions(){let e=this.protoCodes(),r=this.toString().split("/").slice(1),n,s;if(r.length>2)wD.includes(e[0])&&jA.includes(e[1])?(n=ze("tcp").name,s=443):(n=ze(r[2]).name,s=parseInt(r[3]));else if(wD.includes(e[0]))n=ze("tcp").name,s=443;else throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e[0]===41||e[0]===55?6:4,host:r[1],transport:n,port:s}}protos(){return this.protoCodes().map(e=>Object.assign({},ze(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let s=zl.default.decode(r,n),i=zl.default.decode.bytes,o=ze(s);n+=Ll(o,r.slice(n+i))+i,e.push(s)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return this._tuples==null&&(this._tuples=bu(this.bytes)),this._tuples}stringTuples(){return this._stringTuples==null&&(this._stringTuples=Nl(this.tuples())),this._stringTuples}encapsulate(e){return e=new Jr(e),new Jr(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),s=n.lastIndexOf(r);if(s<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new Jr(n.slice(0,s))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new Jr(Fl(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===Ao.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?it(yt.decode(`z${n}`),"base58btc"):it(Ce.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>ze(r[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return DD(this.bytes,e.bytes)}async resolve(e){let r=this.protos().find(i=>i.resolvable);if(r==null)return[this];let n=JA.get(r.name);if(n==null)throw(0,xD.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,e)).map(i=>new Jr(i))}nodeAddress(){let e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(vD=ED,$A)](){return this.inspect()}inspect(){return"<Multiaddr "+it(this.bytes,"base16")+" - "+Ul(this.bytes)+">"}};function SD(t){return new Jr(t)}function CD(t,e){let r=(n,s)=>n.toString().localeCompare(s.toString());return t.length!==e.length?!1:(e.sort(r),t.sort(r).every((n,s)=>e[s].equals(n)))}var Io;(function(t){let e;(function(n){let s;n.codec=()=>(s==null&&(s=Nr((i,o,a={})=>{if(a.lengthDelimited!==!1&&o.fork(),i.multiaddr!=null)o.uint32(10),o.bytes(i.multiaddr);else throw new Error('Protocol error: required field "multiaddr" was not found in object');a.lengthDelimited!==!1&&o.ldelim()},(i,o)=>{let a={multiaddr:new Uint8Array(0)},c=o==null?i.len:i.pos+o;for(;i.pos<c;){let f=i.uint32();switch(f>>>3){case 1:a.multiaddr=i.bytes();break;default:i.skipType(f&7);break}}if(a.multiaddr==null)throw new Error('Protocol error: value for required field "multiaddr" was not found in protobuf');return a})),s),n.encode=i=>Mr(i,n.codec()),n.decode=i=>Or(i,n.codec())})(e=t.AddressInfo||(t.AddressInfo={}));let r;t.codec=()=>(r==null&&(r=Nr((n,s,i={})=>{if(i.lengthDelimited!==!1&&s.fork(),n.peerId!=null)s.uint32(10),s.bytes(n.peerId);else throw new Error('Protocol error: required field "peerId" was not found in object');if(n.seq!=null)s.uint32(16),s.uint64(n.seq);else throw new Error('Protocol error: required field "seq" was not found in object');if(n.addresses!=null)for(let o of n.addresses)s.uint32(26),t.AddressInfo.codec().encode(o,s);else throw new Error('Protocol error: required field "addresses" was not found in object');i.lengthDelimited!==!1&&s.ldelim()},(n,s)=>{let i={peerId:new Uint8Array(0),seq:0n,addresses:[]},o=s==null?n.len:n.pos+s;for(;n.pos<o;){let a=n.uint32();switch(a>>>3){case 1:i.peerId=n.bytes();break;case 2:i.seq=n.uint64();break;case 3:i.addresses.push(t.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(a&7);break}}if(i.peerId==null)throw new Error('Protocol error: value for required field "peerId" was not found in protobuf');if(i.seq==null)throw new Error('Protocol error: value for required field "seq" was not found in protobuf');return i})),r),t.encode=n=>Mr(n,t.codec()),t.decode=n=>Or(n,t.codec())})(Io||(Io={}));var AD="libp2p-peer-record",ID=Uint8Array.from([3,1]);var Yt=class{constructor(e){this.domain=Yt.DOMAIN,this.codec=Yt.CODEC;let{peerId:r,multiaddrs:n,seqNumber:s}=e;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=s??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=Io.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof Yt)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!CD(this.multiaddrs,e.multiaddrs))}};Yt.createFromProtobuf=t=>{let e=Io.decode(t),r=wn(e.peerId),n=(e.addresses??[]).map(i=>SD(i.multiaddr)),s=e.seq;return new Yt({peerId:r,multiaddrs:n,seqNumber:s})};Yt.DOMAIN=AD;Yt.CODEC=ID;var Sr=W(RD(),1);function cI(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,D=p.length;m!==D&&p[m]===0;)m++,d++;for(var E=(D-m)*u+1>>>0,w=new Uint8Array(E);m!==D;){for(var b=p[m],x=0,C=E-1;(b!==0||x<y)&&C!==-1;C--,x++)b+=256*w[C]>>>0,w[C]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=x,m++}for(var I=E-y;I!==E&&w[I]===0;)I++;for(var O=c.repeat(d);I<E;++I)O+=t.charAt(w[I]);return O}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===c;)y++,d++;for(var D=(p.length-d)*f+1>>>0,E=new Uint8Array(D);p[d];){var w=r[p.charCodeAt(d)];if(w===255)return;for(var b=0,x=D-1;(w!==0||b<m)&&x!==-1;x--,b++)w+=a*E[x]>>>0,E[x]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var C=D-m;C!==D&&E[C]===0;)C++;for(var I=new Uint8Array(y+(D-C)),O=y;C!==D;)I[O++]=E[C++];return I}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var fI=cI,hI=fI,kD=hI;var UM=new Uint8Array(0);var OD=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Vl=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Kl=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return MD(this,e)}},Gl=class{constructor(e){this.decoders=e}or(e){return MD(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},MD=(t,e)=>new Gl({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Hl=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Vl(e,r,n),this.decoder=new Kl(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ND=({name:t,prefix:e,encode:r,decode:n})=>new Hl(t,e,r,n),Wl=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:s}=kD(r,e);return ND({prefix:t,name:e,encode:n,decode:i=>OD(s(i))})},lI=(t,e,r,n)=>{let s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,c=0,f=0;for(let u=0;u<i;++u){let h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},pI=(t,e,r)=>{let n=e[e.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},ot=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ND({prefix:e,name:t,encode(s){return pI(s,n,r)},decode(s){return lI(s,n,r,t)}});var FD=Wl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),HM=Wl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var LD=ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jM=ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),JM=ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ZM=ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),XM=ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),QM=ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),YM=ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),eN=ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),tN=ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var UD=ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sN=ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),iN=ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),oN=ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});Sr.default.formatters.b=t=>t==null?"undefined":FD.baseEncode(t);Sr.default.formatters.t=t=>t==null?"undefined":LD.baseEncode(t);Sr.default.formatters.m=t=>t==null?"undefined":UD.baseEncode(t);Sr.default.formatters.p=t=>t==null?"undefined":t.toString();Sr.default.formatters.c=t=>t==null?"undefined":t.toString();Sr.default.formatters.k=t=>t==null?"undefined":t.toString();function Eu(t){return Object.assign((0,Sr.default)(t),{error:(0,Sr.default)(`${t}:error`),trace:(0,Sr.default)(`${t}:trace`)})}var $l=Symbol.for("@libp2p/topology");var qD=()=>{},jl=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??qD,this.onDisconnect=e.onDisconnect??qD}get[Symbol.toStringTag](){return $l.toString()}get[$l](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function zD(t){return new jl(t)}var Xn=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Zr,Su=class extends EventTarget{constructor(){super(...arguments),Zr.set(this,new Map)}listenerCount(e){let r=Xn(this,Zr,"f").get(e);return r==null?0:r.length}addEventListener(e,r,n){super.addEventListener(e,r,n);let s=Xn(this,Zr,"f").get(e);s==null&&(s=[],Xn(this,Zr,"f").set(e,s)),s.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(e,r,n){super.removeEventListener(e.toString(),r??null,n);let s=Xn(this,Zr,"f").get(e);s!=null&&(s=s.filter(({callback:i})=>i!==r),Xn(this,Zr,"f").set(e,s))}dispatchEvent(e){let r=super.dispatchEvent(e),n=Xn(this,Zr,"f").get(e.type);return n==null||(n=n.filter(({once:s})=>!s),Xn(this,Zr,"f").set(e.type,n)),r}};Zr=new WeakMap;var Jl=class extends Event{constructor(e,r){super(e,r),this.detail=r?.detail}},Qn=globalThis.CustomEvent??Jl;var Cu=class{constructor(e,r,n){this.gossip=e,this.msgs=new Map,this.history=[],this.notValidatedCount=0,this.msgIdToStrFn=n;for(let s=0;s<r;s++)this.history[s]=[]}get size(){return this.msgs.size}put(e,r,n=!1){let{msgIdStr:s}=e;return this.msgs.has(s)?!1:(this.msgs.set(s,{message:r,validated:n,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...e,topic:r.topic}),n||this.notValidatedCount++,!0)}observeDuplicate(e,r){let n=this.msgs.get(e);n&&!n.validated&&n.originatingPeers.add(r)}get(e){return this.msgs.get(this.msgIdToStrFn(e))?.message}getWithIWantCount(e,r){let n=this.msgs.get(e);if(!n)return null;let s=(n.iwantCounts.get(r)??0)+1;return n.iwantCounts.set(r,s),{msg:n.message,count:s}}getGossipIDs(e){let r=new Map;for(let n=0;n<this.gossip;n++)this.history[n].forEach(s=>{let i=this.msgs.get(s.msgIdStr);if(i&&i.validated&&e.has(s.topic)){let o=r.get(s.topic);o||(o=[],r.set(s.topic,o)),o.push(s.msgId)}});return r}validate(e){let r=this.msgs.get(e);if(!r)return null;r.validated||this.notValidatedCount--;let{message:n,originatingPeers:s}=r;return r.validated=!0,r.originatingPeers=new Set,{message:n,originatingPeers:s}}shift(){this.history[this.history.length-1].forEach(r=>{let n=this.msgs.get(r.msgIdStr);n&&(this.msgs.delete(r.msgIdStr),n.validated||this.notValidatedCount--)}),this.history.pop(),this.history.unshift([])}remove(e){let r=this.msgs.get(e);return r?(this.msgs.delete(e),r):null}};var vv=W(Dv(),1),{RPC:Ro}=vv.default;var cp="/floodsub/1.0.0",fp="/meshsub/1.0.0",Bu="/meshsub/1.1.0";var wv="ERR_TOPIC_VALIDATOR_REJECT",xv="ERR_TOPIC_VALIDATOR_IGNORE";function Ir(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),s=t[r];t[r]=t[n],t[n]=s}return t}var gp={};U(gp,{identity:()=>II});function xI(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var d=0,y=0,m=0,D=p.length;m!==D&&p[m]===0;)m++,d++;for(var E=(D-m)*u+1>>>0,w=new Uint8Array(E);m!==D;){for(var b=p[m],x=0,C=E-1;(b!==0||x<y)&&C!==-1;C--,x++)b+=256*w[C]>>>0,w[C]=b%a>>>0,b=b/a>>>0;if(b!==0)throw new Error("Non-zero carry");y=x,m++}for(var I=E-y;I!==E&&w[I]===0;)I++;for(var O=c.repeat(d);I<E;++I)O+=t.charAt(w[I]);return O}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var d=0;if(p[d]!==" "){for(var y=0,m=0;p[d]===c;)y++,d++;for(var D=(p.length-d)*f+1>>>0,E=new Uint8Array(D);p[d];){var w=r[p.charCodeAt(d)];if(w===255)return;for(var b=0,x=D-1;(w!==0||b<m)&&x!==-1;x--,b++)w+=a*E[x]>>>0,E[x]=w%256>>>0,w=w/256>>>0;if(w!==0)throw new Error("Non-zero carry");m=b,d++}if(p[d]!==" "){for(var C=D-m;C!==D&&E[C]===0;)C++;for(var I=new Uint8Array(y+(D-C)),O=y;C!==D;)I[O++]=E[C++];return I}}}function g(p){var d=l(p);if(d)return d;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:g}}var EI=xI,SI=EI,Ev=SI;var PN=new Uint8Array(0);var Sv=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Xr=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Cv=t=>new TextEncoder().encode(t),Av=t=>new TextDecoder().decode(t);var hp=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},lp=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Bv(this,e)}},pp=class{constructor(e){this.decoders=e}or(e){return Bv(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Bv=(t,e)=>new pp({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),dp=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new hp(e,r,n),this.decoder=new lp(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},hi=({name:t,prefix:e,encode:r,decode:n})=>new dp(t,e,r,n),In=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:s}=Ev(r,e);return hi({prefix:t,name:e,encode:n,decode:i=>Xr(s(i))})},CI=(t,e,r,n)=>{let s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),a=0,c=0,f=0;for(let u=0;u<i;++u){let h=s[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|h,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},AI=(t,e,r)=>{let n=e[e.length-1]==="=",s=(1<<r)-1,i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Re=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>hi({prefix:e,name:t,encode(s){return AI(s,n,r)},decode(s){return CI(s,n,r,t)}});var II=hi({prefix:"\0",name:"identity",encode:t=>Av(t),decode:t=>Cv(t)});var yp={};U(yp,{base2:()=>BI});var BI=Re({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var mp={};U(mp,{base8:()=>TI});var TI=Re({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var bp={};U(bp,{base10:()=>_I});var _I=In({prefix:"9",name:"base10",alphabet:"0123456789"});var Dp={};U(Dp,{base16:()=>PI,base16upper:()=>RI});var PI=Re({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),RI=Re({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var vp={};U(vp,{base32:()=>li,base32hex:()=>NI,base32hexpad:()=>LI,base32hexpadupper:()=>UI,base32hexupper:()=>FI,base32pad:()=>OI,base32padupper:()=>MI,base32upper:()=>kI,base32z:()=>qI});var li=Re({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kI=Re({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),OI=Re({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),MI=Re({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),NI=Re({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),FI=Re({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),LI=Re({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),UI=Re({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qI=Re({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var wp={};U(wp,{base36:()=>zI,base36upper:()=>VI});var zI=In({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),VI=In({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var xp={};U(xp,{base58btc:()=>Br,base58flickr:()=>KI});var Br=In({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),KI=In({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ep={};U(Ep,{base64:()=>GI,base64pad:()=>HI,base64url:()=>WI,base64urlpad:()=>$I});var GI=Re({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),HI=Re({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),WI=Re({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$I=Re({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Sp={};U(Sp,{base256emoji:()=>QI});var Tv=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),jI=Tv.reduce((t,e,r)=>(t[r]=e,t),[]),JI=Tv.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function ZI(t){return t.reduce((e,r)=>(e+=jI[r],e),"")}function XI(t){let e=[];for(let r of t){let n=JI[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var QI=hi({prefix:"\u{1F680}",name:"base256emoji",encode:ZI,decode:XI});var Bp={};U(Bp,{sha256:()=>_u,sha512:()=>m6});var YI=Rv,_v=128,e6=127,t6=~e6,r6=Math.pow(2,31);function Rv(t,e,r){e=e||[],r=r||0;for(var n=r;t>=r6;)e[r++]=t&255|_v,t/=128;for(;t&t6;)e[r++]=t&255|_v,t>>>=7;return e[r]=t|0,Rv.bytes=r-n+1,e}var n6=Cp,s6=128,Pv=127;function Cp(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Cp.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&Pv)<<s:(o&Pv)*Math.pow(2,s),s+=7}while(o>=s6);return Cp.bytes=i-n,r}var i6=Math.pow(2,7),o6=Math.pow(2,14),a6=Math.pow(2,21),u6=Math.pow(2,28),c6=Math.pow(2,35),f6=Math.pow(2,42),h6=Math.pow(2,49),l6=Math.pow(2,56),p6=Math.pow(2,63),d6=function(t){return t<i6?1:t<o6?2:t<a6?3:t<u6?4:t<c6?5:t<f6?6:t<h6?7:t<l6?8:t<p6?9:10},g6={encode:YI,decode:n6,encodingLength:d6},y6=g6,ko=y6;var Oo=(t,e=0)=>[ko.decode(t,e),ko.decode.bytes],pi=(t,e,r=0)=>(ko.encode(t,e,r),e),di=t=>ko.encodingLength(t);var ts=(t,e)=>{let r=e.byteLength,n=di(t),s=n+di(r),i=new Uint8Array(s+r);return pi(t,i,0),pi(r,i,n),i.set(e,s),new gi(t,r,e,i)},kv=t=>{let e=Xr(t),[r,n]=Oo(e),[s,i]=Oo(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new gi(r,s,o,e)},Ov=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Sv(t.bytes,r.bytes)}},gi=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};var Ip=({name:t,code:e,encode:r})=>new Ap(t,e,r),Ap=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?ts(this.code,r):r.then(n=>ts(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Nv=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),_u=Ip({name:"sha2-256",code:18,encode:Nv("SHA-256")}),m6=Ip({name:"sha2-512",code:19,encode:Nv("SHA-512")});var Tp={};U(Tp,{identity:()=>v6});var Fv=0,b6="identity",Lv=Xr,D6=t=>ts(Fv,Lv(t)),v6={code:Fv,name:b6,encode:Lv,digest:D6};var QN=new TextEncoder,YN=new TextDecoder;var E6=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return C6(r,_p(t),e||Br.encoder);default:return A6(r,_p(t),e||li.encoder)}},Uv=new WeakMap,_p=t=>{let e=Uv.get(t);if(e==null){let r=new Map;return Uv.set(t,r),r}return e},Ve=class{constructor(e,r,n,s){this.code=r,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==No)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==I6)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Ve.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=ts(e,r);return Ve.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return Ve.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Ov(e.multihash,n.multihash)}toString(e){return E6(this,e)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof Ve)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:s,multihash:i,bytes:o}=r;return new Ve(n,s,i,o||qv(n,s,i.bytes))}else if(r[B6]===!0){let{version:n,multihash:s,code:i}=r,o=kv(s);return Ve.create(n,i,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==No)throw new Error(`Version 0 CID must use dag-pb (code: ${No}) block encoding`);return new Ve(e,r,n,n.bytes)}case 1:{let s=qv(e,r,n.bytes);return new Ve(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return Ve.create(0,No,e)}static createV1(e,r){return Ve.create(1,e,r)}static decode(e){let[r,n]=Ve.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=Ve.inspectBytes(e),n=r.size-r.multihashSize,s=Xr(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");let i=s.subarray(r.multihashSize-r.digestSize),o=new gi(r.multihashCode,r.digestSize,i,s);return[r.version===0?Ve.createV0(o):Ve.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Oo(e.subarray(r));return r+=l,h},s=n(),i=No;if(s===18?(s=0,r=0):i=n(),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);let o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){let[n,s]=S6(e,r),i=Ve.decode(s);return _p(i).set(n,e),i}},S6=(t,e)=>{switch(t[0]){case"Q":{let r=e||Br;return[Br.prefix,r.decode(`${Br.prefix}${t}`)]}case Br.prefix:{let r=e||Br;return[Br.prefix,r.decode(t)]}case li.prefix:{let r=e||li;return[li.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},C6=(t,e,r)=>{let{prefix:n}=r;if(n!==Br.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=e.get(n);if(s==null){let i=r.encode(t).slice(1);return e.set(n,i),i}else return s},A6=(t,e,r)=>{let{prefix:n}=r,s=e.get(n);if(s==null){let i=r.encode(t);return e.set(n,i),i}else return s},No=112,I6=18,qv=(t,e,r)=>{let n=di(t),s=n+di(e),i=new Uint8Array(s+r.byteLength);return pi(t,i,0),pi(e,i,n),i.set(r,s),i},B6=Symbol.for("@ipld/js-cid/CID");var Pp={...gp,...yp,...mp,...bp,...Dp,...vp,...wp,...xp,...Ep,...Sp},cF={...Bp,...Tp};function yi(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Pu(t=0){return globalThis.Buffer?.allocUnsafe!=null?yi(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Vv(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var zv=Vv("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),Rp=Vv("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Pu(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),T6={utf8:zv,"utf-8":zv,hex:Pp.base16,latin1:Rp,ascii:Rp,binary:Rp,...Pp},Ru=T6;function mi(t,e="utf8"){let r=Ru[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Kv(t){return mi(t,"base64")}var rs="StrictSign",bi="StrictNoSign",tr;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})(tr||(tr={}));var Gv;(function(t){t.StrictSign="StrictSign",t.StrictNoSign="StrictNoSign"})(Gv||(Gv={}));var Bn;(function(t){t[t.Signing=0]="Signing",t[t.Anonymous=1]="Anonymous"})(Bn||(Bn={}));var at;(function(t){t.Error="error",t.Ignore="ignore",t.Reject="reject",t.Blacklisted="blacklisted"})(at||(at={}));var rt;(function(t){t.InvalidSignature="invalid_signature",t.InvalidSeqno="invalid_seqno",t.InvalidPeerId="invalid_peerid",t.SignaturePresent="signature_present",t.SeqnoPresent="seqno_present",t.FromPresent="from_present",t.TransformFailed="transform_failed"})(rt||(rt={}));var zt;(function(t){t.duplicate="duplicate",t.invalid="invalid",t.valid="valid"})(zt||(zt={}));function kp(t){switch(t){case tr.Ignore:return at.Ignore;case tr.Reject:return at.Reject}}async function Op(t,e){switch(t){case rs:{if(!e)throw Error("Must provide PeerId");if(e.privateKey==null)throw Error("Cannot sign message, no private key present");if(e.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await tu(e.privateKey);return{type:Bn.Signing,author:e,key:e.publicKey,privateKey:r}}case bi:return{type:Bn.Anonymous};default:throw new Error(`Unknown signature policy "${t}"`)}}var pe="ERR_INVALID_PEER_SCORE_PARAMS";var de=W(Le(),1),_6={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},P6={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function Hv(t={}){return{..._6,...t,topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=R6(n),e),{}):{}}}function R6(t={}){return{...P6,...t}}function Wv(t){for(let[e,r]of Object.entries(t.topics))try{k6(r)}catch(n){throw(0,de.default)(new Error(`invalid score parameters for topic ${e}: ${n.message}`),pe)}if(t.topicScoreCap<0)throw(0,de.default)(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),pe);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw(0,de.default)(new Error("missing application specific score function"),pe);if(t.IPColocationFactorWeight>0)throw(0,de.default)(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),pe);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw(0,de.default)(new Error("invalid IPColocationFactorThreshold; must be at least 1"),pe);if(t.behaviourPenaltyWeight>0)throw(0,de.default)(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),pe);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw(0,de.default)(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),pe);if(t.decayInterval<1e3)throw(0,de.default)(new Error("invalid DecayInterval; must be at least 1s"),pe);if(t.decayToZero<=0||t.decayToZero>=1)throw(0,de.default)(new Error("invalid DecayToZero; must be between 0 and 1"),pe)}function k6(t){if(t.topicWeight<0)throw(0,de.default)(new Error("invalid topic weight; must be >= 0"),pe);if(t.timeInMeshQuantum===0)throw(0,de.default)(new Error("invalid TimeInMeshQuantum; must be non zero"),pe);if(t.timeInMeshWeight<0)throw(0,de.default)(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),pe);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw(0,de.default)(new Error("invalid TimeInMeshQuantum; must be positive"),pe);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw(0,de.default)(new Error("invalid TimeInMeshCap; must be positive"),pe);if(t.firstMessageDeliveriesWeight<0)throw(0,de.default)(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),pe);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw(0,de.default)(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),pe);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw(0,de.default)(new Error("invalid FirstMessageDeliveriesCap; must be positive"),pe);if(t.meshMessageDeliveriesWeight>0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),pe);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw(0,de.default)(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),pe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesCap; must be positive"),pe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),pe);if(t.meshMessageDeliveriesWindow<0)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),pe);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw(0,de.default)(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),pe);if(t.meshFailurePenaltyWeight>0)throw(0,de.default)(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),pe);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw(0,de.default)(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),pe);if(t.invalidMessageDeliveriesWeight>0)throw(0,de.default)(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),pe);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw(0,de.default)(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),pe)}var O6=W(Le(),1),M6={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function $v(t={}){return{...M6,...t}}function jv(t,e,r,n){let s=0;if(Object.entries(e.topics).forEach(([o,a])=>{let c=r.topics[o];if(c===void 0)return;let f=0;if(a.inMesh){let g=a.meshTime/c.timeInMeshQuantum;g>c.timeInMeshCap&&(g=c.timeInMeshCap),f+=g*c.timeInMeshWeight}let u=a.firstMessageDeliveries;if(u>c.firstMessageDeliveriesCap&&(u=c.firstMessageDeliveriesCap),f+=u*c.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<c.meshMessageDeliveriesThreshold){let g=c.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;f+=g*g*c.meshMessageDeliveriesWeight}f+=a.meshFailurePenalty*c.meshFailurePenaltyWeight,f+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*c.invalidMessageDeliveriesWeight,s+=f*c.topicWeight}),r.topicScoreCap>0&&s>r.topicScoreCap&&(s=r.topicScoreCap),s+=r.appSpecificScore(t)*r.appSpecificWeight,e.knownIPs.forEach(o=>{if(r.IPColocationFactorWhitelist.has(o))return;let a=n.get(o),c=a?a.size:0;if(c>r.IPColocationFactorThreshold){let f=c-r.IPColocationFactorThreshold;s+=f*f*r.IPColocationFactorWeight}}),e.behaviourPenalty>r.behaviourPenaltyThreshold){let o=e.behaviourPenalty-r.behaviourPenaltyThreshold;s+=o*o*r.behaviourPenaltyWeight}return s}var Xv=W(Zv(),1),ut;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(ut||(ut={}));var ku=class{constructor(){this.records=new Map,this.queue=new Xv.default}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:ut.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};function Mu(t,e,r=()=>!0){let n=new Set;if(e<=0)return n;for(let s of t){if(n.size>=e)break;r(s)&&(n.add(s),t.delete(s))}return n}function Qv(t,e){return Mu(t,e,()=>!0)}var Ou=class extends Map{constructor(e){super(),this.getDefault=e}getOrDefault(e){let r=super.get(e);return r===void 0&&(r=this.getDefault(),this.set(e,r)),r}};var Di=Eu("libp2p:gossipsub:score"),Nu=class{constructor(e,r,n){this.params=e,this.metrics=r,this.peerStats=new Map,this.peerIPs=new Ou(()=>new Set),this.scoreCache=new Map,this.deliveryRecords=new ku,Wv(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=n.computeScore??jv}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){Di("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),Di("started")}stop(){if(!this._backgroundInterval){Di("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),Di("stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,r])=>[e,r]))}refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,s)=>{if(!n.connected){e>n.expire&&(this.removeIPsForPeer(s,n.knownIPs),this.peerStats.delete(s),this.scoreCache.delete(s));return}Object.entries(n.topics).forEach(([i,o])=>{let a=this.params.topics[i];a!==void 0&&(o.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,o.firstMessageDeliveries<r&&(o.firstMessageDeliveries=0),o.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,o.meshMessageDeliveries<r&&(o.meshMessageDeliveries=0),o.meshFailurePenalty*=a.meshFailurePenaltyDecay,o.meshFailurePenalty<r&&(o.meshFailurePenalty=0),o.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,o.invalidMessageDeliveries<r&&(o.invalidMessageDeliveries=0),o.inMesh&&(o.meshTime=e-o.graftTime,o.meshTime>a.meshMessageDeliveriesActivation&&(o.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(e);if(!r)return 0;let n=Date.now(),s=this.scoreCache.get(e);if(s&&s.cacheUntil>n)return s.score;this.metrics?.scoreFnRuns.inc();let i=this.computeScore(e,r,this.params,this.peerIPs),o=n+this.scoreCacheValidityMs;return s?(this.metrics?.scoreCachedDelta.observe(Math.abs(i-s.score)),s.score=i,s.cacheUntil=o):this.scoreCache.set(e,{score:i,cacheUntil:o}),i}addPenalty(e,r,n){let s=this.peerStats.get(e);s&&(s.behaviourPenalty+=r,this.metrics?.onScorePenalty(n))}addPeer(e){let r={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(e,r)}addIP(e,r){let n=this.peerStats.get(e);n&&n.knownIPs.add(r),this.peerIPs.getOrDefault(r).add(e)}removeIP(e,r){let n=this.peerStats.get(e);n&&n.knownIPs.delete(r);let s=this.peerIPs.get(r);s&&(s.delete(e),s.size===0&&this.peerIPs.delete(r))}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this.removeIPsForPeer(e,r.knownIPs),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([n,s])=>{s.firstMessageDeliveries=0;let i=this.params.topics[n].meshMessageDeliveriesThreshold;if(s.inMesh&&s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){let o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.inMesh=!1,s.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(n){let s=this.getPtopicStats(n,r);s&&(s.inMesh=!0,s.graftTime=Date.now(),s.meshTime=0,s.meshMessageDeliveriesActive=!1)}}prune(e,r){let n=this.peerStats.get(e);if(n){let s=this.getPtopicStats(n,r);if(s){let i=this.params.topics[r].meshMessageDeliveriesThreshold;if(s.meshMessageDeliveriesActive&&s.meshMessageDeliveries<i){let o=i-s.meshMessageDeliveries;s.meshFailurePenalty+=o*o}s.meshMessageDeliveriesActive=!1,s.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,r,n){this.markFirstMessageDelivery(e,n);let s=this.deliveryRecords.ensureRecord(r),i=Date.now();if(s.status!==ut.unknown){Di("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",e,i-s.firstSeen,ut[s.status]);return}s.status=ut.valid,s.validated=i,s.peers.forEach(o=>{o!==e.toString()&&this.markDuplicateMessageDelivery(o,n)})}rejectInvalidMessage(e,r){this.markInvalidMessageDelivery(e,r)}rejectMessage(e,r,n,s){switch(s){case at.Error:this.markInvalidMessageDelivery(e,n);return;case at.Blacklisted:return}let i=this.deliveryRecords.ensureRecord(r);if(i.status!==ut.unknown){Di("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-i.firstSeen,ut[i.status]);return}if(s===at.Ignore){i.status=ut.ignored,i.peers.clear();return}i.status=ut.invalid,this.markInvalidMessageDelivery(e,n),i.peers.forEach(o=>{this.markInvalidMessageDelivery(o,n)}),i.peers.clear()}duplicateMessage(e,r,n){let s=this.deliveryRecords.ensureRecord(r);if(!s.peers.has(e))switch(s.status){case ut.unknown:s.peers.add(e);break;case ut.valid:s.peers.add(e),this.markDuplicateMessageDelivery(e,n,s.validated);break;case ut.invalid:this.markInvalidMessageDelivery(e,n);break;case ut.ignored:break}}markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let s=this.getPtopicStats(n,r);s&&(s.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let s=this.getPtopicStats(n,r);if(s){let i=this.params.topics[r].firstMessageDeliveriesCap;s.firstMessageDeliveries=Math.min(i,s.firstMessageDeliveries+1),s.inMesh&&(i=this.params.topics[r].meshMessageDeliveriesCap,s.meshMessageDeliveries=Math.min(i,s.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,r,n){let s=this.peerStats.get(e);if(s){let i=n!==void 0?Date.now():0,o=this.getPtopicStats(s,r);if(o&&o.inMesh){let a=this.params.topics[r];if(n!==void 0){let f=i-n,u=f>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,f,u),u)return}let c=a.meshMessageDeliveriesCap;o.meshMessageDeliveries=Math.min(c,o.meshMessageDeliveries+1)}}}removeIPsForPeer(e,r){for(let n of r){let s=this.peerIPs.get(n);s&&(s.delete(e),s.size===0&&this.peerIPs.delete(n))}}getPtopicStats(e,r){let n=e.topics[r];return n!==void 0?n:this.params.topics[r]!==void 0?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[r]=n,n):null}};var Fu=class{constructor(e,r,n){this.gossipsubIWantFollowupMs=e,this.msgIdToStrFn=r,this.metrics=n,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,r){let n=Math.floor(Math.random()*r.length),s=r[n],i=this.msgIdToStrFn(s),o=this.promises.get(i);o||(o=new Map,this.promises.set(i,o));let a=Date.now();o.has(e)||(o.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(i)||this.requestMsByMsg.set(i,a)))}getBrokenPromises(){let e=Date.now(),r=new Map,n=0;return this.promises.forEach((s,i)=>{s.forEach((o,a)=>{o<e&&(r.set(a,(r.get(a)??0)+1),s.delete(a),n++)}),s.size||this.promises.delete(i)}),this.metrics?.iwantPromiseBroken.inc(n),r}deliverMessage(e){this.trackMessage(e);let r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}rejectMessage(e,r){switch(this.trackMessage(e),r){case at.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire;for(let[r,n]of this.requestMsByMsg.entries())if(n<e)this.requestMsByMsg.delete(r);else break}trackMessage(e){if(this.metrics){let r=this.requestMsByMsg.get(e);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(e))}}};var vi=class{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,r){return this.entries.has(e)?!0:(this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){let e=Date.now();for(let[r,n]of this.entries.entries())if(n.validUntilMs<e)this.entries.delete(r);else break}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};var Yv;(function(t){t.forward="forward",t.publish="publish"})(Yv||(Yv={}));var Qr;(function(t){t.Fanout="fanout",t.Random="random",t.Subscribed="subscribed",t.Outbound="outbound",t.NotEnough="not_enough",t.Opportunistic="opportunistic"})(Qr||(Qr={}));var ns;(function(t){t.Dc="disconnected",t.BadScore="bad_score",t.Prune="prune",t.Unsub="unsubscribed",t.Excess="excess"})(ns||(ns={}));var xi;(function(t){t.GraftBackoff="graft_backoff",t.BrokenPromise="broken_promise",t.MessageDeficit="message_deficit",t.IPColocation="IP_colocation"})(xi||(xi={}));var Ei;(function(t){t.LowScore="low_score",t.MaxIhave="max_ihave",t.MaxIasked="max_iasked"})(Ei||(Ei={}));var wi;(function(t){t.graylist="graylist",t.publish="publish",t.gossip="gossip",t.mesh="mesh"})(wi||(wi={}));function e1(t,e,r){return{protocolsEnabled:t.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:t.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:t.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:t.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:t.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:t.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:t.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:t.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:t.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:t.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:t.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:t.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:t.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:t.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:t.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:t.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:t.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:t.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:t.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:t.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:t.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:t.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:t.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:t.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:t.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:t.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:t.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:t.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:t.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:t.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:t.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:t.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:t.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:t.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:t.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:t.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:t.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:t.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:t.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:t.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:t.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:t.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:t.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:t.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:t.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:t.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:t.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:t.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:t.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:t.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:t.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:t.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:t.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:t.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:t.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:t.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:t.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:t.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:t.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:t.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:t.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:t.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:t.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),topicStrToLabel:e,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,s,i){let o=this.toTopic(n);this.meshPeerInclusionEvents.inc({topic:o,reason:s},i)},onRemoveFromMesh(n,s,i){let o=this.toTopic(n);this.meshPeerChurnEvents.inc({topic:o,reason:s},i)},onReportValidationMcacheHit(n){this.asyncValidationMcacheHit.inc({hit:n?"hit":"miss"})},onReportValidation(n,s){let i=this.toTopic(n);this.asyncValidationResult.inc({topic:i,acceptance:s})},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,s,i){let o=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:o},s),this.ihaveRcvNotSeenMsgids.inc({topic:o},i)},onIwantRcv(n,s){for(let[i,o]of n){let a=this.toTopic(i);this.iwantRcvMsgids.inc({topic:a},o)}this.iwantRcvDonthaveMsgids.inc(s)},onForwardMsg(n,s){let i=this.toTopic(n);this.msgForwardCount.inc({topic:i},1),this.msgForwardPeers.inc({topic:i},s)},onPublishMsg(n,s,i,o){let a=this.toTopic(n);this.msgPublishCount.inc({topic:a},1),this.msgPublishBytes.inc({topic:a},i*o),this.msgPublishPeers.inc({topic:a},i),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"direct"},s.direct),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"floodsub"},s.floodsub),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"mesh"},s.mesh),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"fanout"},s.fanout)},onMsgRecvPreValidation(n){let s=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:s},1)},onMsgRecvResult(n,s){let i=this.toTopic(n);this.msgReceivedStatus.inc({topic:i,status:s})},onMsgRecvInvalid(n,s){let i=this.toTopic(n),o=s.reason===at.Error?s.error:s.reason;this.msgReceivedInvalid.inc({topic:i,error:o},1)},onDuplicateMsgDelivery(n,s,i){if(this.duplicateMsgDeliveryDelay.observe(s/1e3),i){let o=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:o},1)}},onRpcRecv(n,s){this.rpcRecvBytes.inc(s),this.rpcRecvCount.inc(1),n.subscriptions&&this.rpcRecvSubscription.inc(n.subscriptions.length),n.messages&&this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),n.control.ihave&&this.rpcRecvIHave.inc(n.control.ihave.length),n.control.iwant&&this.rpcRecvIWant.inc(n.control.iwant.length),n.control.graft&&this.rpcRecvGraft.inc(n.control.graft.length),n.control.prune&&this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,s){if(this.rpcSentBytes.inc(s),this.rpcSentCount.inc(1),n.subscriptions&&this.rpcSentSubscription.inc(n.subscriptions.length),n.messages&&this.rpcSentMessage.inc(n.messages.length),n.control){let i=n.control.ihave?.length??0,o=n.control.iwant?.length??0,a=n.control.graft?.length??0,c=n.control.prune?.length??0;i>0&&this.rpcSentIHave.inc(i),o>0&&this.rpcSentIWant.inc(o),a>0&&this.rpcSentGraft.inc(a),c>0&&this.rpcSentPrune.inc(c),(i>0||o>0||a>0||c>0)&&this.rpcSentControl.inc(1)}},registerScores(n,s){let i=0,o=0,a=0,c=0;for(let f of n)f>=s.graylistThreshold&&i++,f>=s.publishThreshold&&o++,f>=s.gossipThreshold&&a++,f>=0&&c++;this.peersByScoreThreshold.set({threshold:wi.graylist},i),this.peersByScoreThreshold.set({threshold:wi.publish},o),this.peersByScoreThreshold.set({threshold:wi.gossip},a),this.peersByScoreThreshold.set({threshold:wi.mesh},c),this.score.set(n)},registerScoreWeights(n){for(let[s,i]of n.byTopic)this.scoreWeights.set({topic:s,p:"p1"},i.p1w),this.scoreWeights.set({topic:s,p:"p2"},i.p2w),this.scoreWeights.set({topic:s,p:"p3"},i.p3w),this.scoreWeights.set({topic:s,p:"p3b"},i.p3bw),this.scoreWeights.set({topic:s,p:"p4"},i.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,s){let i=new Map;n.forEach((o,a)=>{let c=this.topicStrToLabel.get(a)??"unknown",f=i.get(c);f||(f=new Set,i.set(c,f)),o.forEach(u=>f?.add(u))});for(let[o,a]of i){let c=[];a.forEach(f=>{c.push(s.get(f)??0)}),this.scorePerMesh.set({topic:o},c)}}}}function Mp(t,e){e==null&&(e=t.reduce((s,i)=>s+i.length,0));let r=Pu(e),n=0;for(let s of t)r.set(s,n),n+=s.length;return yi(r)}function Lu(t,e="utf8"){let r=Ru[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?yi(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var h7=W(Ia(),1),F6=W(he(),1);var U6=W(Le(),1);var z6=W(Tf(),1),V6=W(Ne(),1),K6=W(Le(),1);function t1(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var r1=Lu("libp2p-pubsub:");async function n1(t,e,r,n){switch(t.type){case Bn.Signing:{let s={from:t.author.toBytes(),data:n,seqno:dn(8),topic:e,signature:void 0,key:void 0},i=Mp([r1,Ro.Message.encode(s).finish()]);s.signature=await t.privateKey.sign(i),s.key=t.key;let o={type:"signed",from:t.author,data:r,sequenceNumber:BigInt(`0x${mi(s.seqno,"base16")}`),topic:e,signature:s.signature,key:s.key};return{raw:s,msg:o}}case Bn.Anonymous:return{raw:{from:void 0,data:n,seqno:void 0,topic:e,signature:void 0,key:void 0},msg:{type:"unsigned",data:r,topic:e}}}}async function s1(t,e){switch(t){case bi:return e.signature!=null?{valid:!1,error:rt.SignaturePresent}:e.seqno!=null?{valid:!1,error:rt.SeqnoPresent}:e.key!=null?{valid:!1,error:rt.FromPresent}:{valid:!0,message:{type:"unsigned",topic:e.topic,data:e.data??new Uint8Array(0)}};case rs:{if(e.seqno==null)return{valid:!1,error:rt.InvalidSeqno};if(e.seqno.length!==8)return{valid:!1,error:rt.InvalidSeqno};if(e.signature==null)return{valid:!1,error:rt.InvalidSignature};if(e.from==null)return{valid:!1,error:rt.InvalidPeerId};let r;try{r=wn(e.from)}catch{return{valid:!1,error:rt.InvalidPeerId}}let n;if(e.key){if(n=ho(e.key),r.publicKey!==void 0&&!t1(n.bytes,r.publicKey))return{valid:!1,error:rt.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:rt.InvalidPeerId};n=ho(r.publicKey)}let s={from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0},i=Mp([r1,Ro.Message.encode(s).finish()]);return await n.verify(i,e.signature)?{valid:!0,message:{type:"signed",from:r,data:e.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${mi(e.seqno,"base16")}`),topic:e.topic,signature:e.signature,key:e.key??eb(n)}}:{valid:!1,error:rt.InvalidSignature}}}}var G6=W(Le(),1);var i1=(t,e)=>{let r=Lu(e.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(t.length+r.length);return n.set(t,0),n.set(r,t.length),n};function o1(t){if(t.type!=="signed")throw new Error("expected signed message type");if(t.sequenceNumber==null)throw Error("missing seqno field");return i1(t.from.toBytes(),t.sequenceNumber)}async function a1(t){return await _u.encode(t.data)}function H6(t,e,r,n,s){let i=0,o=new Map;if(Object.entries(e.topics).forEach(([l,g])=>{let p=s.get(l)??"unknown",d=r.topics[l];if(d===void 0)return;let y=o.get(p);y||(y={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},o.set(p,y));let m=0,D=0,E=0,w=0,b=0;g.inMesh&&(m+=Math.max(g.meshTime/d.timeInMeshQuantum,d.timeInMeshCap)*d.timeInMeshWeight);let x=g.firstMessageDeliveries;if(x>d.firstMessageDeliveriesCap&&(x=d.firstMessageDeliveriesCap),D+=x*d.firstMessageDeliveriesWeight,g.meshMessageDeliveriesActive&&g.meshMessageDeliveries<d.meshMessageDeliveriesThreshold){let O=d.meshMessageDeliveriesThreshold-g.meshMessageDeliveries;E+=O*O*d.meshMessageDeliveriesWeight}w+=g.meshFailurePenalty*d.meshFailurePenaltyWeight,b+=g.invalidMessageDeliveries*g.invalidMessageDeliveries*d.invalidMessageDeliveriesWeight,i+=(m+D+E+w+b)*d.topicWeight,y.p1w+=m,y.p2w+=D,y.p3w+=E,y.p3bw+=w,y.p4w+=b}),r.topicScoreCap>0&&i>r.topicScoreCap){i=r.topicScoreCap;let l=r.topicScoreCap/i;for(let g of o.values())g.p1w*=l,g.p2w*=l,g.p3w*=l,g.p3bw*=l,g.p4w*=l}let a=0,c=0,f=0;return a+=r.appSpecificScore(t)*r.appSpecificWeight,e.knownIPs.forEach(l=>{if(r.IPColocationFactorWhitelist.has(l))return;let g=n.get(l),p=g?g.size:0;if(p>r.IPColocationFactorThreshold){let d=p-r.IPColocationFactorThreshold;c+=d*d*r.IPColocationFactorWeight}}),f+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,i+=a+c+f,{byTopic:o,p5w:a,p6w:c,p7w:f,score:i}}function u1(t,e,r,n,s){let i={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let o of t){let a=e.get(o);if(a){let c=H6(o,a,r,n,s);for(let[f,u]of c.byTopic){let h=i.byTopic.get(f);h||(h={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},i.byTopic.set(f,h)),h.p1w.push(u.p1w),h.p2w.push(u.p2w),h.p3w.push(u.p3w),h.p3bw.push(u.p3bw),h.p4w.push(u.p4w)}i.p5w.push(c.p5w),i.p6w.push(c.p6w),i.p7w.push(c.p7w),i.score.push(c.score)}else i.p5w.push(0),i.p6w.push(0),i.p7w.push(0),i.score.push(0)}return i}var Fo=class extends Error{constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function c1(t){if(t!=null){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}function Np(t,e,r){let n=r??{},s=c1(t);async function*i(){let o,a=()=>{o?.()};for(e.addEventListener("abort",a);;){let c;try{if(e.aborted){let{abortMessage:u,abortCode:h}=n;throw new Fo(u,h)}let f=new Promise((u,h)=>{o=()=>{let{abortMessage:l,abortCode:g}=n;h(new Fo(l,g))}});c=await Promise.race([f,s.next()]),o=null}catch(f){e.removeEventListener("abort",a);let u=f.type==="aborted"&&e.aborted;if(u&&n.onAbort!=null&&await n.onAbort(t),typeof s.return=="function")try{let h=s.return();h instanceof Promise&&h.catch(l=>{n.onReturnError!=null&&n.onReturnError(l)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(u&&n.returnOnAbort===!0)return;throw f}if(c.done===!0)break;yield c.value}e.removeEventListener("abort",a)}return i()}function f1(t){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}var Uu=t=>{let e=Xt.encodingLength(t),r=f1(e);return Xt.encode(t,r),Uu.bytes=e,r};Uu.bytes=0;function qu(t){t=t??{};let e=t.lengthEncoder??Uu;return async function*(n){for await(let s of n){let i=e(s.byteLength);i instanceof Uint8Array?yield i:yield*i,s instanceof Uint8Array?yield s:yield*s}}}qu.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??Uu;return new Lt(r(t.byteLength),t)};var Lo=W(Le(),1),W6=8,$6=1024*1024*4,ss;(function(t){t[t.LENGTH=0]="LENGTH",t[t.DATA=1]="DATA"})(ss||(ss={}));var Fp=t=>{let e=Xt.decode(t);return Fp.bytes=Xt.encodingLength(e),e};Fp.bytes=0;function Uo(t){return async function*(r){let n=new Lt,s=ss.LENGTH,i=-1,o=t?.lengthDecoder??Fp,a=t?.maxLengthLength??W6,c=t?.maxDataLength??$6;for await(let f of r)for(n.append(f);n.byteLength>0;){if(s===ss.LENGTH)try{if(i=o(n),i<0)throw(0,Lo.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(i>c)throw(0,Lo.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=o.bytes;n.consume(u),t?.onLength!=null&&t.onLength(i),s=ss.DATA}catch(u){if(u instanceof RangeError){if(n.byteLength>a)throw(0,Lo.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(s===ss.DATA){if(n.byteLength<i)break;let u=n.sublist(0,i);n.consume(i),t?.onData!=null&&t.onData(u),yield u,s=ss.LENGTH}}if(n.byteLength>0)throw(0,Lo.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}Uo.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:i,value:o}=await t.next(r);if(i===!0)return;o!=null&&(yield o)}catch(i){if(i.code==="ERR_UNDER_READ")return{done:!0,value:null};throw i}finally{r=1}}();return Uo({...e??{},onLength:i=>{r=i}})(n)};var zu=class{constructor(e,r,n){this.rawStream=e,this.pushable=Tn({objectMode:!1}),this.closeController=new AbortController,this.maxBufferSize=n.maxBufferSize??1/0,cs(Np(this.pushable,this.closeController.signal,{returnOnAbort:!0}),qu(),this.rawStream).catch(r)}get protocol(){return this.rawStream.stat.protocol}push(e){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(e)}close(){this.closeController.abort(),this.pushable.return(),this.rawStream.close()}},Vu=class{constructor(e,r={}){this.rawStream=e,this.closeController=new AbortController,this.source=Np(cs(this.rawStream,Uo(r)),this.closeController.signal,{returnOnAbort:!0})}close(){this.closeController.abort(),this.rawStream.close()}};var h1=W(up(),1),l1={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function p1(t,e){e={...e};let r=h1.default.Reader.create(t),n=t.length,s=n===void 0?r.len:r.pos+n,i={};for(;r.pos<s;){let o=r.uint32();switch(o>>>3){case 1:i.subscriptions&&i.subscriptions.length||(i.subscriptions=[]),i.subscriptions.length<e.maxSubscriptions?i.subscriptions.push(j6(r,r.uint32())):r.skipType(o&7);break;case 2:i.messages&&i.messages.length||(i.messages=[]),i.messages.length<e.maxMessages?i.messages.push(J6(r,r.uint32())):r.skipType(o&7);break;case 3:i.control=Z6(r,r.uint32(),e);break;default:r.skipType(o&7);break}}return i}function j6(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.subscribe=t.bool();break;case 2:n.topic=t.string();break;default:t.skipType(s&7);break}}return n}function J6(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.from=t.bytes();break;case 2:n.data=t.bytes();break;case 3:n.seqno=t.bytes();break;case 4:n.topic=t.string();break;case 5:n.signature=t.bytes();break;case 6:n.key=t.bytes();break;default:t.skipType(s&7);break}}if(!n.topic)throw Error("missing required 'topic'");return n}function Z6(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.ihave&&s.ihave.length||(s.ihave=[]),s.ihave.length<r.maxControlMessages?s.ihave.push(X6(t,t.uint32(),r)):t.skipType(i&7);break;case 2:s.iwant&&s.iwant.length||(s.iwant=[]),s.iwant.length<r.maxControlMessages?s.iwant.push(Q6(t,t.uint32(),r)):t.skipType(i&7);break;case 3:s.graft&&s.graft.length||(s.graft=[]),s.graft.length<r.maxControlMessages?s.graft.push(Y6(t,t.uint32())):t.skipType(i&7);break;case 4:s.prune&&s.prune.length||(s.prune=[]),s.prune.length<r.maxControlMessages?s.prune.push(eB(t,t.uint32(),r)):t.skipType(i&7);break;default:t.skipType(i&7);break}}return s}function X6(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.topicID=t.string();break;case 2:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),r.maxIhaveMessageIDs-- >0?s.messageIDs.push(t.bytes()):t.skipType(i&7);break;default:t.skipType(i&7);break}}return s}function Q6(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.messageIDs&&s.messageIDs.length||(s.messageIDs=[]),r.maxIwantMessageIDs-- >0?s.messageIDs.push(t.bytes()):t.skipType(i&7);break;default:t.skipType(i&7);break}}return s}function Y6(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.topicID=t.string();break;default:t.skipType(s&7);break}}return n}function eB(t,e,r){let n=e===void 0?t.len:t.pos+e,s={};for(;t.pos<n;){let i=t.uint32();switch(i>>>3){case 1:s.topicID=t.string();break;case 2:s.peers&&s.peers.length||(s.peers=[]),r.maxPeerInfos-- >0?s.peers.push(tB(t,t.uint32())):t.skipType(i&7);break;case 3:s.backoff=t.uint64();break;default:t.skipType(i&7);break}}return s}function tB(t,e){let r=e===void 0?t.len:t.pos+e,n={};for(;t.pos<r;){let s=t.uint32();switch(s>>>3){case 1:n.peerID=t.bytes();break;case 2:n.signedPeerRecord=t.bytes();break;default:t.skipType(s&7);break}}return n}var Ku;(function(t){t[t.ip4=4]="ip4",t[t.ip6=41]="ip6"})(Ku||(Ku={}));function Gu(t){for(let e of t.tuples())switch(e[0]){case Ku.ip4:case Ku.ip6:return mu(e[0],e[1])}return null}var TB=Bu,Bt;(function(t){t[t.started=0]="started",t[t.stopped=1]="stopped"})(Bt||(Bt={}));var qo=class extends Su{constructor(e,r={}){super(),this.multicodecs=[Bu,fp],this.peers=new Set,this.streamsInbound=new Map,this.streamsOutbound=new Map,this.outboundInflightQueue=Tn({objectMode:!0}),this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.directPeerInitial=null,this.status={code:Bt.stopped},this.heartbeatTimer=null,this.onPeerAddressChange=s=>{let{peerId:i,multiaddrs:o,oldMultiaddrs:a}=s.detail,c=new Set,f=new Set;for(let h of o){let l=Gu(h);l&&c.add(l)}for(let h of a){let l=Gu(h);l&&(c.has(l)?c.delete(l):f.add(l))}let u=i.toString();for(let h of f)this.score.removeIP(u,h);for(let h of c)this.score.addIP(u,h)},this.runHeartbeat=()=>{let s=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(i=>{this.log("Error running heartbeat",i)}).finally(()=>{if(s?.(),this.status.code===Bt.started){clearTimeout(this.status.heartbeatTimeout);let i=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;i<this.opts.heartbeatInterval*.25&&(i+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,i)}})};let n={fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...r,scoreParams:Hv(r.scoreParams),scoreThresholds:$v(r.scoreThresholds)};if(this.components=e,this.decodeRpcLimits=n.decodeRpcLimits??l1,this.globalSignaturePolicy=n.globalSignaturePolicy??rs,n.fallbackToFloodsub&&this.multicodecs.push(cp),this.log=Eu(n.debugName??"libp2p:gossipsub"),this.opts=n,this.direct=new Set(n.directPeers.map(s=>s.id.toString())),this.seenCache=new vi({validityMs:n.seenTTL}),this.publishedMessageIds=new vi({validityMs:n.seenTTL}),r.msgIdFn)this.msgIdFn=r.msgIdFn;else switch(this.globalSignaturePolicy){case rs:this.msgIdFn=o1;break;case bi:this.msgIdFn=a1;break}if(r.fastMsgIdFn&&(this.fastMsgIdFn=r.fastMsgIdFn,this.fastMsgIdCache=new vi({validityMs:n.seenTTL})),this.msgIdToStrFn=r.msgIdToStrFn??Kv,this.mcache=r.messageCache||new Cu(n.mcacheGossip,n.mcacheLength,this.msgIdToStrFn),r.dataTransform&&(this.dataTransform=r.dataTransform),r.metricsRegister){if(!r.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let s=Math.max(...Object.values(n.scoreParams.topics).map(o=>o.meshMessageDeliveriesWindow),1e3),i=e1(r.metricsRegister,r.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:n.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:s/1e3});i.mcacheSize.addCollect(()=>this.onScrapeMetrics(i));for(let o of this.multicodecs)i.protocolsEnabled.set({protocol:o},1);this.metrics=i}else this.metrics=null;this.gossipTracer=new Fu(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new Nu(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:n.heartbeatInterval}),this.maxInboundStreams=r.maxInboundStreams,this.maxOutboundStreams=r.maxOutboundStreams,this.allowedTopics=n.allowedTopics?new Set(n.allowedTopics):null}getPeers(){return[...this.peers.keys()].map(e=>jn(e))}isStarted(){return this.status.code===Bt.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await Op(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=Tn({objectMode:!0}),cs(this.outboundInflightQueue,async i=>{for await(let{peerId:o,connection:a}of i)await this.createOutboundStream(o,a)}).catch(i=>this.log.error("outbound inflight queue error",i)),await Promise.all(this.opts.directPeers.map(async i=>{await this.components.peerStore.addressBook.add(i.id,i.addrs)}));let e=this.components.registrar;await Promise.all(this.multicodecs.map(i=>e.handle(i,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams})));let r=zD({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),n=await Promise.all(this.multicodecs.map(i=>e.register(i,r))),s=setTimeout(this.runHeartbeat,100);this.components.peerStore.addEventListener("change:multiaddrs",this.onPeerAddressChange),this.status={code:Bt.started,registrarTopologyIds:n,heartbeatTimeout:s,hearbeatStartMs:Date.now()+100},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async i=>await this.connect(i)))}).catch(i=>{this.log(i)})},1e3),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==Bt.started)return;let{registrarTopologyIds:e}=this.status;this.status={code:Bt.stopped},this.components.peerStore.removeEventListener("change:multiaddrs",this.onPeerAddressChange);let r=this.components.registrar;e.forEach(n=>r.unregister(n)),this.outboundInflightQueue.end();for(let n of this.streamsOutbound.values())n.close();this.streamsOutbound.clear();for(let n of this.streamsInbound.values())n.close();this.streamsInbound.clear(),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:e,connection:r}){if(!this.isStarted())return;let n=r.remotePeer;this.addPeer(n,r.stat.direction,r.remoteAddr),this.createInboundStream(n,e),this.outboundInflightQueue.push({peerId:n,connection:r})}onPeerConnected(e,r){!this.isStarted()||(this.addPeer(e,r.stat.direction,r.remoteAddr),this.outboundInflightQueue.push({peerId:e,connection:r}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}async createOutboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!!this.peers.has(n)&&!this.streamsOutbound.has(n))try{let s=new zu(await r.newStream(this.multicodecs),o=>this.log.error("outbound pipe error",o),{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",e),this.streamsOutbound.set(n,s);let i=s.protocol;i===cp&&this.floodsubPeers.add(n),this.metrics?.peersPerProtocol.inc({protocol:i},1),this.subscriptions.size>0&&(this.log("send subscriptions to",n),this.sendSubscriptions(n,Array.from(this.subscriptions),!0))}catch(s){this.log.error("createOutboundStream error",s)}}async createInboundStream(e,r){if(!this.isStarted())return;let n=e.toString();if(!this.peers.has(n))return;let s=this.streamsInbound.get(n);s!==void 0&&(this.log("replacing existing inbound steam %s",n),s.close()),this.log("create inbound stream %s",n);let i=new Vu(r,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(n,i),this.pipePeerReadStream(e,i.source).catch(o=>this.log(o))}addPeer(e,r,n){let s=e.toString();if(!this.peers.has(s)){this.log("new peer %p",e),this.peers.add(s),this.score.addPeer(s);let i=Gu(n);i!==null?this.score.addIP(s,i):this.log("Added peer has no IP in current address %s %s",s,n.toString()),this.outbound.has(s)||this.outbound.set(s,r==="outbound")}}removePeer(e){let r=e.toString();if(!this.peers.has(r))return;this.log("delete peer %p",e),this.peers.delete(r);let n=this.streamsOutbound.get(r),s=this.streamsInbound.get(r);n&&this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),n?.close(),s?.close(),this.streamsOutbound.delete(r),this.streamsInbound.delete(r);for(let i of this.topics.values())i.delete(r);for(let[i,o]of this.mesh)o.delete(r)===!0&&this.metrics?.onRemoveFromMesh(i,ns.Dc,1);for(let i of this.fanout.values())i.delete(r);this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r)}get started(){return this.status.code===Bt.started}getMeshPeers(e){let r=this.mesh.get(e);return r?Array.from(r):[]}getSubscribers(e){let r=this.topics.get(e);return(r?Array.from(r):[]).map(n=>jn(n))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,r){try{await cs(r,async n=>{for await(let s of n)try{let i=s.subarray(),o=p1(i,this.decodeRpcLimits);this.metrics?.onRpcRecv(o,i.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,o):this.handleReceivedRpc(e,o).catch(a=>this.log(a))}catch(i){this.log(i)}})}catch(n){this.handlePeerReadStreamError(n,e)}}handlePeerReadStreamError(e,r){this.log.error(e),this.onPeerDisconnected(r)}async handleReceivedRpc(e,r){if(!this.acceptFrom(e.toString())){this.log("received message from unacceptable peer %p",e),this.metrics?.rpcRecvNotAccepted.inc();return}if(this.log("rpc from %p",e),r.subscriptions&&r.subscriptions.length>0){let n=[];r.subscriptions.forEach(s=>{let i=s.topic,o=s.subscribe===!0;if(i!=null){if(this.allowedTopics&&!this.allowedTopics.has(i))return;this.handleReceivedSubscription(e,i,o),n.push({topic:i,subscribe:o})}}),this.dispatchEvent(new Qn("subscription-change",{detail:{peerId:e,subscriptions:n}}))}if(r.messages)for(let n of r.messages){if(this.allowedTopics&&!this.allowedTopics.has(n.topic))continue;let s=this.handleReceivedMessage(e,n).catch(i=>this.log(i));this.opts.awaitRpcMessageHandler&&await s}r.control&&await this.handleControlMessage(e.toString(),r.control)}handleReceivedSubscription(e,r,n){this.log("subscription update from %p topic %s",e,r);let s=this.topics.get(r);s==null&&(s=new Set,this.topics.set(r,s)),n?s.add(e.toString()):s.delete(e.toString())}async handleReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let n=await this.validateReceivedMessage(e,r);switch(this.metrics?.onMsgRecvResult(r.topic,n.code),n.code){case zt.duplicate:this.score.duplicateMessage(e.toString(),n.msgIdStr,r.topic),this.mcache.observeDuplicate(n.msgIdStr,e.toString());return;case zt.invalid:if(n.msgIdStr){let s=n.msgIdStr;this.score.rejectMessage(e.toString(),s,r.topic,n.reason),this.gossipTracer.rejectMessage(s,n.reason)}else this.score.rejectInvalidMessage(e.toString(),r.topic);this.metrics?.onMsgRecvInvalid(r.topic,n);return;case zt.valid:this.score.validateMessage(n.messageId.msgIdStr),this.gossipTracer.deliverMessage(n.messageId.msgIdStr),this.mcache.put(n.messageId,r,!this.opts.asyncValidation),this.subscriptions.has(r.topic)&&(!this.components.peerId.equals(e)||this.opts.emitSelf)&&(super.dispatchEvent(new Qn("gossipsub:message",{detail:{propagationSource:e,msgId:n.messageId.msgIdStr,msg:n.msg}})),super.dispatchEvent(new Qn("message",{detail:n.msg}))),this.opts.asyncValidation||this.forwardMessage(n.messageId.msgIdStr,r,e.toString())}}async validateReceivedMessage(e,r){let n=this.fastMsgIdFn?.(r),s=n!==void 0?this.fastMsgIdCache?.get(n):void 0;if(s)return{code:zt.duplicate,msgIdStr:s};let i=await s1(this.globalSignaturePolicy,r);if(!i.valid)return{code:zt.invalid,reason:at.Error,error:i.error};let o=i.message;try{this.dataTransform&&(o.data=this.dataTransform.inboundTransform(r.topic,o.data))}catch(h){return this.log("Invalid message, transform failed",h),{code:zt.invalid,reason:at.Error,error:rt.TransformFailed}}let a=await this.msgIdFn(o),c=this.msgIdToStrFn(a),f={msgId:a,msgIdStr:c};if(n!==void 0&&this.fastMsgIdCache&&this.fastMsgIdCache.put(n,c)&&this.metrics?.fastMsgIdCacheCollision.inc(),this.seenCache.has(c))return{code:zt.duplicate,msgIdStr:c};this.seenCache.put(c);let u=this.topicValidators.get(r.topic);if(u!=null){let h;try{h=await u(e,o)}catch(l){let g=l.code;g===xv&&(h=tr.Ignore),g===wv?h=tr.Reject:h=tr.Ignore}if(h!==tr.Accept)return{code:zt.invalid,reason:kp(h),msgIdStr:c}}return{code:zt.valid,messageId:f,msg:o}}getScore(e){return this.score.score(e)}sendSubscriptions(e,r,n){this.sendRpc(e,{subscriptions:r.map(s=>({topic:s,subscribe:n}))})}async handleControlMessage(e,r){if(r===void 0)return;let n=r.ihave?this.handleIHave(e,r.ihave):[],s=r.iwant?this.handleIWant(e,r.iwant):[],i=r.graft?await this.handleGraft(e,r.graft):[];r.prune&&await this.handlePrune(e,r.prune),!(!n.length&&!s.length&&!i.length)&&this.sendRpc(e,{messages:s,control:{iwant:n,prune:i}})}acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<128&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let s=this.score.score(e);return s>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+1e3}):this.acceptFromWhitelist.delete(e),s>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:Ei.LowScore}),[];let s=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,s),s>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,s),this.metrics?.ihaveRcvIgnored.inc({reason:Ei.MaxIhave}),[];let i=this.iasked.get(e)??0;if(i>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:Ei.MaxIasked}),[];let o=new Map;if(r.forEach(({topicID:f,messageIDs:u})=>{if(!f||!u||!this.mesh.has(f))return;let h=0;u.forEach(l=>{let g=this.msgIdToStrFn(l);this.seenCache.has(g)||(o.set(g,l),h++)}),this.metrics?.onIhaveRcv(f,u.length,h)}),!o.size)return[];let a=o.size;a+i>5e3&&(a=5e3-i),this.log("IHAVE: Asking for %d out of %d messages from %s",a,o.size,e);let c=Array.from(o.values());return Ir(c),c=c.slice(0,a),this.iasked.set(e,i+a),this.gossipTracer.addPromise(e,c),[{messageIDs:c}]}handleIWant(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let s=new Map,i=new Map,o=0;return r.forEach(({messageIDs:a})=>{a&&a.forEach(c=>{let f=this.msgIdToStrFn(c),u=this.mcache.getWithIWantCount(f,e);if(u==null){o++;return}if(i.set(u.msg.topic,1+(i.get(u.msg.topic)??0)),u.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,c);return}s.set(f,u.msg)})}),this.metrics?.onIwantRcv(i,o),s.size?(this.log("IWANT: Sending %d messages to %s",s.size,e),Array.from(s.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,r){let n=[],s=this.score.score(e),i=Date.now(),o=this.opts.doPX;return r.forEach(({topicID:a})=>{if(!a)return;let c=this.mesh.get(a);if(!c){o=!1;return}if(c.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(a),o=!1;return}let f=this.backoff.get(a)?.get(e);if(typeof f=="number"&&i<f){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,xi.GraftBackoff),o=!1;let u=f+this.opts.graftFloodThreshold-this.opts.pruneBackoff;i<u&&this.score.addPenalty(e,1,xi.GraftBackoff),this.addBackoff(e,a),n.push(a);return}if(s<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,s,a),n.push(a),o=!1,this.addBackoff(e,a);return}if(c.size>=this.opts.Dhi&&!this.outbound.get(e)){n.push(a),this.addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),c.add(e),this.metrics?.onAddToMesh(a,Qr.Subscribed,1)}),n.length?await Promise.all(n.map(a=>this.makePrune(e,a,o))):[]}async handlePrune(e,r){let n=this.score.score(e);for(let{topicID:s,backoff:i,peers:o}of r){if(s==null)continue;let a=this.mesh.get(s);if(!a)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,s),this.score.prune(e,s),a.has(e)&&(a.delete(e),this.metrics?.onRemoveFromMesh(s,ns.Unsub,1)),typeof i=="number"&&i>0?this.doAddBackoff(e,s,i*1e3):this.addBackoff(e,s),o&&o.length){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,s);continue}await this.pxConnect(o)}}}addBackoff(e,r){this.doAddBackoff(e,r,this.opts.pruneBackoff)}doAddBackoff(e,r,n){let s=this.backoff.get(r);s||(s=new Map,this.backoff.set(r,s));let i=Date.now()+n;(s.get(e)??0)<i&&s.set(e,i)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e,xi.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let e=Date.now();this.backoff.forEach((r,n)=>{r.forEach((s,i)=>{s<e&&r.delete(i)}),r.size===0&&this.backoff.delete(n)})}async directConnect(){let e=[];this.direct.forEach(r=>{this.streamsOutbound.has(r)||e.push(r)}),await Promise.all(e.map(async r=>await this.connect(r)))}async pxConnect(e){e.length>this.opts.prunePeers&&(Ir(e),e=e.slice(0,this.opts.prunePeers));let r=[];await Promise.all(e.map(async n=>{if(!n.peerID)return;let s=wn(n.peerID).toString();if(!this.peers.has(s)){if(!n.signedPeerRecord){r.push(s);return}try{let i=await Ut.openAndCertify(n.signedPeerRecord,"libp2p-peer-record"),o=i.peerId;if(!i.peerId.equals(s)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",o,s);return}if(!await this.components.peerStore.addressBook.consumePeerRecord(i)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(s)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),r.length&&await Promise.all(r.map(async n=>await this.connect(n)))}async connect(e){this.log("Initiating connection with %s",e);let r=jn(e),n=await this.components.connectionManager.openConnection(r);for(let s of this.multicodecs)for(let i of this.components.registrar.getTopologies(s))i.onConnect(r,n)}subscribe(e){if(this.status.code!==Bt.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==Bt.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,r),r)for(let n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e).catch(n=>{this.log(n)})}join(e){if(this.status.code!==Bt.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let r=new Set,n=this.fanout.get(e);if(n&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),n.forEach(s=>{!this.direct.has(s)&&this.score.score(s)>=0&&r.add(s)}),this.metrics?.onAddToMesh(e,Qr.Fanout,r.size)),r.size<this.opts.D){let s=r.size;this.getRandomGossipPeers(e,this.opts.D,o=>!r.has(o)&&!this.direct.has(o)&&this.score.score(o)>=0).forEach(o=>{r.add(o)}),this.metrics?.onAddToMesh(e,Qr.Random,r.size-s)}this.mesh.set(e,r),r.forEach(s=>{this.log("JOIN: Add mesh link to %s in %s",s,e),this.sendGraft(s,e)})}async leave(e){if(this.status.code!==Bt.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let r=this.mesh.get(e);r&&(await Promise.all(Array.from(r).map(async n=>(this.log("LEAVE: Remove mesh link to %s in %s",n,e),await this.sendPrune(n,e)))),this.mesh.delete(e))}selectPeersToForward(e,r,n){let s=new Set,i=this.topics.get(e);i&&(this.direct.forEach(a=>{i.has(a)&&r!==a&&!n?.has(a)&&s.add(a)}),this.floodsubPeers.forEach(a=>{i.has(a)&&r!==a&&!n?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&s.add(a)}));let o=this.mesh.get(e);return o&&o.size>0&&o.forEach(a=>{r!==a&&!n?.has(a)&&s.add(a)}),s}selectPeersToPublish(e){let r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},s=this.topics.get(e);if(s)if(this.opts.floodPublish)s.forEach(i=>{this.direct.has(i)?(r.add(i),n.direct++):this.score.score(i)>=this.opts.scoreThresholds.publishThreshold&&(r.add(i),n.floodsub++)});else{this.direct.forEach(o=>{s.has(o)&&(r.add(o),n.direct++)}),this.floodsubPeers.forEach(o=>{s.has(o)&&this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(r.add(o),n.floodsub++)});let i=this.mesh.get(e);if(i&&i.size>0)i.forEach(o=>{r.add(o),n.mesh++});else{let o=this.fanout.get(e);if(o&&o.size>0)o.forEach(a=>{r.add(a),n.fanout++});else{let a=this.getRandomGossipPeers(e,this.opts.D,c=>this.score.score(c)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(c=>{r.add(c),n.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:r,tosendCount:n}}forwardMessage(e,r,n,s){n&&this.score.deliverMessage(n,e,r.topic);let i=this.selectPeersToForward(r.topic,n,s);i.forEach(o=>{this.sendRpc(o,{messages:[r]})}),this.metrics?.onForwardMsg(r.topic,i.size)}async publish(e,r){let n=this.dataTransform?this.dataTransform.outboundTransform(e,r):r;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let{raw:s,msg:i}=await n1(this.publishConfig,e,r,n),o=await this.msgIdFn(i),a=this.msgIdToStrFn(o);if(this.seenCache.has(a))throw Error("PublishError.Duplicate");let{tosend:c,tosendCount:f}=this.selectPeersToPublish(e),u=this.opts.emitSelf===!0&&this.subscriptions.has(e);if(c.size===0&&!this.opts.allowPublishToZeroPeers&&!u)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put({msgId:o,msgIdStr:a},s,!0),this.publishedMessageIds.put(a);for(let h of c)this.sendRpc(h,{messages:[s]})||c.delete(h);return this.metrics?.onPublishMsg(e,f,c.size,s.data!=null?s.data.length:0),u&&(c.add(this.components.peerId.toString()),super.dispatchEvent(new Qn("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:a,msg:i}})),super.dispatchEvent(new Qn("message",{detail:i}))),{recipients:Array.from(c.values()).map(h=>jn(h))}}reportMessageValidationResult(e,r,n){if(n===tr.Accept){let s=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(s!==null),s!=null){let{message:i,originatingPeers:o}=s;this.score.deliverMessage(r.toString(),e,i.topic),this.forwardMessage(e,s.message,r.toString(),o),this.metrics?.onReportValidation(i.topic,n)}}else{let s=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(s!==null),s){let i=kp(n),{message:o,originatingPeers:a}=s;this.score.rejectMessage(r.toString(),e,o.topic,i);for(let c of a)this.score.rejectMessage(c,e,o.topic,i);this.metrics?.onReportValidation(o.topic,n)}}}sendGraft(e,r){let n=[{topicID:r}];this.sendRpc(e,{control:{graft:n}})}async sendPrune(e,r){let n=[await this.makePrune(e,r,this.opts.doPX)];this.sendRpc(e,{control:{prune:n}})}sendRpc(e,r){let n=this.streamsOutbound.get(e);if(!n)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;let s=this.control.get(e);s&&(this.piggybackControl(e,r,s),this.control.delete(e));let i=this.gossip.get(e);i&&(this.piggybackGossip(e,r,i),this.gossip.delete(e));let o=Ro.encode(r).finish();try{n.push(o)}catch(a){return this.log.error(`Cannot send rpc to ${e}`,a),s&&this.control.set(e,s),i&&this.gossip.set(e,i),!1}return this.metrics?.onRpcSent(r,o.length),!0}piggybackControl(e,r,n){if(n.graft){r.control||(r.control={}),r.control.graft||(r.control.graft=[]);for(let s of n.graft)s.topicID&&this.mesh.get(s.topicID)?.has(e)&&r.control.graft.push(s)}if(n.prune){r.control||(r.control={}),r.control.prune||(r.control.prune=[]);for(let s of n.prune)s.topicID&&!this.mesh.get(s.topicID)?.has(e)&&r.control.prune.push(s)}}piggybackGossip(e,r,n){r.control||(r.control={}),r.control.ihave=n}async sendGraftPrune(e,r,n){let s=this.opts.doPX;for(let[i,o]of e){let a=o.map(u=>({topicID:u})),c=[],f=r.get(i);f&&(c=await Promise.all(f.map(async u=>await this.makePrune(i,u,s&&!(n.get(i)??!1)))),r.delete(i)),this.sendRpc(i,{control:{graft:a,prune:c}})}for(let[i,o]of r){let a=await Promise.all(o.map(async c=>await this.makePrune(i,c,s&&!(n.get(i)??!1))));this.sendRpc(i,{control:{prune:a}})}}emitGossip(e){let r=this.mcache.getGossipIDs(new Set(e.keys()));for(let[n,s]of e)this.doEmitGossip(n,s,r.get(n)??[])}doEmitGossip(e,r,n){if(!n.length||(Ir(n),n.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length),!r.size))return;let s=this.opts.Dlazy,i=.25*r.size,o=r;i>s&&(s=i),s>o.size?s=o.size:o=Ir(Array.from(o)).slice(0,s),o.forEach(a=>{let c=n;n.length>5e3&&(c=Ir(c.slice()).slice(0,5e3)),this.pushGossip(a,{topicID:e,messageIDs:c})})}flush(){for(let[e,r]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,{control:{ihave:r}});for(let[e,r]of this.control.entries())this.control.delete(e),this.sendRpc(e,{control:{graft:r.graft,prune:r.prune}})}pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(r))}async makePrune(e,r,n){if(this.score.prune(e,r),this.streamsOutbound.get(e).protocol===fp)return{topicID:r,peers:[]};let s=this.opts.pruneBackoff/1e3;if(!n)return{topicID:r,peers:[],backoff:s};let i=this.getRandomGossipPeers(r,this.opts.prunePeers,a=>a!==e&&this.score.score(a)>=0),o=await Promise.all(Array.from(i).map(async a=>{let c=jn(a);return{peerID:c.toBytes(),signedPeerRecord:await this.components.peerStore.addressBook.getRawEnvelope(c)}}));return{topicID:r,peers:o,backoff:s}}async heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:s,Dout:i,fanoutTTL:o}=this.opts;this.heartbeatTicks++;let a=new Map,c=p=>{let d=a.get(p);return d===void 0&&(d=this.score.score(p),a.set(p,d)),d},f=new Map,u=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();let l=new Map;this.mesh.forEach((p,d)=>{let y=this.topics.get(d),m=new Set,D=new Set;if(l.set(d,D),y){let b=Ir(Array.from(y)),x=this.backoff.get(d);for(let C of b){let I=this.streamsOutbound.get(C);if(I&&this.multicodecs.includes(I.protocol)&&!p.has(C)&&!this.direct.has(C)){let O=c(C);(!x||!x.has(C))&&O>=0&&m.add(C),O>=this.opts.scoreThresholds.gossipThreshold&&D.add(C)}}}let E=(b,x)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",b,d),this.addBackoff(b,d),p.delete(b),c(b)>=this.opts.scoreThresholds.gossipThreshold&&D.add(b),this.metrics?.onRemoveFromMesh(d,x,1);let C=u.get(b);C?C.push(d):u.set(b,[d])},w=(b,x)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",b,d),this.score.graft(b,d),p.add(b),D.delete(b),this.metrics?.onAddToMesh(d,x,1);let C=f.get(b);C?C.push(d):f.set(b,[d])};if(p.forEach(b=>{let x=c(b);x<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",b,x,d),E(b,ns.BadScore),h.set(b,!0))}),p.size<r){let b=e-p.size;Qv(m,b).forEach(C=>{w(C,Qr.NotEnough)})}if(p.size>n){let b=Array.from(p);b.sort((C,I)=>c(I)-c(C)),b=b.slice(0,s).concat(Ir(b.slice(s)));let x=0;if(b.slice(0,e).forEach(C=>{this.outbound.get(C)&&x++}),x<i){let C=O=>{let X=b[O];for(let fe=O;fe>0;fe--)b[fe]=b[fe-1];b[0]=X};if(x>0){let O=x;for(let X=1;X<e&&O>0;X++)this.outbound.get(b[X])&&(C(X),O--)}let I=e-x;for(let O=e;O<b.length&&I>0;O++)this.outbound.get(b[O])&&(C(O),I--)}b.slice(e).forEach(C=>{E(C,ns.Excess)})}if(p.size>=r){let b=0;if(p.forEach(x=>{this.outbound.get(x)&&b++}),b<i){let x=i-b;Mu(m,x,I=>this.outbound.get(I)===!0).forEach(I=>{w(I,Qr.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&p.size>1){let b=Array.from(p).sort((I,O)=>c(I)-c(O)),x=Math.floor(p.size/2),C=c(b[x]);if(C<this.opts.scoreThresholds.opportunisticGraftThreshold){let I=this.opts.opportunisticGraftPeers,O=Mu(m,I,X=>c(X)>C);for(let X of O)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",X,d),w(X,Qr.Opportunistic)}}});let g=Date.now();this.fanoutLastpub.forEach((p,d)=>{p+o<g&&(this.fanout.delete(d),this.fanoutLastpub.delete(d))}),this.fanout.forEach((p,d)=>{let y=this.topics.get(d);p.forEach(w=>{(!y.has(w)||c(w)<this.opts.scoreThresholds.publishThreshold)&&p.delete(w)});let m=this.topics.get(d),D=[],E=new Set;if(l.set(d,E),m){let w=Ir(Array.from(m));for(let b of w){let x=this.streamsOutbound.get(b);if(x&&this.multicodecs.includes(x.protocol)&&!p.has(b)&&!this.direct.has(b)){let C=c(b);C>=this.opts.scoreThresholds.publishThreshold&&D.push(b),C>=this.opts.scoreThresholds.gossipThreshold&&E.add(b)}}}if(p.size<e){let w=e-p.size;D.slice(0,w).forEach(b=>{p.add(b),E?.delete(b)})}}),this.emitGossip(l),await this.sendGraftPrune(f,u,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new Qn("gossipsub:heartbeat"))}getRandomGossipPeers(e,r,n=()=>!0){let s=this.topics.get(e);if(!s)return new Set;let i=[];return s.forEach(o=>{let a=this.streamsOutbound.get(o);!a||this.multicodecs.includes(a.protocol)&&n(o)&&i.push(o)}),i=Ir(i),r>0&&i.length>r&&(i=i.slice(0,r)),new Set(i)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),e.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0;for(let o of this.backoff.values())r+=o.size;e.cacheSize.set({cache:"backoff"},r);for(let[o,a]of this.topics)e.topicPeersCount.set({topicStr:o},a.size);for(let[o,a]of this.mesh)e.meshPeerCounts.set({topicStr:o},a.size);let n=[],s=new Map;e.behaviourPenalty.reset();for(let o of this.peers.keys()){let a=this.score.score(o);n.push(a),s.set(o,a),e.behaviourPenalty.observe(this.score.peerStats.get(o)?.behaviourPenalty??0)}e.registerScores(n,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,s);let i=u1(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(i)}};qo.multicodec=Bu;function _B(t={}){return e=>new qo(e,t)}return S1(PB);})();
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
return ChainsafeLibp2PGossipsub}));
